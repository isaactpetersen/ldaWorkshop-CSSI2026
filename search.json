[
  {
    "objectID": "structural-equation-models.html",
    "href": "structural-equation-models.html",
    "title": "Structural Equation Models",
    "section": "",
    "text": "For an overview of structural equation modeling, see my chapter on “Structural Equation Modeling” in the following textbook:\nPetersen, I. T. (2025). Principles of psychological assessment: With applied examples in R. University of Iowa Libraries. https://isaactpetersen.github.io/Principles-Psychological-Assessment. https://doi.org/10.25820/work.007199"
  },
  {
    "objectID": "structural-equation-models.html#load-libraries",
    "href": "structural-equation-models.html#load-libraries",
    "title": "Structural Equation Models",
    "section": "\n1.1 Load Libraries",
    "text": "1.1 Load Libraries\n\nCodelibrary(\"lavaan\")\nlibrary(\"semTools\")\nlibrary(\"lcsm\")\nlibrary(\"lavaanPlot\")\nlibrary(\"lavaangui\")\nlibrary(\"tidyverse\")"
  },
  {
    "objectID": "structural-equation-models.html#load-data",
    "href": "structural-equation-models.html#load-data",
    "title": "Structural Equation Models",
    "section": "\n1.2 Load Data",
    "text": "1.2 Load Data\n\nCodemydata_long &lt;- read.csv(\"./data/mydata_long.csv\")\n\nlongitudinalMI1 &lt;- read.csv(\"./data/Bliese-Ployhart-2002-indicators-1.csv\")\n\n\n\nCodelongitudinalMI2 &lt;- read.csv(\"./data/Bliese-Ployhart-2002-indicators-2.csv\")\nlongitudinalMI3 &lt;- read.csv(\"./data/Bliese-Ployhart-2002-indicators-3.csv\")\nlongitudinalMI4 &lt;- read.csv(\"./data/Bliese-Ployhart-2002-indicators-4.csv\")"
  },
  {
    "objectID": "structural-equation-models.html#linear-growth-curve-model",
    "href": "structural-equation-models.html#linear-growth-curve-model",
    "title": "Structural Equation Models",
    "section": "\n4.1 Linear Growth Curve Model",
    "text": "4.1 Linear Growth Curve Model\n\n4.1.1 Model Syntax\nIn estimating linear latent growth curves of depression symptoms, this model specifies:\n\nlatent intercept and slope factors\nthe person’s sex (sexEffectCode) and the person’s average sleep (sleep_personMean; and their interaction; sexEffectCodeXsleep_personMean) as time-invariant predictors of the latent intercept and slope, and\na person’s deviations from their average sleep (sleep_personMeanCentered; and in interaction with sex; sexEffectCodeXsleep_personMeanCentered) as time-varying covariates predicting concurrent depression symptoms at each wave.\n\n\nCodelinearGCM_syntax &lt;- '\n  # Intercept and slope\n  intercept =~ 1*depression_1 + 1*depression_2 + 1*depression_3 + 1*depression_4\n  slope =~ 0*depression_1 + 1*depression_2 + 2*depression_3 + 3*depression_4\n\n  # Regression paths\n  intercept ~ sexEffectCode + sleep_personMean + sexEffectCodeXsleep_personMean\n  slope ~ sexEffectCode + sleep_personMean + sexEffectCodeXsleep_personMean\n  \n  # Time-varying covariates\n  depression_1 ~ sleep_personMeanCentered_1 + sexEffectCodeXsleep_personMeanCentered_1\n  depression_2 ~ sleep_personMeanCentered_2 + sexEffectCodeXsleep_personMeanCentered_2\n  depression_3 ~ sleep_personMeanCentered_3 + sexEffectCodeXsleep_personMeanCentered_3\n  depression_4 ~ sleep_personMeanCentered_4 + sexEffectCodeXsleep_personMeanCentered_4\n  \n  # Constrain observed intercepts to zero\n  depression_1 ~ 0*1\n  depression_2 ~ 0*1\n  depression_3 ~ 0*1\n  depression_4 ~ 0*1\n  \n  # Estimate mean of intercept and slope\n  intercept ~ 1\n  slope ~ 1\n'\n\n\n\n4.1.2 Fit Model\nSpecifying fixed.x = FALSE would estimate (i.e., would not consider as fixed) means, variances, and covariances of the observed variables. Doing so would allow missing information in the predictors to be included as part of full information maximum likelihood (FIML). However, this gets challenging to use when including both person mean and person-mean-centered variables (due to linear dependencies). Thus, many of these examples do not specify fixed.x = FALSE.\n\nCodelinearGCM_fit &lt;- lavaan::sem(\n  linearGCM_syntax,\n  data = mydata_wide,\n  missing = \"ML\", # FIML\n  estimator = \"MLR\", # Huber-White robust standard errors (for heteroscedasticity and nonnormally distributed residuals)\n  meanstructure = TRUE) # estimate means/intercepts\n\n\n\n4.1.3 Model Summary\n\nCodesummary(\n  linearGCM_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 102 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        23\n\n                                                  Used       Total\n  Number of observations                           186         250\n  Number of missing patterns                         1            \n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                               159.403     206.471\n  Degrees of freedom                                35          35\n  P-value (Chi-square)                           0.000       0.000\n  Scaling correction factor                                  0.772\n    Yuan-Bentler correction (Mplus variant)                       \n\nModel Test Baseline Model:\n\n  Test statistic                              2772.555    3085.340\n  Degrees of freedom                                50          50\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  0.899\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.954       0.944\n  Tucker-Lewis Index (TLI)                       0.935       0.919\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.944\n  Robust Tucker-Lewis Index (TLI)                            0.920\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -1686.380   -1686.380\n  Scaling correction factor                                  1.117\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)             NA          NA\n  Scaling correction factor                                  0.909\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                                3418.761    3418.761\n  Bayesian (BIC)                              3492.953    3492.953\n  Sample-size adjusted Bayesian (SABIC)       3420.104    3420.104\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.138       0.162\n  90 Percent confidence interval - lower         0.117       0.138\n  90 Percent confidence interval - upper         0.160       0.187\n  P-value H_0: RMSEA &lt;= 0.050                    0.000       0.000\n  P-value H_0: RMSEA &gt;= 0.080                    1.000       1.000\n                                                                  \n  Robust RMSEA                                               0.143\n  90 Percent confidence interval - lower                     0.125\n  90 Percent confidence interval - upper                     0.162\n  P-value H_0: Robust RMSEA &lt;= 0.050                         0.000\n  P-value H_0: Robust RMSEA &gt;= 0.080                         1.000\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.043       0.043\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  intercept =~                                                          \n    depression_1      1.000                               4.094    0.913\n    depression_2      1.000                               4.094    0.727\n    depression_3      1.000                               4.094    0.579\n    depression_4      1.000                               4.094    0.449\n  slope =~                                                              \n    depression_1      0.000                               0.000    0.000\n    depression_2      1.000                               1.770    0.314\n    depression_3      2.000                               3.540    0.501\n    depression_4      3.000                               5.309    0.582\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  intercept ~                                                           \n    sexEffectCode    -2.312    2.813   -0.822    0.411   -0.565   -0.556\n    sleep_personMn   -1.440    0.348   -4.136    0.000   -0.352   -0.334\n    sxEffctCdXsl_M    0.164    0.355    0.461    0.645    0.040    0.318\n  slope ~                                                               \n    sexEffectCode    -2.069    1.100   -1.881    0.060   -1.169   -1.151\n    sleep_personMn   -0.354    0.129   -2.744    0.006   -0.200   -0.190\n    sxEffctCdXsl_M    0.158    0.132    1.201    0.230    0.089    0.709\n  depression_1 ~                                                        \n    slp_prsnMnCn_1   -1.535    0.255   -6.008    0.000   -1.535   -0.201\n    sxEffctCX_MC_1    0.070    0.247    0.284    0.776    0.070    0.009\n  depression_2 ~                                                        \n    slp_prsnMnCn_2   -0.767    0.255   -3.004    0.003   -0.767   -0.076\n    sxEffctCX_MC_2   -0.394    0.247   -1.592    0.111   -0.394   -0.039\n  depression_3 ~                                                        \n    slp_prsnMnCn_3   -0.757    0.221   -3.421    0.001   -0.757   -0.062\n    sxEffctCX_MC_3    0.137    0.228    0.603    0.547    0.137    0.011\n  depression_4 ~                                                        \n    slp_prsnMnCn_4   -1.203    0.348   -3.461    0.001   -1.203   -0.085\n    sxEffctCX_MC_4    0.432    0.358    1.208    0.227    0.432    0.031\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n .intercept ~~                                                          \n   .slope             3.520    0.602    5.844    0.000    0.613    0.613\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .depression_1      0.000                               0.000    0.000\n   .depression_2      0.000                               0.000    0.000\n   .depression_3      0.000                               0.000    0.000\n   .depression_4      0.000                               0.000    0.000\n   .intercept        21.149    2.772    7.630    0.000    5.166    5.166\n   .slope             2.693    1.073    2.509    0.012    1.522    1.522\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .depression_1      2.626    0.689    3.814    0.000    2.626    0.131\n   .depression_2      2.110    0.331    6.373    0.000    2.110    0.067\n   .depression_3      1.361    0.498    2.732    0.006    1.361    0.027\n   .depression_4      8.651    1.642    5.270    0.000    8.651    0.104\n   .intercept        13.916    2.058    6.761    0.000    0.830    0.830\n   .slope             2.372    0.411    5.776    0.000    0.757    0.757\n\nR-Square:\n                   Estimate\n    depression_1      0.869\n    depression_2      0.933\n    depression_3      0.973\n    depression_4      0.896\n    intercept         0.170\n    slope             0.243\n\n\n\n4.1.4 Modification Indices\n\nCodemodificationindices(\n  linearGCM_fit,\n  sort. = TRUE)\n\n\n  \n\n\n\n\n4.1.5 Plots\n\n4.1.5.1 Path Diagram\n\nCodelavaanPlot::lavaanPlot(\n  linearGCM_fit,\n  coefs = TRUE,\n  #covs = TRUE,\n  stand = TRUE)\n\n\nPath Diagram\n\n\nTo create an interactive path diagram, you can use the following syntax:\n\nCodelavaangui::plot_lavaan(linearGCM_fit)"
  },
  {
    "objectID": "structural-equation-models.html#quadratic-growth-curve-model",
    "href": "structural-equation-models.html#quadratic-growth-curve-model",
    "title": "Structural Equation Models",
    "section": "\n4.2 Quadratic Growth Curve Model",
    "text": "4.2 Quadratic Growth Curve Model\n\n4.2.1 Model Syntax\nIn estimating quadratic latent growth curves of depression symptoms, this model specifies:\n\nlatent intercept and latent linear and quadratic slope factors\nthe person’s sex (sexEffectCode) and the person’s average sleep (sleep_personMean; and their interaction; sexEffectCodeXsleep_personMean) as time-invariant predictors of the latent intercept and slope, and\na person’s deviations from their average sleep (sleep_personMeanCentered; and in interaction with sex; sexEffectCodeXsleep_personMeanCentered) as time-varying covariates predicting concurrent depression symptoms at each wave.\n\n\nCodequadraticGCM_syntax &lt;- '\n  # Intercept and slope\n  intercept =~ 1*depression_1 + 1*depression_2 + 1*depression_3 + 1*depression_4\n  linear =~ 0*depression_1 + 1*depression_2 + 2*depression_3 + 3*depression_4\n  quadratic =~ 0*depression_1 + 1*depression_2 + 4*depression_3 + 9*depression_4\n\n  # Regression paths\n  intercept ~ sexEffectCode + sleep_personMean + sexEffectCodeXsleep_personMean\n  linear ~ sexEffectCode + sleep_personMean + sexEffectCodeXsleep_personMean\n  quadratic ~ sexEffectCode + sleep_personMean + sexEffectCodeXsleep_personMean\n  \n  # Time-varying covariates\n  depression_1 ~ sleep_personMeanCentered_1 + sexEffectCodeXsleep_personMeanCentered_1\n  depression_2 ~ sleep_personMeanCentered_2 + sexEffectCodeXsleep_personMeanCentered_2\n  depression_3 ~ sleep_personMeanCentered_3 + sexEffectCodeXsleep_personMeanCentered_3\n  depression_4 ~ sleep_personMeanCentered_4 + sexEffectCodeXsleep_personMeanCentered_4\n  \n  # Constrain observed intercepts to zero\n  depression_1 ~ 0*1\n  depression_2 ~ 0*1\n  depression_3 ~ 0*1\n  depression_4 ~ 0*1\n  \n  # Constrain residual variances to be equal (needed to address negative variance)\n  depression_1 ~~ vardep*depression_1\n  depression_2 ~~ vardep*depression_2\n  depression_3 ~~ vardep*depression_3\n  depression_4 ~~ vardep*depression_4\n  \n  # Estimate mean of intercept and slope\n  intercept ~ 1\n  linear ~ 1\n  quadratic ~ 1\n'\n\n\n\n4.2.2 Fit Model\n\nCodequadraticGCM_fit &lt;- lavaan::sem(\n  quadraticGCM_syntax,\n  data = mydata_wide,\n  missing = \"ML\", # FIML\n  estimator = \"MLR\", # Huber-White robust standard errors (for heteroscedasticity and nonnormally distributed residuals)\n  meanstructure = TRUE) # estimate means/intercepts\n\n\n\n4.2.3 Model Summary\n\nCodesummary(\n  quadraticGCM_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 142 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        30\n  Number of equality constraints                     3\n\n                                                  Used       Total\n  Number of observations                           186         250\n  Number of missing patterns                         1            \n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                                52.028      74.505\n  Degrees of freedom                                31          31\n  P-value (Chi-square)                           0.010       0.000\n  Scaling correction factor                                  0.698\n    Yuan-Bentler correction (Mplus variant)                       \n\nModel Test Baseline Model:\n\n  Test statistic                              2772.555    3085.340\n  Degrees of freedom                                50          50\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  0.899\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.992       0.986\n  Tucker-Lewis Index (TLI)                       0.988       0.977\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.987\n  Robust Tucker-Lewis Index (TLI)                            0.980\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -1632.693   -1632.693\n  Scaling correction factor                                  1.036\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)             NA          NA\n  Scaling correction factor                                  0.909\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                                3319.386    3319.386\n  Bayesian (BIC)                              3406.481    3406.481\n  Sample-size adjusted Bayesian (SABIC)       3320.962    3320.962\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.060       0.087\n  90 Percent confidence interval - lower         0.029       0.057\n  90 Percent confidence interval - upper         0.088       0.117\n  P-value H_0: RMSEA &lt;= 0.050                    0.257       0.024\n  P-value H_0: RMSEA &gt;= 0.080                    0.132       0.672\n                                                                  \n  Robust RMSEA                                               0.072\n  90 Percent confidence interval - lower                     0.050\n  90 Percent confidence interval - upper                     0.094\n  P-value H_0: Robust RMSEA &lt;= 0.050                         0.048\n  P-value H_0: Robust RMSEA &gt;= 0.080                         0.283\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.038       0.038\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  intercept =~                                                          \n    depression_1      1.000                               4.101    0.943\n    depression_2      1.000                               4.101    0.717\n    depression_3      1.000                               4.101    0.572\n    depression_4      1.000                               4.101    0.471\n  linear =~                                                             \n    depression_1      0.000                               0.000    0.000\n    depression_2      1.000                               2.628    0.460\n    depression_3      2.000                               5.256    0.733\n    depression_4      3.000                               7.884    0.905\n  quadratic =~                                                          \n    depression_1      0.000                               0.000    0.000\n    depression_2      1.000                               0.646    0.113\n    depression_3      4.000                               2.583    0.360\n    depression_4      9.000                               5.811    0.667\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  intercept ~                                                           \n    sexEffectCode    -1.363    2.776   -0.491    0.623   -0.332   -0.327\n    sleep_personMn   -1.415    0.352   -4.021    0.000   -0.345   -0.328\n    sxEffctCdXsl_M    0.049    0.353    0.139    0.890    0.012    0.095\n  linear ~                                                              \n    sexEffectCode    -5.227    1.880   -2.781    0.005   -1.989   -1.959\n    sleep_personMn   -0.407    0.227   -1.796    0.072   -0.155   -0.147\n    sxEffctCdXsl_M    0.545    0.227    2.404    0.016    0.207    1.646\n  quadratic ~                                                           \n    sexEffectCode     1.310    0.560    2.342    0.019    2.029    1.999\n    sleep_personMn    0.008    0.067    0.121    0.904    0.013    0.012\n    sxEffctCdXsl_M   -0.161    0.067   -2.385    0.017   -0.249   -1.977\n  depression_1 ~                                                        \n    slp_prsnMnCn_1   -1.336    0.238   -5.621    0.000   -1.336   -0.180\n    sxEffctCX_MC_1    0.190    0.228    0.835    0.404    0.190    0.026\n  depression_2 ~                                                        \n    slp_prsnMnCn_2   -0.787    0.266   -2.953    0.003   -0.787   -0.076\n    sxEffctCX_MC_2   -0.423    0.242   -1.751    0.080   -0.423   -0.041\n  depression_3 ~                                                        \n    slp_prsnMnCn_3   -0.617    0.198   -3.121    0.002   -0.617   -0.050\n    sxEffctCX_MC_3    0.286    0.202    1.416    0.157    0.286    0.023\n  depression_4 ~                                                        \n    slp_prsnMnCn_4   -1.131    0.320   -3.530    0.000   -1.131   -0.084\n    sxEffctCX_MC_4    0.351    0.330    1.063    0.288    0.351    0.026\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n .intercept ~~                                                          \n   .linear            3.371    1.084    3.109    0.002    0.375    0.375\n   .quadratic        -0.083    0.305   -0.273    0.785   -0.035   -0.035\n .linear ~~                                                             \n   .quadratic        -1.091    0.356   -3.067    0.002   -0.729   -0.729\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .depression_1      0.000                               0.000    0.000\n   .depression_2      0.000                               0.000    0.000\n   .depression_3      0.000                               0.000    0.000\n   .depression_4      0.000                               0.000    0.000\n   .intercept        21.448    2.770    7.743    0.000    5.230    5.230\n   .linear            1.550    1.882    0.823    0.410    0.590    0.590\n   .quadratic         0.554    0.559    0.990    0.322    0.857    0.857\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .dprss_1 (vrdp)    1.511    0.238    6.350    0.000    1.511    0.080\n   .dprss_2 (vrdp)    1.511    0.238    6.350    0.000    1.511    0.046\n   .dprss_3 (vrdp)    1.511    0.238    6.350    0.000    1.511    0.029\n   .dprss_4 (vrdp)    1.511    0.238    6.350    0.000    1.511    0.020\n   .intrcpt          14.179    1.980    7.161    0.000    0.843    0.843\n   .linear            5.703    1.310    4.352    0.000    0.826    0.826\n   .quadrtc           0.393    0.111    3.532    0.000    0.942    0.942\n\nR-Square:\n                   Estimate\n    depression_1      0.920\n    depression_2      0.954\n    depression_3      0.971\n    depression_4      0.980\n    intercept         0.157\n    linear            0.174\n    quadratic         0.058\n\n\n\n4.2.4 Modification Indices\n\nCodemodificationindices(\n  quadraticGCM_fit,\n  sort. = TRUE)\n\n\n  \n\n\n\n\n4.2.5 Plots\n\n4.2.5.1 Path Diagram\n\nCodelavaanPlot::lavaanPlot2(\n  quadraticGCM_fit,\n  stand = TRUE,\n  coef_labels = TRUE)\n\n\nPath Diagram\n\n\nTo create an interactive path diagram, you can use the following syntax:\n\nCodelavaangui::plot_lavaan(quadraticGCM_fit)"
  },
  {
    "objectID": "structural-equation-models.html#latent-basis-growth-curve-model",
    "href": "structural-equation-models.html#latent-basis-growth-curve-model",
    "title": "Structural Equation Models",
    "section": "\n4.3 Latent Basis Growth Curve Model",
    "text": "4.3 Latent Basis Growth Curve Model\n\n4.3.1 Model Syntax\nIn estimating latent basis growth curves of depression symptoms, this model specifies:\n\nlatent intercept and slope factors, with factor loadings for the slope freely estimated at timepoints 2 and 3 to capture nonlinear patterns of change\nthe person’s sex (sexEffectCode) and the person’s average sleep (sleep_personMean; and their interaction; sexEffectCodeXsleep_personMean) as time-invariant predictors of the latent intercept and slope, and\na person’s deviations from their average sleep (sleep_personMeanCentered; and in interaction with sex; sexEffectCodeXsleep_personMeanCentered) as time-varying covariates predicting concurrent depression symptoms at each wave.\n\n\nCodelatentBasisGCM_syntax &lt;- '\n  # Intercept and slope\n  intercept =~ 1*depression_1 + 1*depression_2 + 1*depression_3 + 1*depression_4\n  slope =~ 0*depression_1 + a*depression_2 + b*depression_3 + 1*depression_4 # freely estimate the loadings for t2 and t3\n\n  # Regression paths\n  intercept ~ sexEffectCode + sleep_personMean + sexEffectCodeXsleep_personMean\n  slope ~ sexEffectCode + sleep_personMean + sexEffectCodeXsleep_personMean\n  \n  # Time-varying covariates\n  depression_1 ~ sleep_personMeanCentered_1 + sexEffectCodeXsleep_personMeanCentered_1\n  depression_2 ~ sleep_personMeanCentered_2 + sexEffectCodeXsleep_personMeanCentered_2\n  depression_3 ~ sleep_personMeanCentered_3 + sexEffectCodeXsleep_personMeanCentered_3\n  depression_4 ~ sleep_personMeanCentered_4 + sexEffectCodeXsleep_personMeanCentered_4\n  \n  # Constrain observed intercepts to zero\n  depression_1 ~ 0*1\n  depression_2 ~ 0*1\n  depression_3 ~ 0*1\n  depression_4 ~ 0*1\n  \n  # Estimate mean of intercept and slope\n  intercept ~ 1\n  slope ~ 1\n'\n\n\n\n4.3.2 Fit Model\n\nCodelatentBasisGCM_fit &lt;- lavaan::sem(\n  latentBasisGCM_syntax,\n  data = mydata_wide,\n  missing = \"ML\", # FIML\n  estimator = \"MLR\", # Huber-White robust standard errors (for heteroscedasticity and nonnormally distributed residuals)\n  meanstructure = TRUE) # estimate means/intercepts\n\n\nA model with negative variances is uninterpretable. We can constrain the variances to be nonnegative using the bounds = \"pos.var\" argument:\n\nCodelatentBasisGCM_fit &lt;- lavaan::sem(\n  latentBasisGCM_syntax,\n  data = mydata_wide,\n  missing = \"ML\", # FIML\n  estimator = \"MLR\", # Huber-White robust standard errors (for heteroscedasticity and nonnormally distributed residuals)\n  meanstructure = TRUE, # estimate means/intercepts\n  bounds = \"pos.var\") # constrain observed and latent variances to be nonnegative\n\n\n\n4.3.3 Model Summary\n\nCodesummary(\n  latentBasisGCM_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 164 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        25\n  Row rank of the constraints matrix                 6\n\n                                                  Used       Total\n  Number of observations                           186         250\n  Number of missing patterns                         1            \n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                               138.748     169.671\n  Degrees of freedom                                33          33\n  P-value (Chi-square)                           0.000       0.000\n  Scaling correction factor                                  0.818\n    Yuan-Bentler correction (Mplus variant)                       \n\nModel Test Baseline Model:\n\n  Test statistic                              2772.555    3085.340\n  Degrees of freedom                                50          50\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  0.899\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.961       0.955\n  Tucker-Lewis Index (TLI)                       0.941       0.932\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.952\n  Robust Tucker-Lewis Index (TLI)                            0.928\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -1676.053   -1676.053\n  Scaling correction factor                                  1.030\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)             NA          NA\n  Scaling correction factor                                  0.909\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                                3402.106    3402.106\n  Bayesian (BIC)                              3482.750    3482.750\n  Sample-size adjusted Bayesian (SABIC)       3403.566    3403.566\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.131       0.149\n  90 Percent confidence interval - lower         0.109       0.125\n  90 Percent confidence interval - upper         0.154       0.174\n  P-value H_0: RMSEA &lt;= 0.050                    0.000       0.000\n  P-value H_0: RMSEA &gt;= 0.080                    1.000       1.000\n                                                                  \n  Robust RMSEA                                               0.135\n  90 Percent confidence interval - lower                     0.116\n  90 Percent confidence interval - upper                     0.156\n  P-value H_0: Robust RMSEA &lt;= 0.050                         0.000\n  P-value H_0: Robust RMSEA &gt;= 0.080                         1.000\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.045       0.045\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  intercept =~                                                          \n    depressn_1        1.000                               4.211    0.985\n    depressn_2        1.000                               4.211    0.722\n    depressn_3        1.000                               4.211    0.597\n    depressn_4        1.000                               4.211    0.509\n  slope =~                                                              \n    depressn_1        0.000                               0.000    0.000\n    depressn_2 (a)    0.502    0.043   11.559    0.000    2.411    0.413\n    depressn_3 (b)    0.885    0.044   20.135    0.000    4.248    0.602\n    depressn_4        1.000                               4.800    0.580\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  intercept ~                                                           \n    sexEffectCode    -1.600    2.704   -0.592    0.554   -0.380   -0.374\n    sleep_personMn   -1.381    0.344   -4.016    0.000   -0.328   -0.312\n    sxEffctCdXsl_M    0.075    0.344    0.218    0.827    0.018    0.142\n  slope ~                                                               \n    sexEffectCode    -6.335    2.613   -2.424    0.015   -1.320   -1.300\n    sleep_personMn   -0.803    0.320   -2.505    0.012   -0.167   -0.159\n    sxEffctCdXsl_M    0.559    0.312    1.793    0.073    0.116    0.925\n  depression_1 ~                                                        \n    slp_prsnMnCn_1   -1.367    0.238   -5.758    0.000   -1.367   -0.188\n    sxEffctCX_MC_1    0.055    0.231    0.238    0.812    0.055    0.008\n  depression_2 ~                                                        \n    slp_prsnMnCn_2   -0.703    0.241   -2.909    0.004   -0.703   -0.067\n    sxEffctCX_MC_2   -0.428    0.246   -1.741    0.082   -0.428   -0.041\n  depression_3 ~                                                        \n    slp_prsnMnCn_3   -0.762    0.216   -3.535    0.000   -0.762   -0.062\n    sxEffctCX_MC_3    0.276    0.221    1.248    0.212    0.276    0.023\n  depression_4 ~                                                        \n    slp_prsnMnCn_4   -0.974    0.339   -2.874    0.004   -0.974   -0.076\n    sxEffctCX_MC_4    0.450    0.342    1.319    0.187    0.450    0.035\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n .intercept ~~                                                          \n   .slope             4.937    1.340    3.683    0.000    0.293    0.293\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .depression_1      0.000                               0.000    0.000\n   .depression_2      0.000                               0.000    0.000\n   .depression_3      0.000                               0.000    0.000\n   .depression_4      0.000                               0.000    0.000\n   .intercept        21.135    2.699    7.830    0.000    5.019    5.019\n   .slope             5.346    2.668    2.004    0.045    1.114    1.114\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .depression_1      0.000                               0.000    0.000\n   .depression_2      2.542    0.317    8.014    0.000    2.542    0.075\n   .depression_3      0.000                               0.000    0.000\n   .depression_4     11.300    1.594    7.088    0.000   11.300    0.165\n   .intercept        15.110    1.906    7.926    0.000    0.852    0.852\n   .slope            18.760    3.087    6.077    0.000    0.814    0.814\n\nR-Square:\n                   Estimate\n    depression_1      1.000\n    depression_2      0.925\n    depression_3      1.000\n    depression_4      0.835\n    intercept         0.148\n    slope             0.186\n\n\n\n4.3.4 Modification Indices\n\nCodemodificationindices(\n  latentBasisGCM_fit,\n  sort. = TRUE)\n\n\n  \n\n\n\n\n4.3.5 Plots\n\n4.3.5.1 Path Diagram\n\nCodelavaanPlot::lavaanPlot(\n  latentBasisGCM_fit,\n  coefs = TRUE,\n  #covs = TRUE,\n  stand = TRUE)\n\n\nPath Diagram\n\n\nTo create an interactive path diagram, you can use the following syntax:\n\nCodelavaangui::plot_lavaan(latentBasisGCM_fit)"
  },
  {
    "objectID": "structural-equation-models.html#model-syntax-3",
    "href": "structural-equation-models.html#model-syntax-3",
    "title": "Structural Equation Models",
    "section": "\n6.1 Model Syntax",
    "text": "6.1 Model Syntax\nThis model examines reciprocal (i.e., bidirectional), dynamic (i.e., changing) relations between latent change in depression and latent change in anxiety. Each construct is modeled with a latent intercept (constant change factor), a proportional change factor (latent true score predicting its own change), and autoregressive effects of prior change scores. The cross-domain coupling parameters evaluate whether latent change in depression predicts subsequent latent change in anxiety, and vice versa.\n\nCodebivariateLCSM_syntax &lt;- lcsm::specify_bi_lcsm(\n  timepoints = 4,\n  var_x = \"depression_\",\n  model_x = list(\n    alpha_constant = TRUE, # alpha = intercept (constant change factor)\n    beta = TRUE, # beta = proportional change factor (latent true score predicting its change score)\n    phi = TRUE), # phi = autoregression of change scores\n  var_y = \"anxiety_\",\n  model_y = list(\n    alpha_constant = TRUE, # alpha = intercept (constant change factor)\n    beta = TRUE, # beta = proportional change factor (latent true score predicting its change score)\n    phi = TRUE), # phi = autoregression of change scores\n  coupling = list(\n    delta_lag_xy = TRUE,\n    delta_lag_yx = TRUE),\n  change_letter_x = \"g\",\n  change_letter_y = \"j\")\n\ncat(bivariateLCSM_syntax)\n\n# # # # # # # # # # # # # # # # # # # # #\n# Specify parameters for construct x ----\n# # # # # # # # # # # # # # # # # # # # #\n# Specify latent true scores \nldepression_1 =~ 1 * depression_1 \nldepression_2 =~ 1 * depression_2 \nldepression_3 =~ 1 * depression_3 \nldepression_4 =~ 1 * depression_4 \n# Specify mean of latent true scores \nldepression_1 ~ gamma_ldepression_1 * 1 \nldepression_2 ~ 0 * 1 \nldepression_3 ~ 0 * 1 \nldepression_4 ~ 0 * 1 \n# Specify variance of latent true scores \nldepression_1 ~~ sigma2_ldepression_1 * ldepression_1 \nldepression_2 ~~ 0 * ldepression_2 \nldepression_3 ~~ 0 * ldepression_3 \nldepression_4 ~~ 0 * ldepression_4 \n# Specify intercept of obseved scores \ndepression_1 ~ 0 * 1 \ndepression_2 ~ 0 * 1 \ndepression_3 ~ 0 * 1 \ndepression_4 ~ 0 * 1 \n# Specify variance of observed scores \ndepression_1 ~~ sigma2_udepression_ * depression_1 \ndepression_2 ~~ sigma2_udepression_ * depression_2 \ndepression_3 ~~ sigma2_udepression_ * depression_3 \ndepression_4 ~~ sigma2_udepression_ * depression_4 \n# Specify autoregressions of latent variables \nldepression_2 ~ 1 * ldepression_1 \nldepression_3 ~ 1 * ldepression_2 \nldepression_4 ~ 1 * ldepression_3 \n# Specify latent change scores \nddepression_2 =~ 1 * ldepression_2 \nddepression_3 =~ 1 * ldepression_3 \nddepression_4 =~ 1 * ldepression_4 \n# Specify latent change scores means \nddepression_2 ~ 0 * 1 \nddepression_3 ~ 0 * 1 \nddepression_4 ~ 0 * 1 \n# Specify latent change scores variances \nddepression_2 ~~ 0 * ddepression_2 \nddepression_3 ~~ 0 * ddepression_3 \nddepression_4 ~~ 0 * ddepression_4 \n# Specify constant change factor \ng2 =~ 1 * ddepression_2 + 1 * ddepression_3 + 1 * ddepression_4 \n# Specify constant change factor mean \ng2 ~ alpha_g2 * 1 \n# Specify constant change factor variance \ng2 ~~ sigma2_g2 * g2 \n# Specify constant change factor covariance with the initial true score \ng2 ~~ sigma_g2ldepression_1 * ldepression_1\n# Specify proportional change component \nddepression_2 ~ beta_depression_ * ldepression_1 \nddepression_3 ~ beta_depression_ * ldepression_2 \nddepression_4 ~ beta_depression_ * ldepression_3 \n# Specify autoregression of change score \nddepression_3 ~ phi_depression_ * ddepression_2 \nddepression_4 ~ phi_depression_ * ddepression_3 \n# # # # # # # # # # # # # # # # # # # # #\n# Specify parameters for construct y ----\n# # # # # # # # # # # # # # # # # # # # #\n# Specify latent true scores \nlanxiety_1 =~ 1 * anxiety_1 \nlanxiety_2 =~ 1 * anxiety_2 \nlanxiety_3 =~ 1 * anxiety_3 \nlanxiety_4 =~ 1 * anxiety_4 \n# Specify mean of latent true scores \nlanxiety_1 ~ gamma_lanxiety_1 * 1 \nlanxiety_2 ~ 0 * 1 \nlanxiety_3 ~ 0 * 1 \nlanxiety_4 ~ 0 * 1 \n# Specify variance of latent true scores \nlanxiety_1 ~~ sigma2_lanxiety_1 * lanxiety_1 \nlanxiety_2 ~~ 0 * lanxiety_2 \nlanxiety_3 ~~ 0 * lanxiety_3 \nlanxiety_4 ~~ 0 * lanxiety_4 \n# Specify intercept of obseved scores \nanxiety_1 ~ 0 * 1 \nanxiety_2 ~ 0 * 1 \nanxiety_3 ~ 0 * 1 \nanxiety_4 ~ 0 * 1 \n# Specify variance of observed scores \nanxiety_1 ~~ sigma2_uanxiety_ * anxiety_1 \nanxiety_2 ~~ sigma2_uanxiety_ * anxiety_2 \nanxiety_3 ~~ sigma2_uanxiety_ * anxiety_3 \nanxiety_4 ~~ sigma2_uanxiety_ * anxiety_4 \n# Specify autoregressions of latent variables \nlanxiety_2 ~ 1 * lanxiety_1 \nlanxiety_3 ~ 1 * lanxiety_2 \nlanxiety_4 ~ 1 * lanxiety_3 \n# Specify latent change scores \ndanxiety_2 =~ 1 * lanxiety_2 \ndanxiety_3 =~ 1 * lanxiety_3 \ndanxiety_4 =~ 1 * lanxiety_4 \n# Specify latent change scores means \ndanxiety_2 ~ 0 * 1 \ndanxiety_3 ~ 0 * 1 \ndanxiety_4 ~ 0 * 1 \n# Specify latent change scores variances \ndanxiety_2 ~~ 0 * danxiety_2 \ndanxiety_3 ~~ 0 * danxiety_3 \ndanxiety_4 ~~ 0 * danxiety_4 \n# Specify constant change factor \nj2 =~ 1 * danxiety_2 + 1 * danxiety_3 + 1 * danxiety_4 \n# Specify constant change factor mean \nj2 ~ alpha_j2 * 1 \n# Specify constant change factor variance \nj2 ~~ sigma2_j2 * j2 \n# Specify constant change factor covariance with the initial true score \nj2 ~~ sigma_j2lanxiety_1 * lanxiety_1\n# Specify proportional change component \ndanxiety_2 ~ beta_anxiety_ * lanxiety_1 \ndanxiety_3 ~ beta_anxiety_ * lanxiety_2 \ndanxiety_4 ~ beta_anxiety_ * lanxiety_3 \n# Specify autoregression of change score \ndanxiety_3 ~ phi_anxiety_ * danxiety_2 \ndanxiety_4 ~ phi_anxiety_ * danxiety_3 \n# Specify residual covariances \ndepression_1 ~~ sigma_su * anxiety_1 \ndepression_2 ~~ sigma_su * anxiety_2 \ndepression_3 ~~ sigma_su * anxiety_3 \ndepression_4 ~~ sigma_su * anxiety_4 \n# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #\n# Specify covariances betweeen specified change components (alpha) and intercepts (initial latent true scores lx1 and ly1) ----\n# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #\n# Specify covariance of intercepts \nldepression_1 ~~ sigma_lanxiety_1ldepression_1 * lanxiety_1 \n# Specify covariance of constant change and intercept between constructs \nlanxiety_1 ~~ sigma_g2lanxiety_1 * g2 \n# Specify covariance of constant change and intercept between constructs \nldepression_1 ~~ sigma_j2ldepression_1 * j2 \n# Specify covariance of constant change factors between constructs \ng2 ~~ sigma_j2g2 * j2 \n# # # # # # # # # # # # # # # # # # # # # # # # # # #\n# Specify between-construct coupling parameters ----\n# # # # # # # # # # # # # # # # # # # # # # # # # # #\n# Change score depression_ (t) is determined by true score anxiety_ (t-1)  \nddepression_2 ~ delta_lag_depression_anxiety_ * lanxiety_1 \nddepression_3 ~ delta_lag_depression_anxiety_ * lanxiety_2 \nddepression_4 ~ delta_lag_depression_anxiety_ * lanxiety_3 \n# Change score anxiety_ (t) is determined by true score depression_ (t-1)  \ndanxiety_2 ~ delta_lag_anxiety_depression_ * ldepression_1 \ndanxiety_3 ~ delta_lag_anxiety_depression_ * ldepression_2 \ndanxiety_4 ~ delta_lag_anxiety_depression_ * ldepression_3"
  },
  {
    "objectID": "structural-equation-models.html#fit-model-3",
    "href": "structural-equation-models.html#fit-model-3",
    "title": "Structural Equation Models",
    "section": "\n6.2 Fit Model",
    "text": "6.2 Fit Model\n\nCodebivariateLCSM_fit &lt;- lcsm::fit_bi_lcsm(\n  data = mydata_wide,\n  var_x = c(\"depression_1\",\"depression_2\",\"depression_3\",\"depression_4\"),\n  var_y = c(\"anxiety_1\",\"anxiety_2\",\"anxiety_3\",\"anxiety_4\"),\n  model_x = list(\n    alpha_constant = TRUE, # alpha = intercept (constant change factor)\n    beta = TRUE, # beta = proportional change factor (latent true score predicting its change score)\n    phi = TRUE), # phi = autoregression of change scores\n  model_y = list(\n    alpha_constant = TRUE, # alpha = intercept (constant change factor)\n    beta = TRUE, # beta = proportional change factor (latent true score predicting its change score)\n    phi = TRUE), # phi = autoregression of change scores\n  coupling = list(\n    delta_lag_xy = TRUE,\n    xi_lag_yx = TRUE),\n  fixed.x = FALSE # estimate means, variances, and covariances of the observed variables (to include predictors as part of FIML)\n  )"
  },
  {
    "objectID": "structural-equation-models.html#model-summary-3",
    "href": "structural-equation-models.html#model-summary-3",
    "title": "Structural Equation Models",
    "section": "\n6.3 Model Summary",
    "text": "6.3 Model Summary\n\nCodesummary(\n  bivariateLCSM_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 964 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        41\n  Number of equality constraints                    18\n\n  Number of observations                           250\n  Number of missing patterns                         6\n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                               106.159      85.523\n  Degrees of freedom                                21          21\n  P-value (Chi-square)                           0.000       0.000\n  Scaling correction factor                                  1.241\n    Yuan-Bentler correction (Mplus variant)                       \n\nModel Test Baseline Model:\n\n  Test statistic                              2762.171    1772.854\n  Degrees of freedom                                28          28\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  1.558\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.969       0.963\n  Tucker-Lewis Index (TLI)                       0.958       0.951\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.971\n  Robust Tucker-Lewis Index (TLI)                            0.962\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -4696.127   -4696.127\n  Scaling correction factor                                  0.823\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)      -4643.048   -4643.048\n  Scaling correction factor                                  1.359\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                                9438.254    9438.254\n  Bayesian (BIC)                              9519.247    9519.247\n  Sample-size adjusted Bayesian (SABIC)       9446.335    9446.335\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.127       0.111\n  90 Percent confidence interval - lower         0.104       0.089\n  90 Percent confidence interval - upper         0.152       0.133\n  P-value H_0: RMSEA &lt;= 0.050                    0.000       0.000\n  P-value H_0: RMSEA &gt;= 0.080                    0.999       0.990\n                                                                  \n  Robust RMSEA                                               0.129\n  90 Percent confidence interval - lower                     0.098\n  90 Percent confidence interval - upper                     0.162\n  P-value H_0: Robust RMSEA &lt;= 0.050                         0.000\n  P-value H_0: Robust RMSEA &gt;= 0.080                         0.994\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.038       0.038\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  lx1 =~                                                                \n    x1                1.000                               4.276    0.950\n  lx2 =~                                                                \n    x2                1.000                               5.597    0.970\n  lx3 =~                                                                \n    x3                1.000                               6.896    0.980\n  lx4 =~                                                                \n    x4                1.000                               8.505    0.987\n  dx2 =~                                                                \n    lx2               1.000                               0.385    0.385\n  dx3 =~                                                                \n    lx3               1.000                               0.241    0.241\n  dx4 =~                                                                \n    lx4               1.000                               0.276    0.276\n  g2 =~                                                                 \n    dx2               1.000                               5.517    5.517\n    dx3               1.000                               7.146    7.146\n    dx4               1.000                               5.067    5.067\n  ly1 =~                                                                \n    y1                1.000                               4.170    0.901\n  ly2 =~                                                                \n    y2                1.000                               5.358    0.936\n  ly3 =~                                                                \n    y3                1.000                               6.555    0.956\n  ly4 =~                                                                \n    y4                1.000                               8.310    0.972\n  dy2 =~                                                                \n    ly2               1.000                               0.320    0.320\n  dy3 =~                                                                \n    ly3               1.000                               0.230    0.230\n  dy4 =~                                                                \n    ly4               1.000                               0.268    0.268\n  j2 =~                                                                 \n    dy2               1.000                               0.876    0.876\n    dy3               1.000                               0.994    0.994\n    dy4               1.000                               0.674    0.674\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  lx2 ~                                                                 \n    lx1               1.000                               0.764    0.764\n  lx3 ~                                                                 \n    lx2               1.000                               0.812    0.812\n  lx4 ~                                                                 \n    lx3               1.000                               0.811    0.811\n  dx2 ~                                                                 \n    lx1     (bt_x)   -2.506    0.683   -3.667    0.000   -4.972   -4.972\n  dx3 ~                                                                 \n    lx2     (bt_x)   -2.506    0.683   -3.667    0.000   -8.428   -8.428\n  dx4 ~                                                                 \n    lx3     (bt_x)   -2.506    0.683   -3.667    0.000   -7.364   -7.364\n  dx3 ~                                                                 \n    dx2     (ph_x)   -0.199    0.335   -0.595    0.552   -0.258   -0.258\n  dx4 ~                                                                 \n    dx3     (ph_x)   -0.199    0.335   -0.595    0.552   -0.141   -0.141\n  ly2 ~                                                                 \n    ly1               1.000                               0.778    0.778\n  ly3 ~                                                                 \n    ly2               1.000                               0.817    0.817\n  ly4 ~                                                                 \n    ly3               1.000                               0.789    0.789\n  dy2 ~                                                                 \n    ly1     (bt_y)    0.104    0.621    0.167    0.867    0.252    0.252\n  dy3 ~                                                                 \n    ly2     (bt_y)    0.104    0.621    0.167    0.867    0.368    0.368\n  dy4 ~                                                                 \n    ly3     (bt_y)    0.104    0.621    0.167    0.867    0.305    0.305\n  dy3 ~                                                                 \n    dy2     (ph_y)    3.635    0.986    3.685    0.000    4.126    4.126\n  dy4 ~                                                                 \n    dy3     (ph_y)    3.635    0.986    3.685    0.000    2.463    2.463\n  dx2 ~                                                                 \n    ly1     (dl__)    3.062    0.969    3.161    0.002    5.925    5.925\n  dx3 ~                                                                 \n    ly2     (dl__)    3.062    0.969    3.161    0.002    9.862    9.862\n  dx4 ~                                                                 \n    ly3     (dl__)    3.062    0.969    3.161    0.002    8.555    8.555\n  dy3 ~                                                                 \n    dx2     (x_l_)   -3.219    1.070   -3.009    0.003   -4.599   -4.599\n  dy4 ~                                                                 \n    dx3     (x_l_)   -3.219    1.070   -3.009    0.003   -2.407   -2.407\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  lx1 ~~                                                                \n    g2 (sgm_g2lx1)   23.734    7.572    3.134    0.002    0.467    0.467\n  ly1 ~~                                                                \n    j2 (sgm_j2ly1)    2.395   10.811    0.222    0.825    0.383    0.383\n .x1 ~~                                                                 \n   .y1      (sgm_)    0.323    0.235    1.375    0.169    0.323    0.114\n .x2 ~~                                                                 \n   .y2      (sgm_)    0.323    0.235    1.375    0.169    0.323    0.114\n .x3 ~~                                                                 \n   .y3      (sgm_)    0.323    0.235    1.375    0.169    0.323    0.114\n .x4 ~~                                                                 \n   .y4      (sgm_)    0.323    0.235    1.375    0.169    0.323    0.114\n  lx1 ~~                                                                \n    l1      (s_11)    8.582    1.439    5.966    0.000    0.481    0.481\n  g2 ~~                                                                 \n    l1 (sgm_g2ly1)  -26.769   12.292   -2.178    0.029   -0.540   -0.540\n  lx1 ~~                                                                \n    j2 (sgm_j2lx1)    2.571    5.468    0.470    0.638    0.401    0.401\n  g2 ~~                                                                 \n    j2      (s_22)    2.252   15.905    0.142    0.887    0.126    0.126\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n    lx1  (gmm_lx1)   10.140    0.281   36.060    0.000    2.371    2.371\n   .lx2               0.000                               0.000    0.000\n   .lx3               0.000                               0.000    0.000\n   .lx4               0.000                               0.000    0.000\n   .x1                0.000                               0.000    0.000\n   .x2                0.000                               0.000    0.000\n   .x3                0.000                               0.000    0.000\n   .x4                0.000                               0.000    0.000\n   .dx2               0.000                               0.000    0.000\n   .dx3               0.000                               0.000    0.000\n   .dx4               0.000                               0.000    0.000\n    g2   (alph_g2)   -4.722    3.842   -1.229    0.219   -0.397   -0.397\n    ly1  (gmm_ly1)    9.539    0.292   32.721    0.000    2.288    2.288\n   .ly2               0.000                               0.000    0.000\n   .ly3               0.000                               0.000    0.000\n   .ly4               0.000                               0.000    0.000\n   .y1                0.000                               0.000    0.000\n   .y2                0.000                               0.000    0.000\n   .y3                0.000                               0.000    0.000\n   .y4                0.000                               0.000    0.000\n   .dy2               0.000                               0.000    0.000\n   .dy3               0.000                               0.000    0.000\n   .dy4               0.000                               0.000    0.000\n    j2   (alph_j2)   -1.474    5.977   -0.247    0.805   -0.983   -0.983\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n    lx1 (sgm2_lx1)   18.286    1.957    9.344    0.000    1.000    1.000\n   .lx2               0.000                               0.000    0.000\n   .lx3               0.000                               0.000    0.000\n   .lx4               0.000                               0.000    0.000\n   .x1    (sgm2_x)    1.984    0.333    5.955    0.000    1.984    0.098\n   .x2    (sgm2_x)    1.984    0.333    5.955    0.000    1.984    0.060\n   .x3    (sgm2_x)    1.984    0.333    5.955    0.000    1.984    0.040\n   .x4    (sgm2_x)    1.984    0.333    5.955    0.000    1.984    0.027\n   .dx2               0.000                               0.000    0.000\n   .dx3               0.000                               0.000    0.000\n   .dx4               0.000                               0.000    0.000\n    g2   (sgm2_g2)  141.388   83.321    1.697    0.090    1.000    1.000\n    ly1 (sgm2_ly1)   17.387    1.615   10.765    0.000    1.000    1.000\n   .ly2               0.000                               0.000    0.000\n   .ly3               0.000                               0.000    0.000\n   .ly4               0.000                               0.000    0.000\n   .y1    (sgm2_y)    4.030    0.413    9.757    0.000    4.030    0.188\n   .y2    (sgm2_y)    4.030    0.413    9.757    0.000    4.030    0.123\n   .y3    (sgm2_y)    4.030    0.413    9.757    0.000    4.030    0.086\n   .y4    (sgm2_y)    4.030    0.413    9.757    0.000    4.030    0.055\n   .dy2               0.000                               0.000    0.000\n   .dy3               0.000                               0.000    0.000\n   .dy4               0.000                               0.000    0.000\n    j2   (sgm2_j2)    2.249    2.731    0.823    0.410    1.000    1.000\n\nR-Square:\n                   Estimate\n    lx2               1.000\n    lx3               1.000\n    lx4               1.000\n    x1                0.902\n    x2                0.940\n    x3                0.960\n    x4                0.973\n    dx2               1.000\n    dx3               1.000\n    dx4               1.000\n    ly2               1.000\n    ly3               1.000\n    ly4               1.000\n    y1                0.812\n    y2                0.877\n    y3                0.914\n    y4                0.945\n    dy2               1.000\n    dy3               1.000\n    dy4               1.000\n\nCodelcsm::extract_param(bivariateLCSM_fit)"
  },
  {
    "objectID": "structural-equation-models.html#modification-indices-3",
    "href": "structural-equation-models.html#modification-indices-3",
    "title": "Structural Equation Models",
    "section": "\n6.4 Modification Indices",
    "text": "6.4 Modification Indices\n\nCodemodificationindices(\n  bivariateLCSM_fit,\n  sort. = TRUE)"
  },
  {
    "objectID": "structural-equation-models.html#plots-3",
    "href": "structural-equation-models.html#plots-3",
    "title": "Structural Equation Models",
    "section": "\n6.5 Plots",
    "text": "6.5 Plots\n\n6.5.1 Path Diagram\n\nCodelavaanPlot::lavaanPlot2(\n  bivariateLCSM_fit,\n  stand = TRUE,\n  coef_labels = TRUE)\n\n\nPath Diagram\n\n\nTo create an interactive path diagram, you can use the following syntax:\n\nCodelavaangui::plot_lavaan(bivariateLCSM_fit)\n\n\n\nCodelcsm::plot_lcsm(\n  lavaan_object = bivariateLCSM_fit,\n  lcsm = \"bivariate\",\n  lavaan_syntax = bivariateLCSM_syntax,\n  edge.label.cex = .9,\n  lcsm_colours = TRUE)\n\n\nTo plot model-implied trajectories, see this resource:\nhttps://thechangelab.stanford.edu/tutorials/growth-modeling/latent-change-score-modeling-lavaan/ (archived at https://perma.cc/A2KZ-QPD9)"
  },
  {
    "objectID": "structural-equation-models.html#model-syntax-4",
    "href": "structural-equation-models.html#model-syntax-4",
    "title": "Structural Equation Models",
    "section": "\n7.1 Model Syntax",
    "text": "7.1 Model Syntax\nThis cross-lagged panel model examines whether anxiety predicts later depression (i.e., cross-lagged paths), controlling for prior levels of depression (i.e., autoregressive effects), and simultaneously examines the reverse association (i.e., depression predicting later anxiety, controlling for prior levels of anxiety). Concurrent covariances between depression and anxiety at each timepoint account for shared variance at the same occasion.\n\nCodeclpm_syntax &lt;- '\n  # Autoregressive Paths\n  depression_4 ~ depression_3\n  depression_3 ~ depression_2\n  depression_2 ~ depression_1\n  \n  anxiety_4 ~ anxiety_3\n  anxiety_3 ~ anxiety_2\n  anxiety_2 ~ anxiety_1\n  \n  # Concurrent Covariances\n  depression_1 ~~ anxiety_1\n  depression_2 ~~ anxiety_2\n  depression_3 ~~ anxiety_3\n  depression_4 ~~ anxiety_4\n  \n  # Cross-Lagged Paths\n  depression_4 ~ anxiety_3\n  depression_3 ~ anxiety_2\n  depression_2 ~ anxiety_1\n  \n  anxiety_4 ~ depression_3\n  anxiety_3 ~ depression_2\n  anxiety_2 ~ depression_1\n'"
  },
  {
    "objectID": "structural-equation-models.html#fit-model-4",
    "href": "structural-equation-models.html#fit-model-4",
    "title": "Structural Equation Models",
    "section": "\n7.2 Fit Model",
    "text": "7.2 Fit Model\n\nCodeclpm_fit &lt;- lavaan::sem(\n  clpm_syntax,\n  data = mydata_wide,\n  missing = \"ML\", # FIML\n  estimator = \"MLR\", # Huber-White robust standard errors (for heteroscedasticity and nonnormally distributed residuals)\n  meanstructure = TRUE, # estimate means/intercepts\n  fixed.x = FALSE) # estimate means, variances, and covariances of the observed variables (to include predictors as part of FIML)"
  },
  {
    "objectID": "structural-equation-models.html#model-summary-4",
    "href": "structural-equation-models.html#model-summary-4",
    "title": "Structural Equation Models",
    "section": "\n7.3 Model Summary",
    "text": "7.3 Model Summary\n\nCodesummary(\n  clpm_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 90 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        32\n\n  Number of observations                           250\n  Number of missing patterns                         6\n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                                50.696      36.849\n  Degrees of freedom                                12          12\n  P-value (Chi-square)                           0.000       0.000\n  Scaling correction factor                                  1.376\n    Yuan-Bentler correction (Mplus variant)                       \n\nModel Test Baseline Model:\n\n  Test statistic                              2762.171    1772.854\n  Degrees of freedom                                28          28\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  1.558\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.986       0.986\n  Tucker-Lewis Index (TLI)                       0.967       0.967\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.986\n  Robust Tucker-Lewis Index (TLI)                            0.968\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -4668.395   -4668.395\n  Scaling correction factor                                  1.353\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)      -4643.048   -4643.048\n  Scaling correction factor                                  1.359\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                                9400.791    9400.791\n  Bayesian (BIC)                              9513.478    9513.478\n  Sample-size adjusted Bayesian (SABIC)       9412.035    9412.035\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.114       0.091\n  90 Percent confidence interval - lower         0.082       0.063\n  90 Percent confidence interval - upper         0.147       0.120\n  P-value H_0: RMSEA &lt;= 0.050                    0.001       0.010\n  P-value H_0: RMSEA &gt;= 0.080                    0.961       0.759\n                                                                  \n  Robust RMSEA                                               0.118\n  90 Percent confidence interval - lower                     0.077\n  90 Percent confidence interval - upper                     0.162\n  P-value H_0: Robust RMSEA &lt;= 0.050                         0.005\n  P-value H_0: Robust RMSEA &gt;= 0.080                         0.936\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.013       0.013\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  depression_4 ~                                                        \n    depression_3      1.039    0.048   21.564    0.000    1.039    0.836\n  depression_3 ~                                                        \n    depression_2      1.030    0.040   25.534    0.000    1.030    0.852\n  depression_2 ~                                                        \n    depression_1      1.042    0.052   20.215    0.000    1.042    0.793\n  anxiety_4 ~                                                           \n    anxiety_3         1.051    0.054   19.485    0.000    1.051    0.833\n  anxiety_3 ~                                                           \n    anxiety_2         1.043    0.056   18.591    0.000    1.043    0.862\n  anxiety_2 ~                                                           \n    anxiety_1         1.066    0.062   17.237    0.000    1.066    0.824\n  depression_4 ~                                                        \n    anxiety_3         0.187    0.047    3.939    0.000    0.187    0.148\n  depression_3 ~                                                        \n    anxiety_2         0.167    0.036    4.661    0.000    0.167    0.136\n  depression_2 ~                                                        \n    anxiety_1         0.226    0.052    4.315    0.000    0.226    0.172\n  anxiety_4 ~                                                           \n    depression_3      0.142    0.053    2.660    0.008    0.142    0.114\n  anxiety_3 ~                                                           \n    depression_2      0.092    0.060    1.530    0.126    0.092    0.077\n  anxiety_2 ~                                                           \n    depression_1      0.024    0.056    0.428    0.669    0.024    0.019\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  depression_1 ~~                                                       \n    anxiety_1        10.388    1.396    7.442    0.000   10.388    0.535\n .depression_2 ~~                                                       \n   .anxiety_2         4.463    0.655    6.819    0.000    4.463    0.553\n .depression_3 ~~                                                       \n   .anxiety_3         2.849    0.546    5.216    0.000    2.849    0.448\n .depression_4 ~~                                                       \n   .anxiety_4         4.293    0.877    4.895    0.000    4.293    0.455\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .depression_4     -0.511    0.261   -1.956    0.050   -0.511   -0.059\n   .depression_3     -1.600    0.268   -5.974    0.000   -1.600   -0.229\n   .depression_2     -3.594    0.419   -8.587    0.000   -3.594   -0.621\n   .anxiety_4        -0.079    0.296   -0.268    0.789   -0.079   -0.009\n   .anxiety_3        -0.701    0.344   -2.036    0.042   -0.701   -0.101\n   .anxiety_2        -1.355    0.519   -2.609    0.009   -1.355   -0.237\n    depression_1     10.152    0.278   36.458    0.000   10.152    2.306\n    anxiety_1         9.576    0.279   34.323    0.000    9.576    2.171\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .depression_4      7.477    1.010    7.403    0.000    7.477    0.099\n   .depression_3      5.142    0.752    6.842    0.000    5.142    0.105\n   .depression_2      6.560    0.716    9.164    0.000    6.560    0.196\n   .anxiety_4        11.922    1.717    6.942    0.000   11.922    0.157\n   .anxiety_3         7.854    0.994    7.901    0.000    7.854    0.165\n   .anxiety_2         9.931    1.187    8.367    0.000    9.931    0.305\n    depression_1     19.385    1.878   10.322    0.000   19.385    1.000\n    anxiety_1        19.460    1.607   12.109    0.000   19.460    1.000\n\nR-Square:\n                   Estimate\n    depression_4      0.901\n    depression_3      0.895\n    depression_2      0.804\n    anxiety_4         0.843\n    anxiety_3         0.835\n    anxiety_2         0.695"
  },
  {
    "objectID": "structural-equation-models.html#modification-indices-4",
    "href": "structural-equation-models.html#modification-indices-4",
    "title": "Structural Equation Models",
    "section": "\n7.4 Modification Indices",
    "text": "7.4 Modification Indices\n\nCodemodificationindices(\n  clpm_fit,\n  sort. = TRUE)"
  },
  {
    "objectID": "structural-equation-models.html#plots-4",
    "href": "structural-equation-models.html#plots-4",
    "title": "Structural Equation Models",
    "section": "\n7.5 Plots",
    "text": "7.5 Plots\n\n7.5.1 Path Diagram\n\nCodelavaanPlot::lavaanPlot(\n  clpm_fit,\n  coefs = TRUE,\n  #covs = TRUE,\n  stand = TRUE)\n\n\nPath Diagram\n\n\nTo create an interactive path diagram, you can use the following syntax:\n\nCodelavaangui::plot_lavaan(clpm_fit)"
  },
  {
    "objectID": "structural-equation-models.html#model-syntax-5",
    "href": "structural-equation-models.html#model-syntax-5",
    "title": "Structural Equation Models",
    "section": "\n8.1 Model Syntax",
    "text": "8.1 Model Syntax\nThis random-intercepts cross-lagged panel model examines whether anxiety predicts later depression (i.e., cross-lagged paths), controlling for prior levels of depression (i.e., autoregressive effects) and controlling for a person’s general latent level of depression, and simultaneously and simultaneously examines the reverse association (i.e., depression predicting later anxiety, controlling for prior levels of anxiety and general latent levels of anxiety). Concurrent covariances between depression and anxiety at each timepoint account for shared variance at the same occasion.\n\nCodericlpm_syntax &lt;- '\n  # Random Intercepts\n  depression =~ 1*depression_1 + 1*depression_2 + 1*depression_3 + 1*depression_4\n  anxiety =~ 1*anxiety_1 + 1*anxiety_2 + 1*anxiety_3 + 1*anxiety_4\n  \n  # Create Within-Person Centered Variables\n  wdep1 =~ 1*depression_1\n  wdep2 =~ 1*depression_2\n  wdep3 =~ 1*depression_3\n  wdep4 =~ 1*depression_4\n  \n  wanx1 =~ 1*anxiety_1\n  wanx2 =~ 1*anxiety_2\n  wanx3 =~ 1*anxiety_3\n  wanx4 =~ 1*anxiety_4\n  \n  # Autoregressive Paths\n  wdep4 ~ wdep3\n  wdep3 ~ wdep2\n  wdep2 ~ wdep1\n  \n  wanx4 ~ wanx3\n  wanx3 ~ wanx2\n  wanx2 ~ wanx1\n  \n  # Concurrent Covariances\n  wdep1 ~~ wanx1\n  wdep2 ~~ wanx2\n  wdep3 ~~ wanx3\n  wdep4 ~~ wanx4\n  \n  # Cross-Lagged Paths\n  wdep4 ~ wanx3\n  wdep3 ~ wanx2\n  wdep2 ~ wanx1\n  \n  wanx4 ~ wdep3\n  wanx3 ~ wdep2\n  wanx2 ~ wdep1\n  \n  # Variance and Covariance of Random Intercepts\n  depression ~~ depression\n  anxiety ~~ anxiety\n  depression ~~ anxiety\n  \n  # Variances of Within-Person Centered Variables\n  wdep1 ~~ wdep1\n  wdep2 ~~ wdep2\n  wdep3 ~~ wdep3\n  wdep4 ~~ wdep4\n  \n  wanx1 ~~ wanx1\n  wanx2 ~~ wanx2\n  wanx3 ~~ wanx3\n  wanx4 ~~ wanx4\n  \n  # Fix Error Variances of Observed Variables to Zero\n  depression_1 ~~ 0*depression_1\n  depression_2 ~~ 0*depression_2\n  depression_3 ~~ 0*depression_3\n  depression_4 ~~ 0*depression_4\n  \n  anxiety_1 ~~ 0*anxiety_1\n  anxiety_2 ~~ 0*anxiety_2\n  anxiety_3 ~~ 0*anxiety_3\n  anxiety_4 ~~ 0*anxiety_4\n  \n  # Fix the Covariances Between the Random Intercepts and the Latents at T1 to Zero\n  wdep1 ~~ 0*depression\n  wdep1 ~~ 0*anxiety\n  \n  wanx1 ~~ 0*depression\n  wanx1 ~~ 0*anxiety\n  \n  # Estimate Observed Intercepts\n  depression_1 ~ 1\n  depression_2 ~ 1\n  depression_3 ~ 1\n  depression_4 ~ 1\n  \n  anxiety_1 ~ 1\n  anxiety_2 ~ 1\n  anxiety_3 ~ 1\n  anxiety_4 ~ 1\n  \n  # Fix the Means of the Latents to Zero\n  wdep1 ~ 0*1\n  wdep2 ~ 0*1\n  wdep3 ~ 0*1\n  wdep4 ~ 0*1\n  \n  wanx1 ~ 0*1\n  wanx2 ~ 0*1\n  wanx3 ~ 0*1\n  wanx4 ~ 0*1\n  \n  depression ~ 0*1\n  anxiety ~ 0*1\n'"
  },
  {
    "objectID": "structural-equation-models.html#fit-model-5",
    "href": "structural-equation-models.html#fit-model-5",
    "title": "Structural Equation Models",
    "section": "\n8.2 Fit Model",
    "text": "8.2 Fit Model\n\nCodericlpm_fit &lt;- lavaan::sem(\n  riclpm_syntax,\n  data = mydata_wide,\n  missing = \"ML\", # FIML\n  estimator = \"MLR\", # Huber-White robust standard errors (for heteroscedasticity and nonnormally distributed residuals)\n  fixed.x = FALSE, # estimate means, variances, and covariances of the observed variables (to include predictors as part of FIML)\n  bounds = \"standard\" # constrains observed variances, latent variances, and factor loadings to be within computed lower and upper bounds\n)\n\n\nModify the syntax to address the model fit errors."
  },
  {
    "objectID": "structural-equation-models.html#model-summary-5",
    "href": "structural-equation-models.html#model-summary-5",
    "title": "Structural Equation Models",
    "section": "\n8.3 Model Summary",
    "text": "8.3 Model Summary\n\nCodesummary(\n  withinPersonCLPM_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)"
  },
  {
    "objectID": "structural-equation-models.html#modification-indices-5",
    "href": "structural-equation-models.html#modification-indices-5",
    "title": "Structural Equation Models",
    "section": "\n8.4 Modification Indices",
    "text": "8.4 Modification Indices\n\nCodemodificationindices(\n  riclpm_fit,\n  sort. = TRUE)"
  },
  {
    "objectID": "structural-equation-models.html#path-diagram-5",
    "href": "structural-equation-models.html#path-diagram-5",
    "title": "Structural Equation Models",
    "section": "\n8.5 Path Diagram",
    "text": "8.5 Path Diagram\n\nCodelavaanPlot::lavaanPlot(\n  riclpm_fit,\n  coefs = TRUE,\n  #covs = TRUE,\n  stand = TRUE)\n\n\nTo create an interactive path diagram, you can use the following syntax:\n\nCodelavaangui::plot_lavaan(riclpm_fit)"
  },
  {
    "objectID": "structural-equation-models.html#model-syntax-6",
    "href": "structural-equation-models.html#model-syntax-6",
    "title": "Structural Equation Models",
    "section": "\n9.1 Model Syntax",
    "text": "9.1 Model Syntax\nThis multilevel structural equation model disaggregates within- and between-person effects to examine associations with depression. At the within-person level, we examine deviations in sleep, anxiety, and SES from a person’s usual (average) levels in predicting concurrent deviations in depression, allowing the within-person association between sleep and depression to differ between boys and girls. At the between-person level, we examine person-level averages across time of sleep, anxiety, and SES, along with sex, in predicting overall differences in depression across individuals, allowing the between-person association between sleep and depression to differ between boys and girls.\n\nCodemultilevelSEM_syntax &lt;- '\n    level: 1\n        depression ~ sleep_personMeanCentered + anxiety_personMeanCentered + ses_personMeanCentered + sexEffectCodeXsleep_personMeanCentered\n    level: 2\n        depression ~ sleep_personMean + anxiety_personMean + ses_personMean + sexEffectCode + sexEffectCodeXsleep_personMean\n'"
  },
  {
    "objectID": "structural-equation-models.html#fit-model-6",
    "href": "structural-equation-models.html#fit-model-6",
    "title": "Structural Equation Models",
    "section": "\n9.2 Fit Model",
    "text": "9.2 Fit Model\n\nCodemultilevelSEM_fit &lt;- lavaan::sem(\n  multilevelSEM_syntax,\n  data = mydata_long,\n  cluster = \"ID\",\n  missing = \"ML\", # FIML\n  estimator = \"MLR\")"
  },
  {
    "objectID": "structural-equation-models.html#model-summary-6",
    "href": "structural-equation-models.html#model-summary-6",
    "title": "Structural Equation Models",
    "section": "\n9.3 Model Summary",
    "text": "9.3 Model Summary\n\nCodesummary(\n  multilevelSEM_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 59 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        12\n\n                                                  Used       Total\n  Number of observations                           931        1000\n  Number of clusters [ID]                          250            \n  Number of missing patterns -- level 1              1            \n  Number of missing patterns -- level 2              1            \n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                                 0.000       0.000\n  Degrees of freedom                                 0           0\n\nModel Test Baseline Model:\n\n  Test statistic                               900.477     725.220\n  Degrees of freedom                                 9           9\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  1.242\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    1.000       1.000\n  Tucker-Lewis Index (TLI)                       1.000       1.000\n                                                                  \n  Robust Comparative Fit Index (CFI)                            NA\n  Robust Tucker-Lewis Index (TLI)                               NA\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -2349.089   -2349.089\n  Loglikelihood unrestricted model (H1)      -2349.090   -2349.090\n                                                                  \n  Akaike (AIC)                                4722.178    4722.178\n  Bayesian (BIC)                              4780.213    4780.213\n  Sample-size adjusted Bayesian (SABIC)       4742.102    4742.102\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.000          NA\n  90 Percent confidence interval - lower         0.000          NA\n  90 Percent confidence interval - upper         0.000          NA\n  P-value H_0: RMSEA &lt;= 0.050                       NA          NA\n  P-value H_0: RMSEA &gt;= 0.080                       NA          NA\n                                                                  \n  Robust RMSEA                                                  NA\n  90 Percent confidence interval - lower                        NA\n  90 Percent confidence interval - upper                        NA\n  P-value H_0: Robust RMSEA &lt;= 0.050                            NA\n  P-value H_0: Robust RMSEA &gt;= 0.080                            NA\n\nStandardized Root Mean Square Residual (corr metric):\n\n  SRMR (within covariance matrix)                0.000       0.000\n  SRMR (between covariance matrix)               0.001       0.001\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\n\nLevel 1 [within]:\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  depression ~                                                          \n    slp_prsnMnCntr   -0.498    0.154   -3.239    0.001   -0.498   -0.107\n    anxty_prsnMnCn    0.632    0.038   16.645    0.000    0.632    0.615\n    ss_prsnMnCntrd    0.338    0.177    1.909    0.056    0.338    0.059\n    sxEffctCdXs_MC    0.020    0.126    0.155    0.876    0.020    0.004\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .depression        4.555    0.365   12.463    0.000    4.555    0.602\n\nR-Square:\n                   Estimate\n    depression        0.398\n\n\nLevel 2 [ID]:\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  depression ~                                                          \n    sleep_personMn   -0.500    0.393   -1.274    0.203   -0.500   -0.081\n    anxiety_prsnMn    0.631    0.055   11.556    0.000    0.631    0.627\n    ses_personMean   -0.857    0.419   -2.042    0.041   -0.857   -0.125\n    sexEffectCode    -3.338    2.516   -1.327    0.185   -3.338   -0.552\n    sxEffctCdXsl_M    0.304    0.311    0.979    0.328    0.304    0.407\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .depression        7.582    3.200    2.370    0.018    7.582    1.264\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n   .depression       15.028    1.806    8.319    0.000   15.028    0.418\n\nR-Square:\n                   Estimate\n    depression        0.582"
  },
  {
    "objectID": "structural-equation-models.html#modification-indices-6",
    "href": "structural-equation-models.html#modification-indices-6",
    "title": "Structural Equation Models",
    "section": "\n9.4 Modification Indices",
    "text": "9.4 Modification Indices\n\nCodemodificationindices(\n  multilevelSEM_fit,\n  sort. = TRUE)"
  },
  {
    "objectID": "structural-equation-models.html#path-diagram-6",
    "href": "structural-equation-models.html#path-diagram-6",
    "title": "Structural Equation Models",
    "section": "\n9.5 Path Diagram",
    "text": "9.5 Path Diagram\n\nCodelavaanPlot::lavaanPlot(\n  multilevelSEM_fit,\n  coefs = TRUE,\n  #covs = TRUE,\n  stand = TRUE)\n\n\n\n\n\nTo create an interactive path diagram, you can use the following syntax:\n\nCodelavaangui::plot_lavaan(multilevelSEM_fit)"
  },
  {
    "objectID": "structural-equation-models.html#configural-invariance",
    "href": "structural-equation-models.html#configural-invariance",
    "title": "Structural Equation Models",
    "section": "\n10.1 Configural Invariance",
    "text": "10.1 Configural Invariance\nA configural invariance model whether there are the same number of latent factors across time and whether the indicators load onto the same latent factor(s) across time.\n\nStandardize the latent factor(s) at T1 (i.e., fix the mean to zero and the variance to one)\nFor each latent construct, constrain the first indicator’s factor loading to be the same across time\nFor each latent construct, constrain the first indicator’s intercept to be the same across time\n\n\n10.1.1 Model Syntax\n\nCodeconfiguralInvariance_syntax &lt;- '\n  # Factor Loadings\n  jobsat_1 =~ NA*loadj1*JOBSAT11 + JOBSAT12 + JOBSAT13\n  jobsat_2 =~ NA*loadj1*JOBSAT21 + JOBSAT22 + JOBSAT23\n  jobsat_3 =~ NA*loadj1*JOBSAT31 + JOBSAT32 + JOBSAT33\n  \n  ready_1 =~ NA*loadr1*READY11 + READY12 + READY13\n  ready_2 =~ NA*loadr1*READY21 + READY22 + READY23\n  ready_3 =~ NA*loadr1*READY31 + READY32 + READY33\n  \n  commit_1 =~ NA*loadc1*COMMIT11 + COMMIT12 + COMMIT13\n  commit_2 =~ NA*loadc1*COMMIT21 + COMMIT22 + COMMIT23\n  commit_3 =~ NA*loadc1*COMMIT31 + COMMIT32 + COMMIT33\n  \n  # Factor Identification: Standardize Factors at T1\n  \n  ## Fix Factor Means at T1 to Zero\n  jobsat_1 ~ 0*1\n  ready_1 ~ 0*1\n  commit_1 ~ 0*1\n  \n  ## Fix Factor Variances at T1 to One\n  jobsat_1 ~~ 1*jobsat_1\n  ready_1 ~~ 1*ready_1\n  commit_1 ~~ 1*commit_1\n  \n  # Freely Estimate Factor Means at T2 and T3 (relative to T1)\n  jobsat_2 ~ 1\n  jobsat_3 ~ 1\n  \n  ready_2 ~ 1\n  ready_3 ~ 1\n  \n  commit_2 ~ 1\n  commit_3 ~ 1\n  \n  # Freely Estimate Factor Variances at T2 and T3 (relative to T1)\n  jobsat_2 ~~ jobsat_2\n  jobsat_3 ~~ jobsat_3\n  \n  ready_2 ~~ ready_2\n  ready_3 ~~ ready_3\n  \n  commit_2 ~~ commit_2\n  commit_3 ~~ commit_3\n  \n  # Fix Intercepts of Indicator 1 Across Time\n  JOBSAT11 ~ intj1*1\n  JOBSAT21 ~ intj1*1\n  JOBSAT31 ~ intj1*1\n  \n  READY11 ~ intr1*1\n  READY21 ~ intr1*1\n  READY31 ~ intr1*1\n  \n  COMMIT11 ~ intc1*1\n  COMMIT21 ~ intc1*1\n  COMMIT31 ~ intc1*1\n  \n  # Free Intercepts of Remaining Manifest Variables\n  JOBSAT12 ~ 1\n  JOBSAT13 ~ 1\n  JOBSAT22 ~ 1\n  JOBSAT23 ~ 1\n  JOBSAT32 ~ 1\n  JOBSAT33 ~ 1\n  \n  READY12 ~ 1\n  READY13 ~ 1\n  READY22 ~ 1\n  READY23 ~ 1\n  READY32 ~ 1\n  READY33 ~ 1\n  \n  COMMIT12 ~ 1\n  COMMIT13 ~ 1\n  COMMIT22 ~ 1\n  COMMIT23 ~ 1\n  COMMIT32 ~ 1\n  COMMIT33 ~ 1\n  \n  # Estimate Residual Variances of Manifest Variables\n  JOBSAT11 ~~ JOBSAT11\n  JOBSAT12 ~~ JOBSAT12\n  JOBSAT13 ~~ JOBSAT13\n  JOBSAT21 ~~ JOBSAT21\n  JOBSAT22 ~~ JOBSAT22\n  JOBSAT23 ~~ JOBSAT23\n  JOBSAT31 ~~ JOBSAT31\n  JOBSAT32 ~~ JOBSAT32\n  JOBSAT33 ~~ JOBSAT33\n  \n  READY11 ~~ READY11\n  READY12 ~~ READY12\n  READY13 ~~ READY13\n  READY21 ~~ READY21\n  READY22 ~~ READY22\n  READY23 ~~ READY23\n  READY31 ~~ READY31\n  READY32 ~~ READY32\n  READY33 ~~ READY33\n  \n  COMMIT11 ~~ COMMIT11\n  COMMIT12 ~~ COMMIT12\n  COMMIT13 ~~ COMMIT13\n  COMMIT21 ~~ COMMIT21\n  COMMIT22 ~~ COMMIT22\n  COMMIT23 ~~ COMMIT23\n  COMMIT31 ~~ COMMIT31\n  COMMIT32 ~~ COMMIT32\n  COMMIT33 ~~ COMMIT33\n'\n\n\n\n10.1.2 Fit Model\n\nCodeconfiguralInvariance_fit &lt;- cfa(\n  configuralInvariance_syntax,\n  data = longitudinalMI1,\n  missing = \"ML\", # FIML\n  estimator = \"MLR\", # Huber-White robust standard errors (for heteroscedasticity and nonnormally distributed residuals)\n  meanstructure = TRUE, # estimate means/intercepts\n  fixed.x = FALSE) # estimate means, variances, and covariances of the observed variables (to include predictors as part of FIML)\n\n\n\n10.1.3 Model Summary\n\nCodesummary(\n  configuralInvariance_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 101 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                       129\n  Number of equality constraints                    12\n\n  Number of observations                           495\n  Number of missing patterns                         1\n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                               770.816     783.291\n  Degrees of freedom                               288         288\n  P-value (Chi-square)                           0.000       0.000\n  Scaling correction factor                                  0.984\n    Yuan-Bentler correction (Mplus variant)                       \n\nModel Test Baseline Model:\n\n  Test statistic                              6697.063    6541.933\n  Degrees of freedom                               351         351\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  1.024\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.924       0.920\n  Tucker-Lewis Index (TLI)                       0.907       0.902\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.923\n  Robust Tucker-Lewis Index (TLI)                            0.906\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)             -17716.771  -17716.771\n  Scaling correction factor                                  0.935\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)     -17331.363  -17331.363\n  Scaling correction factor                                  0.998\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                               35667.543   35667.543\n  Bayesian (BIC)                             36159.476   36159.476\n  Sample-size adjusted Bayesian (SABIC)      35788.115   35788.115\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.058       0.059\n  90 Percent confidence interval - lower         0.053       0.054\n  90 Percent confidence interval - upper         0.063       0.064\n  P-value H_0: RMSEA &lt;= 0.050                    0.003       0.002\n  P-value H_0: RMSEA &gt;= 0.080                    0.000       0.000\n                                                                  \n  Robust RMSEA                                               0.058\n  90 Percent confidence interval - lower                     0.054\n  90 Percent confidence interval - upper                     0.063\n  P-value H_0: Robust RMSEA &lt;= 0.050                         0.002\n  P-value H_0: Robust RMSEA &gt;= 0.080                         0.000\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.032       0.032\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  jobsat_1 =~                                                           \n    JOBSAT1 (ldj1)    0.996    0.041   24.099    0.000    0.996    0.818\n    JOBSAT1           1.019    0.042   24.487    0.000    1.019    0.814\n    JOBSAT1           0.956    0.040   23.787    0.000    0.956    0.798\n  jobsat_2 =~                                                           \n    JOBSAT2 (ldj1)    0.996    0.041   24.099    0.000    0.961    0.796\n    JOBSAT2           1.001    0.058   17.194    0.000    0.967    0.805\n    JOBSAT2           0.964    0.064   15.021    0.000    0.931    0.785\n  jobsat_3 =~                                                           \n    JOBSAT3 (ldj1)    0.996    0.041   24.099    0.000    0.861    0.776\n    JOBSAT3           0.980    0.066   14.839    0.000    0.848    0.773\n    JOBSAT3           1.070    0.071   15.159    0.000    0.926    0.806\n  ready_1 =~                                                            \n    READY11 (ldr1)    0.900    0.042   21.255    0.000    0.900    0.781\n    READY12           0.882    0.043   20.311    0.000    0.882    0.766\n    READY13           0.905    0.041   21.860    0.000    0.905    0.789\n  ready_2 =~                                                            \n    READY21 (ldr1)    0.900    0.042   21.255    0.000    0.947    0.795\n    READY22           0.785    0.053   14.924    0.000    0.826    0.731\n    READY23           0.821    0.056   14.581    0.000    0.864    0.750\n  ready_3 =~                                                            \n    READY31 (ldr1)    0.900    0.042   21.255    0.000    0.878    0.764\n    READY32           0.847    0.062   13.766    0.000    0.827    0.750\n    READY33           0.888    0.070   12.759    0.000    0.867    0.757\n  commit_1 =~                                                           \n    COMMIT1 (ldc1)    0.809    0.044   18.389    0.000    0.809    0.748\n    COMMIT1           0.825    0.041   19.985    0.000    0.825    0.755\n    COMMIT1           0.815    0.042   19.477    0.000    0.815    0.753\n  commit_2 =~                                                           \n    COMMIT2 (ldc1)    0.809    0.044   18.389    0.000    0.854    0.768\n    COMMIT2           0.818    0.058   14.105    0.000    0.863    0.768\n    COMMIT2           0.866    0.062   13.866    0.000    0.914    0.787\n  commit_3 =~                                                           \n    COMMIT3 (ldc1)    0.809    0.044   18.389    0.000    0.774    0.752\n    COMMIT3           0.771    0.059   13.123    0.000    0.738    0.706\n    COMMIT3           0.812    0.066   12.398    0.000    0.777    0.728\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  jobsat_1 ~~                                                           \n    jobsat_2          0.436    0.058    7.532    0.000    0.451    0.451\n    jobsat_3          0.325    0.052    6.288    0.000    0.375    0.375\n    ready_1           0.542    0.050   10.840    0.000    0.542    0.542\n    ready_2           0.286    0.062    4.611    0.000    0.271    0.271\n    ready_3           0.176    0.057    3.105    0.002    0.181    0.181\n    commit_1          0.581    0.046   12.496    0.000    0.581    0.581\n    commit_2          0.380    0.063    6.086    0.000    0.360    0.360\n    commit_3          0.237    0.056    4.211    0.000    0.248    0.248\n  jobsat_2 ~~                                                           \n    jobsat_3          0.381    0.057    6.665    0.000    0.456    0.456\n    ready_1           0.198    0.057    3.494    0.000    0.205    0.205\n    ready_2           0.508    0.067    7.574    0.000    0.500    0.500\n    ready_3           0.193    0.057    3.405    0.001    0.205    0.205\n    commit_1          0.278    0.055    5.049    0.000    0.288    0.288\n    commit_2          0.584    0.070    8.297    0.000    0.573    0.573\n    commit_3          0.260    0.059    4.431    0.000    0.281    0.281\n  jobsat_3 ~~                                                           \n    ready_1           0.201    0.048    4.224    0.000    0.232    0.232\n    ready_2           0.272    0.054    5.051    0.000    0.298    0.298\n    ready_3           0.451    0.063    7.182    0.000    0.534    0.534\n    commit_1          0.182    0.052    3.489    0.000    0.210    0.210\n    commit_2          0.265    0.059    4.503    0.000    0.290    0.290\n    commit_3          0.480    0.061    7.885    0.000    0.580    0.580\n  ready_1 ~~                                                            \n    ready_2           0.404    0.066    6.073    0.000    0.383    0.383\n    ready_3           0.323    0.059    5.445    0.000    0.331    0.331\n    commit_1          0.452    0.050    9.057    0.000    0.452    0.452\n    commit_2          0.282    0.065    4.332    0.000    0.267    0.267\n    commit_3          0.230    0.058    3.990    0.000    0.240    0.240\n  ready_2 ~~                                                            \n    ready_3           0.515    0.077    6.723    0.000    0.501    0.501\n    commit_1          0.270    0.062    4.373    0.000    0.256    0.256\n    commit_2          0.694    0.086    8.052    0.000    0.625    0.625\n    commit_3          0.309    0.066    4.709    0.000    0.307    0.307\n  ready_3 ~~                                                            \n    commit_1          0.175    0.059    2.981    0.003    0.180    0.180\n    commit_2          0.298    0.067    4.478    0.000    0.289    0.289\n    commit_3          0.452    0.070    6.414    0.000    0.484    0.484\n  commit_1 ~~                                                           \n    commit_2          0.632    0.065    9.669    0.000    0.598    0.598\n    commit_3          0.427    0.059    7.214    0.000    0.447    0.447\n  commit_2 ~~                                                           \n    commit_3          0.583    0.090    6.510    0.000    0.577    0.577\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n    jbst_1            0.000                               0.000    0.000\n    redy_1            0.000                               0.000    0.000\n    cmmt_1            0.000                               0.000    0.000\n    jbst_2           -0.000    0.062   -0.000    1.000   -0.000   -0.000\n    jbst_3            0.126    0.060    2.099    0.036    0.145    0.145\n    redy_2            0.056    0.070    0.802    0.422    0.053    0.053\n    redy_3            0.204    0.073    2.818    0.005    0.209    0.209\n    cmmt_2           -0.200    0.069   -2.885    0.004   -0.189   -0.189\n    cmmt_3           -0.172    0.071   -2.442    0.015   -0.180   -0.180\n   .JOBSAT (intj1)    3.319    0.055   60.662    0.000    3.319    2.727\n   .JOBSAT (intj1)    3.319    0.055   60.662    0.000    3.319    2.749\n   .JOBSAT (intj1)    3.319    0.055   60.662    0.000    3.319    2.989\n   .READY1 (intr1)    3.176    0.052   61.297    0.000    3.176    2.755\n   .READY2 (intr1)    3.176    0.052   61.297    0.000    3.176    2.665\n   .READY3 (intr1)    3.176    0.052   61.297    0.000    3.176    2.763\n   .COMMIT (intc1)    3.719    0.049   76.578    0.000    3.719    3.442\n   .COMMIT (intc1)    3.719    0.049   76.578    0.000    3.719    3.345\n   .COMMIT (intc1)    3.719    0.049   76.578    0.000    3.719    3.613\n   .JOBSAT            3.311    0.056   58.833    0.000    3.311    2.644\n   .JOBSAT            3.321    0.054   61.701    0.000    3.321    2.773\n   .JOBSAT            3.331    0.067   49.733    0.000    3.331    2.774\n   .JOBSAT            3.329    0.067   49.620    0.000    3.329    2.805\n   .JOBSAT            3.281    0.065   50.616    0.000    3.281    2.992\n   .JOBSAT            3.251    0.070   46.441    0.000    3.251    2.830\n   .READY1            3.198    0.052   61.778    0.000    3.198    2.777\n   .READY1            3.156    0.052   61.219    0.000    3.156    2.752\n   .READY2            3.170    0.061   51.554    0.000    3.170    2.807\n   .READY2            3.211    0.062   51.499    0.000    3.211    2.788\n   .READY3            3.156    0.066   47.871    0.000    3.156    2.864\n   .READY3            3.146    0.070   44.635    0.000    3.146    2.747\n   .COMMIT            3.653    0.049   74.420    0.000    3.653    3.345\n   .COMMIT            3.596    0.049   73.962    0.000    3.596    3.324\n   .COMMIT            3.689    0.064   57.387    0.000    3.689    3.282\n   .COMMIT            3.662    0.066   55.846    0.000    3.662    3.153\n   .COMMIT            3.749    0.061   61.081    0.000    3.749    3.586\n   .COMMIT            3.692    0.064   57.657    0.000    3.692    3.457\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n    jobsat_1          1.000                               1.000    1.000\n    ready_1           1.000                               1.000    1.000\n    commit_1          1.000                               1.000    1.000\n    jobsat_2          0.933    0.098    9.534    0.000    1.000    1.000\n    jobsat_3          0.748    0.087    8.650    0.000    1.000    1.000\n    ready_2           1.108    0.122    9.097    0.000    1.000    1.000\n    ready_3           0.952    0.122    7.786    0.000    1.000    1.000\n    commit_2          1.114    0.146    7.615    0.000    1.000    1.000\n    commit_3          0.916    0.127    7.204    0.000    1.000    1.000\n   .JOBSAT11          0.491    0.051    9.630    0.000    0.491    0.331\n   .JOBSAT12          0.529    0.049   10.895    0.000    0.529    0.337\n   .JOBSAT13          0.521    0.046   11.315    0.000    0.521    0.363\n   .JOBSAT21          0.533    0.052   10.209    0.000    0.533    0.366\n   .JOBSAT22          0.506    0.047   10.685    0.000    0.506    0.351\n   .JOBSAT23          0.542    0.052   10.394    0.000    0.542    0.384\n   .JOBSAT31          0.491    0.042   11.704    0.000    0.491    0.398\n   .JOBSAT32          0.484    0.043   11.164    0.000    0.484    0.403\n   .JOBSAT33          0.463    0.046   10.128    0.000    0.463    0.350\n   .READY11           0.519    0.051   10.112    0.000    0.519    0.391\n   .READY12           0.548    0.048   11.392    0.000    0.548    0.413\n   .READY13           0.496    0.048   10.318    0.000    0.496    0.377\n   .READY21           0.522    0.054    9.742    0.000    0.522    0.368\n   .READY22           0.593    0.049   12.067    0.000    0.593    0.465\n   .READY23           0.580    0.055   10.611    0.000    0.580    0.437\n   .READY31           0.550    0.054   10.190    0.000    0.550    0.417\n   .READY32           0.531    0.048   11.179    0.000    0.531    0.437\n   .READY33           0.560    0.048   11.585    0.000    0.560    0.427\n   .COMMIT11          0.514    0.050   10.191    0.000    0.514    0.440\n   .COMMIT12          0.512    0.045   11.266    0.000    0.512    0.429\n   .COMMIT13          0.506    0.047   10.756    0.000    0.506    0.432\n   .COMMIT21          0.508    0.046   10.932    0.000    0.508    0.411\n   .COMMIT22          0.518    0.047   11.112    0.000    0.518    0.410\n   .COMMIT23          0.513    0.051   10.121    0.000    0.513    0.380\n   .COMMIT31          0.461    0.043   10.761    0.000    0.461    0.435\n   .COMMIT32          0.548    0.054   10.095    0.000    0.548    0.501\n   .COMMIT33          0.536    0.048   11.080    0.000    0.536    0.470\n\nR-Square:\n                   Estimate\n    JOBSAT11          0.669\n    JOBSAT12          0.663\n    JOBSAT13          0.637\n    JOBSAT21          0.634\n    JOBSAT22          0.649\n    JOBSAT23          0.616\n    JOBSAT31          0.602\n    JOBSAT32          0.597\n    JOBSAT33          0.650\n    READY11           0.609\n    READY12           0.587\n    READY13           0.623\n    READY21           0.632\n    READY22           0.535\n    READY23           0.563\n    READY31           0.583\n    READY32           0.563\n    READY33           0.573\n    COMMIT11          0.560\n    COMMIT12          0.571\n    COMMIT13          0.568\n    COMMIT21          0.589\n    COMMIT22          0.590\n    COMMIT23          0.620\n    COMMIT31          0.565\n    COMMIT32          0.499\n    COMMIT33          0.530\n\n\n\n10.1.4 Modification Indices\n\nCodemodificationindices(\n  configuralInvariance_fit,\n  sort. = TRUE)\n\n\n  \n\n\n\n\n10.1.5 Path Diagram\n\nCodelavaanPlot::lavaanPlot2(\n  configuralInvariance_fit,\n  stand = TRUE,\n  coef_labels = TRUE)\n\n\nPath Diagram\n\n\nTo create an interactive path diagram, you can use the following syntax:\n\nCodelavaangui::plot_lavaan(configuralInvariance_fit)"
  },
  {
    "objectID": "structural-equation-models.html#configural-invariance-with-correlated-residuals-within-indicator-across-time",
    "href": "structural-equation-models.html#configural-invariance-with-correlated-residuals-within-indicator-across-time",
    "title": "Structural Equation Models",
    "section": "\n10.2 Configural Invariance With Correlated Residuals Within-Indicator Across Time",
    "text": "10.2 Configural Invariance With Correlated Residuals Within-Indicator Across Time\n\nStandardize the latent factor(s) at T1 (i.e., fix the mean to zero and the variance to one)\nFor each latent construct, constrain the first indicator’s factor loading to be the same across time\nFor each latent construct, constrain the first indicator’s intercept to be the same across time\nAllow within-indicator residuals to covary across time\n\n\n10.2.1 Model Syntax\n\nCodeconfiguralInvarianceCorrelatedResiduals_syntax &lt;- '\n  # Factor Loadings\n  jobsat_1 =~ NA*loadj1*JOBSAT11 + JOBSAT12 + JOBSAT13\n  jobsat_2 =~ NA*loadj1*JOBSAT21 + JOBSAT22 + JOBSAT23\n  jobsat_3 =~ NA*loadj1*JOBSAT31 + JOBSAT32 + JOBSAT33\n  \n  ready_1 =~ NA*loadr1*READY11 + READY12 + READY13\n  ready_2 =~ NA*loadr1*READY21 + READY22 + READY23\n  ready_3 =~ NA*loadr1*READY31 + READY32 + READY33\n  \n  commit_1 =~ NA*loadc1*COMMIT11 + COMMIT12 + COMMIT13\n  commit_2 =~ NA*loadc1*COMMIT21 + COMMIT22 + COMMIT23\n  commit_3 =~ NA*loadc1*COMMIT31 + COMMIT32 + COMMIT33\n  \n  # Factor Identification: Standardize Factors at T1\n  \n  ## Fix Factor Means at T1 to Zero\n  jobsat_1 ~ 0*1\n  ready_1 ~ 0*1\n  commit_1 ~ 0*1\n  \n  ## Fix Factor Variances at T1 to One\n  jobsat_1 ~~ 1*jobsat_1\n  ready_1 ~~ 1*ready_1\n  commit_1 ~~ 1*commit_1\n  \n  # Freely Estimate Factor Means at T2 and T3 (relative to T1)\n  jobsat_2 ~ 1\n  jobsat_3 ~ 1\n  \n  ready_2 ~ 1\n  ready_3 ~ 1\n  \n  commit_2 ~ 1\n  commit_3 ~ 1\n  \n  # Freely Estimate Factor Variances at T2 and T3 (relative to T1)\n  jobsat_2 ~~ jobsat_2\n  jobsat_3 ~~ jobsat_3\n  \n  ready_2 ~~ ready_2\n  ready_3 ~~ ready_3\n  \n  commit_2 ~~ commit_2\n  commit_3 ~~ commit_3\n  \n  # Fix Intercepts of Indicator 1 Across Time\n  JOBSAT11 ~ intj1*1\n  JOBSAT21 ~ intj1*1\n  JOBSAT31 ~ intj1*1\n  \n  READY11 ~ intr1*1\n  READY21 ~ intr1*1\n  READY31 ~ intr1*1\n  \n  COMMIT11 ~ intc1*1\n  COMMIT21 ~ intc1*1\n  COMMIT31 ~ intc1*1\n  \n  # Free Intercepts of Remaining Manifest Variables\n  JOBSAT12 ~ 1\n  JOBSAT13 ~ 1\n  JOBSAT22 ~ 1\n  JOBSAT23 ~ 1\n  JOBSAT32 ~ 1\n  JOBSAT33 ~ 1\n  \n  READY12 ~ 1\n  READY13 ~ 1\n  READY22 ~ 1\n  READY23 ~ 1\n  READY32 ~ 1\n  READY33 ~ 1\n  \n  COMMIT12 ~ 1\n  COMMIT13 ~ 1\n  COMMIT22 ~ 1\n  COMMIT23 ~ 1\n  COMMIT32 ~ 1\n  COMMIT33 ~ 1\n  \n  # Estimate Residual Variances of Manifest Variables\n  JOBSAT11 ~~ JOBSAT11\n  JOBSAT12 ~~ JOBSAT12\n  JOBSAT13 ~~ JOBSAT13\n  JOBSAT21 ~~ JOBSAT21\n  JOBSAT22 ~~ JOBSAT22\n  JOBSAT23 ~~ JOBSAT23\n  JOBSAT31 ~~ JOBSAT31\n  JOBSAT32 ~~ JOBSAT32\n  JOBSAT33 ~~ JOBSAT33\n  \n  READY11 ~~ READY11\n  READY12 ~~ READY12\n  READY13 ~~ READY13\n  READY21 ~~ READY21\n  READY22 ~~ READY22\n  READY23 ~~ READY23\n  READY31 ~~ READY31\n  READY32 ~~ READY32\n  READY33 ~~ READY33\n  \n  COMMIT11 ~~ COMMIT11\n  COMMIT12 ~~ COMMIT12\n  COMMIT13 ~~ COMMIT13\n  COMMIT21 ~~ COMMIT21\n  COMMIT22 ~~ COMMIT22\n  COMMIT23 ~~ COMMIT23\n  COMMIT31 ~~ COMMIT31\n  COMMIT32 ~~ COMMIT32\n  COMMIT33 ~~ COMMIT33\n  \n  # Residual Covariances Within Indicator Across Time\n  JOBSAT11 ~~ JOBSAT21\n  JOBSAT21 ~~ JOBSAT31\n  JOBSAT11 ~~ JOBSAT31\n  \n  JOBSAT12 ~~ JOBSAT22\n  JOBSAT22 ~~ JOBSAT32\n  JOBSAT12 ~~ JOBSAT32\n  \n  JOBSAT13 ~~ JOBSAT23\n  JOBSAT23 ~~ JOBSAT33\n  JOBSAT13 ~~ JOBSAT33\n  \n  READY11 ~~ READY21\n  READY21 ~~ READY31\n  READY11 ~~ READY31\n  \n  READY12 ~~ READY22\n  READY22 ~~ READY32\n  READY12 ~~ READY32\n  \n  READY13 ~~ READY23\n  READY23 ~~ READY33\n  READY13 ~~ READY33\n  \n  COMMIT11 ~~ COMMIT21\n  COMMIT21 ~~ COMMIT31\n  COMMIT11 ~~ COMMIT31\n  \n  COMMIT12 ~~ COMMIT22\n  COMMIT22 ~~ COMMIT32\n  COMMIT12 ~~ COMMIT32\n  \n  COMMIT13 ~~ COMMIT23\n  COMMIT23 ~~ COMMIT33\n  COMMIT13 ~~ COMMIT33\n'\n\n\n\n10.2.2 Fit Model\n\nCodeconfiguralInvarianceCorrelatedResiduals_fit &lt;- cfa(\n  configuralInvarianceCorrelatedResiduals_syntax,\n  data = longitudinalMI1,\n  missing = \"ML\", # FIML\n  estimator = \"MLR\", # Huber-White robust standard errors (for heteroscedasticity and nonnormally distributed residuals)\n  meanstructure = TRUE, # estimate means/intercepts\n  fixed.x = FALSE) # estimate means, variances, and covariances of the observed variables (to include predictors as part of FIML)\n\n\n\n10.2.3 Model Summary\n\nCodesummary(\n  configuralInvarianceCorrelatedResiduals_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 105 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                       156\n  Number of equality constraints                    12\n\n  Number of observations                           495\n  Number of missing patterns                         1\n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                               277.582     281.997\n  Degrees of freedom                               261         261\n  P-value (Chi-square)                           0.230       0.178\n  Scaling correction factor                                  0.984\n    Yuan-Bentler correction (Mplus variant)                       \n\nModel Test Baseline Model:\n\n  Test statistic                              6697.063    6541.933\n  Degrees of freedom                               351         351\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  1.024\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.997       0.997\n  Tucker-Lewis Index (TLI)                       0.996       0.995\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.997\n  Robust Tucker-Lewis Index (TLI)                            0.996\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)             -17470.154  -17470.154\n  Scaling correction factor                                  0.943\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)     -17331.363  -17331.363\n  Scaling correction factor                                  0.998\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                               35228.308   35228.308\n  Bayesian (BIC)                             35833.764   35833.764\n  Sample-size adjusted Bayesian (SABIC)      35376.705   35376.705\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.011       0.013\n  90 Percent confidence interval - lower         0.000       0.000\n  90 Percent confidence interval - upper         0.022       0.023\n  P-value H_0: RMSEA &lt;= 0.050                    1.000       1.000\n  P-value H_0: RMSEA &gt;= 0.080                    0.000       0.000\n                                                                  \n  Robust RMSEA                                               0.012\n  90 Percent confidence interval - lower                     0.000\n  90 Percent confidence interval - upper                     0.022\n  P-value H_0: Robust RMSEA &lt;= 0.050                         1.000\n  P-value H_0: Robust RMSEA &gt;= 0.080                         0.000\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.023       0.023\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  jobsat_1 =~                                                           \n    JOBSAT1 (ldj1)    0.979    0.041   23.788    0.000    0.979    0.810\n    JOBSAT1           1.026    0.041   24.962    0.000    1.026    0.815\n    JOBSAT1           0.965    0.039   24.509    0.000    0.965    0.806\n  jobsat_2 =~                                                           \n    JOBSAT2 (ldj1)    0.979    0.041   23.788    0.000    0.946    0.786\n    JOBSAT2           0.995    0.058   17.082    0.000    0.961    0.805\n    JOBSAT2           0.983    0.065   15.181    0.000    0.949    0.794\n  jobsat_3 =~                                                           \n    JOBSAT3 (ldj1)    0.979    0.041   23.788    0.000    0.853    0.772\n    JOBSAT3           0.976    0.066   14.902    0.000    0.851    0.775\n    JOBSAT3           1.070    0.070   15.313    0.000    0.932    0.807\n  ready_1 =~                                                            \n    READY11 (ldr1)    0.910    0.042   21.715    0.000    0.910    0.787\n    READY12           0.871    0.043   20.162    0.000    0.871    0.760\n    READY13           0.901    0.042   21.676    0.000    0.901    0.786\n  ready_2 =~                                                            \n    READY21 (ldr1)    0.910    0.042   21.715    0.000    0.950    0.797\n    READY22           0.779    0.053   14.602    0.000    0.813    0.723\n    READY23           0.836    0.057   14.618    0.000    0.873    0.756\n  ready_3 =~                                                            \n    READY31 (ldr1)    0.910    0.042   21.715    0.000    0.884    0.768\n    READY32           0.842    0.062   13.664    0.000    0.818    0.744\n    READY33           0.897    0.070   12.814    0.000    0.871    0.760\n  commit_1 =~                                                           \n    COMMIT1 (ldc1)    0.818    0.043   19.142    0.000    0.818    0.756\n    COMMIT1           0.829    0.042   19.691    0.000    0.829    0.757\n    COMMIT1           0.798    0.042   19.211    0.000    0.798    0.742\n  commit_2 =~                                                           \n    COMMIT2 (ldc1)    0.818    0.043   19.142    0.000    0.856    0.771\n    COMMIT2           0.827    0.060   13.839    0.000    0.866    0.770\n    COMMIT2           0.867    0.063   13.794    0.000    0.908    0.782\n  commit_3 =~                                                           \n    COMMIT3 (ldc1)    0.818    0.043   19.142    0.000    0.763    0.745\n    COMMIT3           0.792    0.062   12.811    0.000    0.740    0.708\n    COMMIT3           0.844    0.069   12.227    0.000    0.788    0.734\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n .JOBSAT11 ~~                                                           \n   .JOBSAT21          0.114    0.032    3.543    0.000    0.114    0.216\n .JOBSAT21 ~~                                                           \n   .JOBSAT31          0.122    0.032    3.835    0.000    0.122    0.234\n .JOBSAT11 ~~                                                           \n   .JOBSAT31          0.150    0.029    5.113    0.000    0.150    0.301\n .JOBSAT12 ~~                                                           \n   .JOBSAT22          0.151    0.034    4.431    0.000    0.151    0.293\n .JOBSAT22 ~~                                                           \n   .JOBSAT32          0.097    0.030    3.223    0.001    0.097    0.197\n .JOBSAT12 ~~                                                           \n   .JOBSAT32          0.075    0.032    2.389    0.017    0.075    0.149\n .JOBSAT13 ~~                                                           \n   .JOBSAT23          0.093    0.033    2.802    0.005    0.093    0.179\n .JOBSAT23 ~~                                                           \n   .JOBSAT33          0.145    0.034    4.324    0.000    0.145    0.293\n .JOBSAT13 ~~                                                           \n   .JOBSAT33          0.114    0.031    3.627    0.000    0.114    0.236\n .READY11 ~~                                                            \n   .READY21           0.135    0.033    4.052    0.000    0.135    0.264\n .READY21 ~~                                                            \n   .READY31           0.104    0.032    3.259    0.001    0.104    0.197\n .READY11 ~~                                                            \n   .READY31           0.100    0.033    3.043    0.002    0.100    0.190\n .READY12 ~~                                                            \n   .READY22           0.181    0.033    5.443    0.000    0.181    0.313\n .READY22 ~~                                                            \n   .READY32           0.175    0.037    4.681    0.000    0.175    0.306\n .READY12 ~~                                                            \n   .READY32           0.119    0.034    3.482    0.000    0.119    0.217\n .READY13 ~~                                                            \n   .READY23           0.134    0.033    4.036    0.000    0.134    0.250\n .READY23 ~~                                                            \n   .READY33           0.169    0.035    4.859    0.000    0.169    0.300\n .READY13 ~~                                                            \n   .READY33           0.116    0.033    3.566    0.000    0.116    0.220\n .COMMIT11 ~~                                                           \n   .COMMIT21          0.123    0.032    3.839    0.000    0.123    0.245\n .COMMIT21 ~~                                                           \n   .COMMIT31          0.143    0.031    4.553    0.000    0.143    0.295\n .COMMIT11 ~~                                                           \n   .COMMIT31          0.108    0.030    3.641    0.000    0.108    0.223\n .COMMIT12 ~~                                                           \n   .COMMIT22          0.099    0.032    3.047    0.002    0.099    0.193\n .COMMIT22 ~~                                                           \n   .COMMIT32          0.122    0.034    3.634    0.000    0.122    0.231\n .COMMIT12 ~~                                                           \n   .COMMIT32          0.084    0.031    2.711    0.007    0.084    0.159\n .COMMIT13 ~~                                                           \n   .COMMIT23          0.172    0.034    5.097    0.000    0.172    0.330\n .COMMIT23 ~~                                                           \n   .COMMIT33          0.147    0.031    4.725    0.000    0.147    0.278\n .COMMIT13 ~~                                                           \n   .COMMIT33          0.113    0.033    3.424    0.001    0.113    0.214\n  jobsat_1 ~~                                                           \n    jobsat_2          0.394    0.057    6.887    0.000    0.407    0.407\n    jobsat_3          0.288    0.051    5.618    0.000    0.331    0.331\n    ready_1           0.541    0.050   10.755    0.000    0.541    0.541\n    ready_2           0.287    0.062    4.624    0.000    0.274    0.274\n    ready_3           0.176    0.057    3.114    0.002    0.181    0.181\n    commit_1          0.579    0.047   12.433    0.000    0.579    0.579\n    commit_2          0.376    0.062    6.086    0.000    0.359    0.359\n    commit_3          0.229    0.055    4.147    0.000    0.245    0.245\n  jobsat_2 ~~                                                           \n    jobsat_3          0.343    0.057    6.053    0.000    0.408    0.408\n    ready_1           0.201    0.056    3.567    0.000    0.208    0.208\n    ready_2           0.509    0.067    7.634    0.000    0.505    0.505\n    ready_3           0.193    0.057    3.419    0.001    0.206    0.206\n    commit_1          0.279    0.055    5.037    0.000    0.289    0.289\n    commit_2          0.580    0.071    8.184    0.000    0.573    0.573\n    commit_3          0.254    0.058    4.378    0.000    0.282    0.282\n  jobsat_3 ~~                                                           \n    ready_1           0.200    0.048    4.178    0.000    0.230    0.230\n    ready_2           0.269    0.054    4.959    0.000    0.295    0.295\n    ready_3           0.447    0.063    7.045    0.000    0.528    0.528\n    commit_1          0.185    0.053    3.508    0.000    0.213    0.213\n    commit_2          0.264    0.059    4.472    0.000    0.289    0.289\n    commit_3          0.471    0.061    7.760    0.000    0.579    0.579\n  ready_1 ~~                                                            \n    ready_2           0.334    0.066    5.086    0.000    0.320    0.320\n    ready_3           0.274    0.058    4.679    0.000    0.282    0.282\n    commit_1          0.453    0.050    9.111    0.000    0.453    0.453\n    commit_2          0.281    0.065    4.354    0.000    0.268    0.268\n    commit_3          0.223    0.056    3.959    0.000    0.239    0.239\n  ready_2 ~~                                                            \n    ready_3           0.442    0.073    6.032    0.000    0.436    0.436\n    commit_1          0.269    0.062    4.342    0.000    0.257    0.257\n    commit_2          0.681    0.085    8.018    0.000    0.623    0.623\n    commit_3          0.296    0.064    4.659    0.000    0.304    0.304\n  ready_3 ~~                                                            \n    commit_1          0.175    0.059    2.993    0.003    0.181    0.181\n    commit_2          0.296    0.065    4.546    0.000    0.291    0.291\n    commit_3          0.437    0.068    6.450    0.000    0.482    0.482\n  commit_1 ~~                                                           \n    commit_2          0.562    0.062    9.025    0.000    0.537    0.537\n    commit_3          0.368    0.058    6.400    0.000    0.395    0.395\n  commit_2 ~~                                                           \n    commit_3          0.499    0.083    6.043    0.000    0.510    0.510\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n    jbst_1            0.000                               0.000    0.000\n    redy_1            0.000                               0.000    0.000\n    cmmt_1            0.000                               0.000    0.000\n    jbst_2            0.000    0.063    0.000    1.000    0.000    0.000\n    jbst_3            0.128    0.061    2.103    0.036    0.147    0.147\n    redy_2            0.055    0.069    0.802    0.423    0.053    0.053\n    redy_3            0.202    0.072    2.825    0.005    0.208    0.208\n    cmmt_2           -0.198    0.068   -2.899    0.004   -0.189   -0.189\n    cmmt_3           -0.170    0.070   -2.450    0.014   -0.183   -0.183\n   .JOBSAT (intj1)    3.319    0.055   60.662    0.000    3.319    2.744\n   .JOBSAT (intj1)    3.319    0.055   60.662    0.000    3.319    2.756\n   .JOBSAT (intj1)    3.319    0.055   60.662    0.000    3.319    3.004\n   .READY1 (intr1)    3.176    0.052   61.296    0.000    3.176    2.746\n   .READY2 (intr1)    3.176    0.052   61.296    0.000    3.176    2.665\n   .READY3 (intr1)    3.176    0.052   61.296    0.000    3.176    2.758\n   .COMMIT (intc1)    3.719    0.049   76.578    0.000    3.719    3.437\n   .COMMIT (intc1)    3.719    0.049   76.578    0.000    3.719    3.348\n   .COMMIT (intc1)    3.719    0.049   76.578    0.000    3.719    3.630\n   .JOBSAT            3.311    0.056   58.833    0.000    3.311    2.631\n   .JOBSAT            3.321    0.054   61.701    0.000    3.321    2.774\n   .JOBSAT            3.331    0.067   49.453    0.000    3.331    2.791\n   .JOBSAT            3.329    0.068   48.605    0.000    3.329    2.783\n   .JOBSAT            3.279    0.065   50.341    0.000    3.279    2.990\n   .JOBSAT            3.249    0.071   46.030    0.000    3.249    2.814\n   .READY1            3.198    0.052   61.778    0.000    3.198    2.790\n   .READY1            3.156    0.052   61.219    0.000    3.156    2.754\n   .READY2            3.171    0.061   52.068    0.000    3.171    2.819\n   .READY2            3.210    0.063   51.298    0.000    3.210    2.778\n   .READY3            3.159    0.065   48.549    0.000    3.159    2.875\n   .READY3            3.146    0.070   44.824    0.000    3.146    2.744\n   .COMMIT            3.653    0.049   74.419    0.000    3.653    3.335\n   .COMMIT            3.596    0.049   73.962    0.000    3.596    3.345\n   .COMMIT            3.689    0.064   57.549    0.000    3.689    3.282\n   .COMMIT            3.660    0.065   55.988    0.000    3.660    3.152\n   .COMMIT            3.751    0.062   60.799    0.000    3.751    3.591\n   .COMMIT            3.695    0.065   56.956    0.000    3.695    3.443\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n    jobsat_1          1.000                               1.000    1.000\n    ready_1           1.000                               1.000    1.000\n    commit_1          1.000                               1.000    1.000\n    jobsat_2          0.933    0.101    9.252    0.000    1.000    1.000\n    jobsat_3          0.759    0.089    8.559    0.000    1.000    1.000\n    ready_2           1.090    0.122    8.925    0.000    1.000    1.000\n    ready_3           0.943    0.121    7.772    0.000    1.000    1.000\n    commit_2          1.096    0.145    7.585    0.000    1.000    1.000\n    commit_3          0.871    0.122    7.138    0.000    1.000    1.000\n   .JOBSAT11          0.504    0.051    9.893    0.000    0.504    0.345\n   .JOBSAT12          0.532    0.049   10.784    0.000    0.532    0.336\n   .JOBSAT13          0.503    0.046   11.012    0.000    0.503    0.351\n   .JOBSAT21          0.555    0.052   10.639    0.000    0.555    0.382\n   .JOBSAT22          0.502    0.049   10.149    0.000    0.502    0.352\n   .JOBSAT23          0.530    0.053    9.904    0.000    0.530    0.370\n   .JOBSAT31          0.493    0.043   11.464    0.000    0.493    0.404\n   .JOBSAT32          0.480    0.043   11.113    0.000    0.480    0.399\n   .JOBSAT33          0.464    0.047    9.967    0.000    0.464    0.348\n   .READY11           0.509    0.052    9.752    0.000    0.509    0.381\n   .READY12           0.555    0.049   11.433    0.000    0.555    0.422\n   .READY13           0.502    0.049   10.322    0.000    0.502    0.382\n   .READY21           0.517    0.054    9.531    0.000    0.517    0.364\n   .READY22           0.604    0.051   11.805    0.000    0.604    0.477\n   .READY23           0.573    0.055   10.331    0.000    0.573    0.429\n   .READY31           0.545    0.056    9.740    0.000    0.545    0.411\n   .READY32           0.539    0.049   11.090    0.000    0.539    0.446\n   .READY33           0.555    0.049   11.299    0.000    0.555    0.422\n   .COMMIT11          0.503    0.051    9.807    0.000    0.503    0.429\n   .COMMIT12          0.512    0.048   10.667    0.000    0.512    0.427\n   .COMMIT13          0.519    0.049   10.666    0.000    0.519    0.449\n   .COMMIT21          0.501    0.048   10.519    0.000    0.501    0.406\n   .COMMIT22          0.514    0.050   10.359    0.000    0.514    0.407\n   .COMMIT23          0.524    0.052   10.053    0.000    0.524    0.389\n   .COMMIT31          0.467    0.044   10.613    0.000    0.467    0.445\n   .COMMIT32          0.545    0.057    9.611    0.000    0.545    0.499\n   .COMMIT33          0.532    0.051   10.472    0.000    0.532    0.461\n\nR-Square:\n                   Estimate\n    JOBSAT11          0.655\n    JOBSAT12          0.664\n    JOBSAT13          0.649\n    JOBSAT21          0.618\n    JOBSAT22          0.648\n    JOBSAT23          0.630\n    JOBSAT31          0.596\n    JOBSAT32          0.601\n    JOBSAT33          0.652\n    READY11           0.619\n    READY12           0.578\n    READY13           0.618\n    READY21           0.636\n    READY22           0.523\n    READY23           0.571\n    READY31           0.589\n    READY32           0.554\n    READY33           0.578\n    COMMIT11          0.571\n    COMMIT12          0.573\n    COMMIT13          0.551\n    COMMIT21          0.594\n    COMMIT22          0.593\n    COMMIT23          0.611\n    COMMIT31          0.555\n    COMMIT32          0.501\n    COMMIT33          0.539\n\n\n\n10.2.4 Modification Indices\n\nCodemodificationindices(\n  configuralInvarianceCorrelatedResiduals_fit,\n  sort. = TRUE)\n\n\n  \n\n\n\n\n10.2.5 Path Diagram\n\nCodelavaanPlot::lavaanPlot2(\n  configuralInvarianceCorrelatedResiduals_fit,\n  stand = TRUE,\n  coef_labels = TRUE)\n\n\nPath Diagram\n\n\nTo create an interactive path diagram, you can use the following syntax:\n\nCodelavaangui::plot_lavaan(configuralInvarianceCorrelatedResiduals_fit)\n\n\n\n10.2.6 Compare Models\n\nCodeanova(\n  configuralInvariance_fit,\n  configuralInvarianceCorrelatedResiduals_fit\n)"
  },
  {
    "objectID": "structural-equation-models.html#metric-weak-factorial-invariance",
    "href": "structural-equation-models.html#metric-weak-factorial-invariance",
    "title": "Structural Equation Models",
    "section": "\n10.3 Metric (“Weak Factorial”) Invariance",
    "text": "10.3 Metric (“Weak Factorial”) Invariance\nA metric invariance model evaluates whether the items’ factor loadings are the same across time.\n\nStandardize the latent factor(s) at T1 (i.e., fix the mean to zero and the variance to one)\nFor each latent construct, constrain the first indicator’s intercept to be the same across time\nAllow within-indicator residuals to covary across time\nFor each indicator, constrain its factor loading to be the same across time\n\n\n10.3.1 Model Syntax\n\nCodemetricInvariance_syntax &lt;- '\n  # Factor Loadings\n  jobsat_1 =~ NA*loadj1*JOBSAT11 + loadj2*JOBSAT12 + loadj3*JOBSAT13\n  jobsat_2 =~ NA*loadj1*JOBSAT21 + loadj2*JOBSAT22 + loadj3*JOBSAT23\n  jobsat_3 =~ NA*loadj1*JOBSAT31 + loadj2*JOBSAT32 + loadj3*JOBSAT33\n  \n  ready_1 =~ NA*loadr1*READY11 + loadr2*READY12 + loadr3*READY13\n  ready_2 =~ NA*loadr1*READY21 + loadr2*READY22 + loadr3*READY23\n  ready_3 =~ NA*loadr1*READY31 + loadr2*READY32 + loadr3*READY33\n  \n  commit_1 =~ NA*loadc1*COMMIT11 + loadc2*COMMIT12 + loadc3*COMMIT13\n  commit_2 =~ NA*loadc1*COMMIT21 + loadc2*COMMIT22 + loadc3*COMMIT23\n  commit_3 =~ NA*loadc1*COMMIT31 + loadc2*COMMIT32 + loadc3*COMMIT33\n  \n  # Factor Identification: Standardize Factors at T1\n  \n  ## Fix Factor Means at T1 to Zero\n  jobsat_1 ~ 0*1\n  ready_1 ~ 0*1\n  commit_1 ~ 0*1\n  \n  ## Fix Factor Variances at T1 to One\n  jobsat_1 ~~ 1*jobsat_1\n  ready_1 ~~ 1*ready_1\n  commit_1 ~~ 1*commit_1\n  \n  # Freely Estimate Factor Means at T2 and T3 (relative to T1)\n  jobsat_2 ~ 1\n  jobsat_3 ~ 1\n  \n  ready_2 ~ 1\n  ready_3 ~ 1\n  \n  commit_2 ~ 1\n  commit_3 ~ 1\n  \n  # Freely Estimate Factor Variances at T2 and T3 (relative to T1)\n  jobsat_2 ~~ jobsat_2\n  jobsat_3 ~~ jobsat_3\n  \n  ready_2 ~~ ready_2\n  ready_3 ~~ ready_3\n  \n  commit_2 ~~ commit_2\n  commit_3 ~~ commit_3\n  \n  # Fix Intercepts of Indicator 1 Across Time\n  JOBSAT11 ~ intj1*1\n  JOBSAT21 ~ intj1*1\n  JOBSAT31 ~ intj1*1\n  \n  READY11 ~ intr1*1\n  READY21 ~ intr1*1\n  READY31 ~ intr1*1\n  \n  COMMIT11 ~ intc1*1\n  COMMIT21 ~ intc1*1\n  COMMIT31 ~ intc1*1\n  \n  # Free Intercepts of Remaining Manifest Variables\n  JOBSAT12 ~ 1\n  JOBSAT13 ~ 1\n  JOBSAT22 ~ 1\n  JOBSAT23 ~ 1\n  JOBSAT32 ~ 1\n  JOBSAT33 ~ 1\n  \n  READY12 ~ 1\n  READY13 ~ 1\n  READY22 ~ 1\n  READY23 ~ 1\n  READY32 ~ 1\n  READY33 ~ 1\n  \n  COMMIT12 ~ 1\n  COMMIT13 ~ 1\n  COMMIT22 ~ 1\n  COMMIT23 ~ 1\n  COMMIT32 ~ 1\n  COMMIT33 ~ 1\n  \n  # Estimate Residual Variances of Manifest Variables\n  JOBSAT11 ~~ JOBSAT11\n  JOBSAT12 ~~ JOBSAT12\n  JOBSAT13 ~~ JOBSAT13\n  JOBSAT21 ~~ JOBSAT21\n  JOBSAT22 ~~ JOBSAT22\n  JOBSAT23 ~~ JOBSAT23\n  JOBSAT31 ~~ JOBSAT31\n  JOBSAT32 ~~ JOBSAT32\n  JOBSAT33 ~~ JOBSAT33\n  \n  READY11 ~~ READY11\n  READY12 ~~ READY12\n  READY13 ~~ READY13\n  READY21 ~~ READY21\n  READY22 ~~ READY22\n  READY23 ~~ READY23\n  READY31 ~~ READY31\n  READY32 ~~ READY32\n  READY33 ~~ READY33\n  \n  COMMIT11 ~~ COMMIT11\n  COMMIT12 ~~ COMMIT12\n  COMMIT13 ~~ COMMIT13\n  COMMIT21 ~~ COMMIT21\n  COMMIT22 ~~ COMMIT22\n  COMMIT23 ~~ COMMIT23\n  COMMIT31 ~~ COMMIT31\n  COMMIT32 ~~ COMMIT32\n  COMMIT33 ~~ COMMIT33\n  \n  # Residual Covariances Within Indicator Across Time\n  JOBSAT11 ~~ JOBSAT21\n  JOBSAT21 ~~ JOBSAT31\n  JOBSAT11 ~~ JOBSAT31\n  \n  JOBSAT12 ~~ JOBSAT22\n  JOBSAT22 ~~ JOBSAT32\n  JOBSAT12 ~~ JOBSAT32\n  \n  JOBSAT13 ~~ JOBSAT23\n  JOBSAT23 ~~ JOBSAT33\n  JOBSAT13 ~~ JOBSAT33\n  \n  READY11 ~~ READY21\n  READY21 ~~ READY31\n  READY11 ~~ READY31\n  \n  READY12 ~~ READY22\n  READY22 ~~ READY32\n  READY12 ~~ READY32\n  \n  READY13 ~~ READY23\n  READY23 ~~ READY33\n  READY13 ~~ READY33\n  \n  COMMIT11 ~~ COMMIT21\n  COMMIT21 ~~ COMMIT31\n  COMMIT11 ~~ COMMIT31\n  \n  COMMIT12 ~~ COMMIT22\n  COMMIT22 ~~ COMMIT32\n  COMMIT12 ~~ COMMIT32\n  \n  COMMIT13 ~~ COMMIT23\n  COMMIT23 ~~ COMMIT33\n  COMMIT13 ~~ COMMIT33\n'\n\n\n\n10.3.2 Fit Model\n\nCodemetricInvariance_fit &lt;- cfa(\n  metricInvariance_syntax,\n  data = longitudinalMI1,\n  missing = \"ML\", # FIML\n  estimator = \"MLR\", # Huber-White robust standard errors (for heteroscedasticity and nonnormally distributed residuals)\n  meanstructure = TRUE, # estimate means/intercepts\n  fixed.x = FALSE) # estimate means, variances, and covariances of the observed variables (to include predictors as part of FIML)\n\n\n\n10.3.3 Model Summary\n\nCodesummary(\n  metricInvariance_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 91 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                       156\n  Number of equality constraints                    24\n\n  Number of observations                           495\n  Number of missing patterns                         1\n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                               286.159     292.814\n  Degrees of freedom                               273         273\n  P-value (Chi-square)                           0.280       0.196\n  Scaling correction factor                                  0.977\n    Yuan-Bentler correction (Mplus variant)                       \n\nModel Test Baseline Model:\n\n  Test statistic                              6697.063    6541.933\n  Degrees of freedom                               351         351\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  1.024\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.998       0.997\n  Tucker-Lewis Index (TLI)                       0.997       0.996\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.997\n  Robust Tucker-Lewis Index (TLI)                            0.996\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)             -17474.443  -17474.443\n  Scaling correction factor                                  0.880\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)     -17331.363  -17331.363\n  Scaling correction factor                                  0.998\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                               35212.885   35212.885\n  Bayesian (BIC)                             35767.887   35767.887\n  Sample-size adjusted Bayesian (SABIC)      35348.916   35348.916\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.010       0.012\n  90 Percent confidence interval - lower         0.000       0.000\n  90 Percent confidence interval - upper         0.021       0.022\n  P-value H_0: RMSEA &lt;= 0.050                    1.000       1.000\n  P-value H_0: RMSEA &gt;= 0.080                    0.000       0.000\n                                                                  \n  Robust RMSEA                                               0.012\n  90 Percent confidence interval - lower                     0.000\n  90 Percent confidence interval - upper                     0.022\n  P-value H_0: Robust RMSEA &lt;= 0.050                         1.000\n  P-value H_0: Robust RMSEA &gt;= 0.080                         0.000\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.024       0.024\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  jobsat_1 =~                                                           \n    JOBSAT1 (ldj1)    0.974    0.036   26.751    0.000    0.974    0.807\n    JOBSAT1 (ldj2)    0.995    0.035   28.661    0.000    0.995    0.801\n    JOBSAT1 (ldj3)    0.995    0.036   27.941    0.000    0.995    0.819\n  jobsat_2 =~                                                           \n    JOBSAT2 (ldj1)    0.974    0.036   26.751    0.000    0.937    0.781\n    JOBSAT2 (ldj2)    0.995    0.035   28.661    0.000    0.957    0.803\n    JOBSAT2 (ldj3)    0.995    0.036   27.941    0.000    0.957    0.797\n  jobsat_3 =~                                                           \n    JOBSAT3 (ldj1)    0.974    0.036   26.751    0.000    0.866    0.778\n    JOBSAT3 (ldj2)    0.995    0.035   28.661    0.000    0.884    0.793\n    JOBSAT3 (ldj3)    0.995    0.036   27.941    0.000    0.884    0.783\n  ready_1 =~                                                            \n    READY11 (ldr1)    0.930    0.036   25.486    0.000    0.930    0.797\n    READY12 (ldr2)    0.850    0.036   23.877    0.000    0.850    0.748\n    READY13 (ldr3)    0.899    0.036   24.965    0.000    0.899    0.785\n  ready_2 =~                                                            \n    READY21 (ldr1)    0.930    0.036   25.486    0.000    0.916    0.779\n    READY22 (ldr2)    0.850    0.036   23.877    0.000    0.837    0.737\n    READY23 (ldr3)    0.899    0.036   24.965    0.000    0.886    0.763\n  ready_3 =~                                                            \n    READY31 (ldr1)    0.930    0.036   25.486    0.000    0.893    0.773\n    READY32 (ldr2)    0.850    0.036   23.877    0.000    0.816    0.743\n    READY33 (ldr3)    0.899    0.036   24.965    0.000    0.864    0.756\n  commit_1 =~                                                           \n    COMMIT1 (ldc1)    0.807    0.036   22.195    0.000    0.807    0.749\n    COMMIT1 (ldc2)    0.807    0.036   22.194    0.000    0.807    0.744\n    COMMIT1 (ldc3)    0.826    0.036   22.787    0.000    0.826    0.759\n  commit_2 =~                                                           \n    COMMIT2 (ldc1)    0.807    0.036   22.195    0.000    0.870    0.778\n    COMMIT2 (ldc2)    0.807    0.036   22.194    0.000    0.870    0.773\n    COMMIT2 (ldc3)    0.826    0.036   22.787    0.000    0.891    0.773\n  commit_3 =~                                                           \n    COMMIT3 (ldc1)    0.807    0.036   22.195    0.000    0.758    0.741\n    COMMIT3 (ldc2)    0.807    0.036   22.194    0.000    0.758    0.720\n    COMMIT3 (ldc3)    0.826    0.036   22.787    0.000    0.776    0.727\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n .JOBSAT11 ~~                                                           \n   .JOBSAT21          0.118    0.032    3.655    0.000    0.118    0.222\n .JOBSAT21 ~~                                                           \n   .JOBSAT31          0.123    0.032    3.905    0.000    0.123    0.235\n .JOBSAT11 ~~                                                           \n   .JOBSAT31          0.151    0.029    5.126    0.000    0.151    0.303\n .JOBSAT12 ~~                                                           \n   .JOBSAT22          0.155    0.034    4.560    0.000    0.155    0.293\n .JOBSAT22 ~~                                                           \n   .JOBSAT32          0.095    0.030    3.160    0.002    0.095    0.196\n .JOBSAT12 ~~                                                           \n   .JOBSAT32          0.075    0.032    2.345    0.019    0.075    0.148\n .JOBSAT13 ~~                                                           \n   .JOBSAT23          0.090    0.033    2.714    0.007    0.090    0.179\n .JOBSAT23 ~~                                                           \n   .JOBSAT33          0.147    0.033    4.402    0.000    0.147    0.290\n .JOBSAT13 ~~                                                           \n   .JOBSAT33          0.114    0.031    3.647    0.000    0.114    0.233\n .READY11 ~~                                                            \n   .READY21           0.136    0.033    4.094    0.000    0.136    0.262\n .READY21 ~~                                                            \n   .READY31           0.107    0.032    3.357    0.001    0.107    0.198\n .READY11 ~~                                                            \n   .READY31           0.099    0.033    2.987    0.003    0.099    0.191\n .READY12 ~~                                                            \n   .READY22           0.181    0.033    5.396    0.000    0.181    0.312\n .READY22 ~~                                                            \n   .READY32           0.173    0.037    4.647    0.000    0.173    0.306\n .READY12 ~~                                                            \n   .READY32           0.120    0.034    3.548    0.000    0.120    0.217\n .READY13 ~~                                                            \n   .READY23           0.133    0.033    4.032    0.000    0.133    0.251\n .READY23 ~~                                                            \n   .READY33           0.168    0.035    4.860    0.000    0.168    0.300\n .READY13 ~~                                                            \n   .READY33           0.117    0.033    3.586    0.000    0.117    0.220\n .COMMIT11 ~~                                                           \n   .COMMIT21          0.122    0.032    3.872    0.000    0.122    0.244\n .COMMIT21 ~~                                                           \n   .COMMIT31          0.142    0.031    4.587    0.000    0.142    0.294\n .COMMIT11 ~~                                                           \n   .COMMIT31          0.110    0.029    3.732    0.000    0.110    0.225\n .COMMIT12 ~~                                                           \n   .COMMIT22          0.101    0.032    3.144    0.002    0.101    0.194\n .COMMIT22 ~~                                                           \n   .COMMIT32          0.119    0.033    3.576    0.000    0.119    0.228\n .COMMIT12 ~~                                                           \n   .COMMIT32          0.084    0.031    2.743    0.006    0.084    0.159\n .COMMIT13 ~~                                                           \n   .COMMIT23          0.171    0.034    5.073    0.000    0.171    0.329\n .COMMIT23 ~~                                                           \n   .COMMIT33          0.150    0.031    4.856    0.000    0.150    0.279\n .COMMIT13 ~~                                                           \n   .COMMIT33          0.111    0.033    3.399    0.001    0.111    0.213\n  jobsat_1 ~~                                                           \n    jobsat_2          0.388    0.054    7.125    0.000    0.403    0.403\n    jobsat_3          0.292    0.050    5.802    0.000    0.328    0.328\n    ready_1           0.541    0.050   10.817    0.000    0.541    0.541\n    ready_2           0.272    0.057    4.748    0.000    0.276    0.276\n    ready_3           0.175    0.055    3.167    0.002    0.182    0.182\n    commit_1          0.580    0.047   12.416    0.000    0.580    0.580\n    commit_2          0.388    0.061    6.394    0.000    0.360    0.360\n    commit_3          0.230    0.054    4.230    0.000    0.245    0.245\n  jobsat_2 ~~                                                           \n    jobsat_3          0.348    0.052    6.634    0.000    0.407    0.407\n    ready_1           0.200    0.056    3.585    0.000    0.208    0.208\n    ready_2           0.480    0.060    8.037    0.000    0.507    0.507\n    ready_3           0.191    0.054    3.512    0.000    0.206    0.206\n    commit_1          0.278    0.055    5.091    0.000    0.289    0.289\n    commit_2          0.595    0.068    8.732    0.000    0.574    0.574\n    commit_3          0.254    0.057    4.415    0.000    0.281    0.281\n  jobsat_3 ~~                                                           \n    ready_1           0.206    0.047    4.372    0.000    0.232    0.232\n    ready_2           0.264    0.051    5.190    0.000    0.302    0.302\n    ready_3           0.454    0.056    8.182    0.000    0.532    0.532\n    commit_1          0.192    0.052    3.674    0.000    0.216    0.216\n    commit_2          0.283    0.058    4.889    0.000    0.295    0.295\n    commit_3          0.486    0.056    8.666    0.000    0.582    0.582\n  ready_1 ~~                                                            \n    ready_2           0.316    0.061    5.203    0.000    0.320    0.320\n    ready_3           0.270    0.056    4.797    0.000    0.281    0.281\n    commit_1          0.455    0.050    9.178    0.000    0.455    0.455\n    commit_2          0.289    0.064    4.502    0.000    0.268    0.268\n    commit_3          0.223    0.056    3.994    0.000    0.237    0.237\n  ready_2 ~~                                                            \n    ready_3           0.413    0.061    6.751    0.000    0.437    0.437\n    commit_1          0.255    0.057    4.444    0.000    0.259    0.259\n    commit_2          0.660    0.071    9.283    0.000    0.622    0.622\n    commit_3          0.282    0.058    4.863    0.000    0.305    0.305\n  ready_3 ~~                                                            \n    commit_1          0.175    0.058    3.031    0.002    0.182    0.182\n    commit_2          0.303    0.063    4.776    0.000    0.293    0.293\n    commit_3          0.435    0.060    7.264    0.000    0.482    0.482\n  commit_1 ~~                                                           \n    commit_2          0.579    0.059    9.790    0.000    0.537    0.537\n    commit_3          0.369    0.056    6.590    0.000    0.393    0.393\n  commit_2 ~~                                                           \n    commit_3          0.518    0.075    6.929    0.000    0.511    0.511\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n    jbst_1            0.000                               0.000    0.000\n    redy_1            0.000                               0.000    0.000\n    cmmt_1            0.000                               0.000    0.000\n    jbst_2            0.000    0.063    0.000    1.000    0.000    0.000\n    jbst_3            0.129    0.061    2.103    0.035    0.145    0.145\n    redy_2            0.054    0.068    0.801    0.423    0.055    0.055\n    redy_3            0.198    0.070    2.818    0.005    0.206    0.206\n    cmmt_2           -0.200    0.068   -2.937    0.003   -0.186   -0.186\n    cmmt_3           -0.173    0.070   -2.473    0.013   -0.184   -0.184\n   .JOBSAT (intj1)    3.319    0.055   60.662    0.000    3.319    2.751\n   .JOBSAT (intj1)    3.319    0.055   60.662    0.000    3.319    2.767\n   .JOBSAT (intj1)    3.319    0.055   60.662    0.000    3.319    2.984\n   .READY1 (intr1)    3.176    0.052   61.296    0.000    3.176    2.722\n   .READY2 (intr1)    3.176    0.052   61.296    0.000    3.176    2.701\n   .READY3 (intr1)    3.176    0.052   61.296    0.000    3.176    2.747\n   .COMMIT (intc1)    3.719    0.049   76.578    0.000    3.719    3.454\n   .COMMIT (intc1)    3.719    0.049   76.578    0.000    3.719    3.326\n   .COMMIT (intc1)    3.719    0.049   76.578    0.000    3.719    3.639\n   .JOBSAT            3.311    0.056   58.833    0.000    3.311    2.668\n   .JOBSAT            3.321    0.054   61.701    0.000    3.321    2.734\n   .JOBSAT            3.331    0.068   49.283    0.000    3.331    2.796\n   .JOBSAT            3.329    0.069   48.075    0.000    3.329    2.775\n   .JOBSAT            3.276    0.065   50.125    0.000    3.276    2.939\n   .JOBSAT            3.258    0.067   48.848    0.000    3.258    2.885\n   .READY1            3.198    0.052   61.778    0.000    3.198    2.816\n   .READY1            3.156    0.052   61.219    0.000    3.156    2.755\n   .READY2            3.168    0.063   50.350    0.000    3.168    2.787\n   .READY2            3.208    0.064   49.907    0.000    3.208    2.765\n   .READY3            3.161    0.064   49.723    0.000    3.161    2.877\n   .READY3            3.150    0.067   46.681    0.000    3.150    2.756\n   .COMMIT            3.653    0.049   74.419    0.000    3.653    3.368\n   .COMMIT            3.596    0.049   73.962    0.000    3.596    3.302\n   .COMMIT            3.687    0.063   58.086    0.000    3.687    3.273\n   .COMMIT            3.654    0.065   56.470    0.000    3.654    3.171\n   .COMMIT            3.756    0.063   59.858    0.000    3.756    3.565\n   .COMMIT            3.694    0.065   57.102    0.000    3.694    3.458\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n    jobsat_1          1.000                               1.000    1.000\n    ready_1           1.000                               1.000    1.000\n    commit_1          1.000                               1.000    1.000\n    jobsat_2          0.925    0.070   13.235    0.000    1.000    1.000\n    jobsat_3          0.789    0.068   11.639    0.000    1.000    1.000\n    ready_2           0.971    0.083   11.740    0.000    1.000    1.000\n    ready_3           0.922    0.082   11.302    0.000    1.000    1.000\n    commit_2          1.163    0.113   10.320    0.000    1.000    1.000\n    commit_3          0.882    0.092    9.612    0.000    1.000    1.000\n   .JOBSAT11          0.507    0.048   10.579    0.000    0.507    0.348\n   .JOBSAT12          0.551    0.046   11.972    0.000    0.551    0.358\n   .JOBSAT13          0.486    0.044   10.964    0.000    0.486    0.329\n   .JOBSAT21          0.561    0.049   11.404    0.000    0.561    0.390\n   .JOBSAT22          0.505    0.047   10.776    0.000    0.505    0.355\n   .JOBSAT23          0.524    0.050   10.578    0.000    0.524    0.364\n   .JOBSAT31          0.488    0.040   12.241    0.000    0.488    0.394\n   .JOBSAT32          0.462    0.040   11.493    0.000    0.462    0.371\n   .JOBSAT33          0.494    0.044   11.169    0.000    0.494    0.387\n   .READY11           0.496    0.049   10.188    0.000    0.496    0.364\n   .READY12           0.567    0.045   12.740    0.000    0.567    0.440\n   .READY13           0.504    0.045   11.200    0.000    0.504    0.384\n   .READY21           0.543    0.050   10.947    0.000    0.543    0.393\n   .READY22           0.591    0.049   12.168    0.000    0.591    0.457\n   .READY23           0.561    0.051   10.951    0.000    0.561    0.417\n   .READY31           0.539    0.050   10.779    0.000    0.539    0.403\n   .READY32           0.540    0.046   11.793    0.000    0.540    0.448\n   .READY33           0.560    0.044   12.583    0.000    0.560    0.429\n   .COMMIT11          0.509    0.048   10.659    0.000    0.509    0.439\n   .COMMIT12          0.525    0.044   11.823    0.000    0.525    0.446\n   .COMMIT13          0.503    0.046   10.913    0.000    0.503    0.424\n   .COMMIT21          0.494    0.045   10.965    0.000    0.494    0.395\n   .COMMIT22          0.512    0.047   10.936    0.000    0.512    0.403\n   .COMMIT23          0.535    0.049   10.865    0.000    0.535    0.402\n   .COMMIT31          0.470    0.041   11.504    0.000    0.470    0.450\n   .COMMIT32          0.535    0.052   10.214    0.000    0.535    0.482\n   .COMMIT33          0.539    0.046   11.644    0.000    0.539    0.472\n\nR-Square:\n                   Estimate\n    JOBSAT11          0.652\n    JOBSAT12          0.642\n    JOBSAT13          0.671\n    JOBSAT21          0.610\n    JOBSAT22          0.645\n    JOBSAT23          0.636\n    JOBSAT31          0.606\n    JOBSAT32          0.629\n    JOBSAT33          0.613\n    READY11           0.636\n    READY12           0.560\n    READY13           0.616\n    READY21           0.607\n    READY22           0.543\n    READY23           0.583\n    READY31           0.597\n    READY32           0.552\n    READY33           0.571\n    COMMIT11          0.561\n    COMMIT12          0.554\n    COMMIT13          0.576\n    COMMIT21          0.605\n    COMMIT22          0.597\n    COMMIT23          0.598\n    COMMIT31          0.550\n    COMMIT32          0.518\n    COMMIT33          0.528\n\n\n\n10.3.4 Modification Indices\n\nCodemodificationindices(\n  metricInvariance_fit,\n  sort. = TRUE)\n\n\n  \n\n\n\n\n10.3.5 Path Diagram\n\nCodelavaanPlot::lavaanPlot2(\n  metricInvariance_fit,\n  stand = TRUE,\n  coef_labels = TRUE)\n\n\nPath Diagram\n\n\nTo create an interactive path diagram, you can use the following syntax:\n\nCodelavaangui::plot_lavaan(metricInvariance_fit)\n\n\n\n10.3.6 Compare Models\n\nCodeanova(\n  configuralInvarianceCorrelatedResiduals_fit,\n  metricInvariance_fit\n)"
  },
  {
    "objectID": "structural-equation-models.html#scalar-strong-factorial-invariance",
    "href": "structural-equation-models.html#scalar-strong-factorial-invariance",
    "title": "Structural Equation Models",
    "section": "\n10.4 Scalar (“Strong Factorial”) Invariance",
    "text": "10.4 Scalar (“Strong Factorial”) Invariance\nA scalar invariance model evaluates whether the items’ intercepts are the same across time.\n\nStandardize the latent factor(s) at T1 (i.e., fix the mean to zero and the variance to one)\nAllow within-indicator residuals to covary across time\nFor each indicator, constrain its factor loading to be the same across time\nFor each indicator, constrain its intercept to be the same across time\n\n\n10.4.1 Model Syntax\n\nCodescalarInvariance_syntax &lt;- '\n  # Factor Loadings\n  jobsat_1 =~ NA*loadj1*JOBSAT11 + loadj2*JOBSAT12 + loadj3*JOBSAT13\n  jobsat_2 =~ NA*loadj1*JOBSAT21 + loadj2*JOBSAT22 + loadj3*JOBSAT23\n  jobsat_3 =~ NA*loadj1*JOBSAT31 + loadj2*JOBSAT32 + loadj3*JOBSAT33\n  \n  ready_1 =~ NA*loadr1*READY11 + loadr2*READY12 + loadr3*READY13\n  ready_2 =~ NA*loadr1*READY21 + loadr2*READY22 + loadr3*READY23\n  ready_3 =~ NA*loadr1*READY31 + loadr2*READY32 + loadr3*READY33\n  \n  commit_1 =~ NA*loadc1*COMMIT11 + loadc2*COMMIT12 + loadc3*COMMIT13\n  commit_2 =~ NA*loadc1*COMMIT21 + loadc2*COMMIT22 + loadc3*COMMIT23\n  commit_3 =~ NA*loadc1*COMMIT31 + loadc2*COMMIT32 + loadc3*COMMIT33\n  \n  # Factor Identification: Standardize Factors at T1\n  \n  ## Fix Factor Means at T1 to Zero\n  jobsat_1 ~ 0*1\n  ready_1 ~ 0*1\n  commit_1 ~ 0*1\n  \n  ## Fix Factor Variances at T1 to One\n  jobsat_1 ~~ 1*jobsat_1\n  ready_1 ~~ 1*ready_1\n  commit_1 ~~ 1*commit_1\n  \n  # Freely Estimate Factor Means at T2 and T3 (relative to T1)\n  jobsat_2 ~ 1\n  jobsat_3 ~ 1\n  \n  ready_2 ~ 1\n  ready_3 ~ 1\n  \n  commit_2 ~ 1\n  commit_3 ~ 1\n  \n  # Freely Estimate Factor Variances at T2 and T3 (relative to T1)\n  jobsat_2 ~~ jobsat_2\n  jobsat_3 ~~ jobsat_3\n  \n  ready_2 ~~ ready_2\n  ready_3 ~~ ready_3\n  \n  commit_2 ~~ commit_2\n  commit_3 ~~ commit_3\n  \n  # Fix Intercepts of Indicators Across Time\n  JOBSAT11 ~ intj1*1\n  JOBSAT21 ~ intj1*1\n  JOBSAT31 ~ intj1*1\n  JOBSAT12 ~ intj2*1\n  JOBSAT22 ~ intj2*1\n  JOBSAT32 ~ intj2*1\n  JOBSAT13 ~ intj3*1\n  JOBSAT23 ~ intj3*1\n  JOBSAT33 ~ intj3*1\n  \n  READY11 ~ intr1*1\n  READY21 ~ intr1*1\n  READY31 ~ intr1*1\n  READY12 ~ intr2*1\n  READY22 ~ intr2*1\n  READY32 ~ intr2*1\n  READY13 ~ intr3*1\n  READY23 ~ intr3*1\n  READY33 ~ intr3*1\n  \n  COMMIT11 ~ intc1*1\n  COMMIT21 ~ intc1*1\n  COMMIT31 ~ intc1*1\n  COMMIT12 ~ intc2*1\n  COMMIT22 ~ intc2*1\n  COMMIT32 ~ intc2*1\n  COMMIT13 ~ intc3*1\n  COMMIT23 ~ intc3*1\n  COMMIT33 ~ intc3*1\n  \n  # Estimate Residual Variances of Manifest Variables\n  JOBSAT11 ~~ JOBSAT11\n  JOBSAT12 ~~ JOBSAT12\n  JOBSAT13 ~~ JOBSAT13\n  JOBSAT21 ~~ JOBSAT21\n  JOBSAT22 ~~ JOBSAT22\n  JOBSAT23 ~~ JOBSAT23\n  JOBSAT31 ~~ JOBSAT31\n  JOBSAT32 ~~ JOBSAT32\n  JOBSAT33 ~~ JOBSAT33\n  \n  READY11 ~~ READY11\n  READY12 ~~ READY12\n  READY13 ~~ READY13\n  READY21 ~~ READY21\n  READY22 ~~ READY22\n  READY23 ~~ READY23\n  READY31 ~~ READY31\n  READY32 ~~ READY32\n  READY33 ~~ READY33\n  \n  COMMIT11 ~~ COMMIT11\n  COMMIT12 ~~ COMMIT12\n  COMMIT13 ~~ COMMIT13\n  COMMIT21 ~~ COMMIT21\n  COMMIT22 ~~ COMMIT22\n  COMMIT23 ~~ COMMIT23\n  COMMIT31 ~~ COMMIT31\n  COMMIT32 ~~ COMMIT32\n  COMMIT33 ~~ COMMIT33\n  \n  # Residual Covariances Within Indicator Across Time\n  JOBSAT11 ~~ JOBSAT21\n  JOBSAT21 ~~ JOBSAT31\n  JOBSAT11 ~~ JOBSAT31\n  \n  JOBSAT12 ~~ JOBSAT22\n  JOBSAT22 ~~ JOBSAT32\n  JOBSAT12 ~~ JOBSAT32\n  \n  JOBSAT13 ~~ JOBSAT23\n  JOBSAT23 ~~ JOBSAT33\n  JOBSAT13 ~~ JOBSAT33\n  \n  READY11 ~~ READY21\n  READY21 ~~ READY31\n  READY11 ~~ READY31\n  \n  READY12 ~~ READY22\n  READY22 ~~ READY32\n  READY12 ~~ READY32\n  \n  READY13 ~~ READY23\n  READY23 ~~ READY33\n  READY13 ~~ READY33\n  \n  COMMIT11 ~~ COMMIT21\n  COMMIT21 ~~ COMMIT31\n  COMMIT11 ~~ COMMIT31\n  \n  COMMIT12 ~~ COMMIT22\n  COMMIT22 ~~ COMMIT32\n  COMMIT12 ~~ COMMIT32\n  \n  COMMIT13 ~~ COMMIT23\n  COMMIT23 ~~ COMMIT33\n  COMMIT13 ~~ COMMIT33\n'\n\n\n\n10.4.2 Fit Model\n\nCodescalarInvariance_fit &lt;- cfa(\n  scalarInvariance_syntax,\n  data = longitudinalMI1,\n  missing = \"ML\", # FIML\n  estimator = \"MLR\", # Huber-White robust standard errors (for heteroscedasticity and nonnormally distributed residuals)\n  meanstructure = TRUE, # estimate means/intercepts\n  fixed.x = FALSE) # estimate means, variances, and covariances of the observed variables (to include predictors as part of FIML)\n\n\n\n10.4.3 Model Summary\n\nCodesummary(\n  scalarInvariance_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 82 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                       156\n  Number of equality constraints                    36\n\n  Number of observations                           495\n  Number of missing patterns                         1\n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                               295.447     302.078\n  Degrees of freedom                               285         285\n  P-value (Chi-square)                           0.323       0.233\n  Scaling correction factor                                  0.978\n    Yuan-Bentler correction (Mplus variant)                       \n\nModel Test Baseline Model:\n\n  Test statistic                              6697.063    6541.933\n  Degrees of freedom                               351         351\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  1.024\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.998       0.997\n  Tucker-Lewis Index (TLI)                       0.998       0.997\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.997\n  Robust Tucker-Lewis Index (TLI)                            0.997\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)             -17479.087  -17479.087\n  Scaling correction factor                                  0.803\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)     -17331.363  -17331.363\n  Scaling correction factor                                  0.998\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                               35198.174   35198.174\n  Bayesian (BIC)                             35702.721   35702.721\n  Sample-size adjusted Bayesian (SABIC)      35321.838   35321.838\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.009       0.011\n  90 Percent confidence interval - lower         0.000       0.000\n  90 Percent confidence interval - upper         0.020       0.021\n  P-value H_0: RMSEA &lt;= 0.050                    1.000       1.000\n  P-value H_0: RMSEA &gt;= 0.080                    0.000       0.000\n                                                                  \n  Robust RMSEA                                               0.011\n  90 Percent confidence interval - lower                     0.000\n  90 Percent confidence interval - upper                     0.021\n  P-value H_0: Robust RMSEA &lt;= 0.050                         1.000\n  P-value H_0: Robust RMSEA &gt;= 0.080                         0.000\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.024       0.024\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  jobsat_1 =~                                                           \n    JOBSAT1 (ldj1)    0.976    0.037   26.623    0.000    0.976    0.808\n    JOBSAT1 (ldj2)    0.995    0.035   28.636    0.000    0.995    0.801\n    JOBSAT1 (ldj3)    0.994    0.036   27.967    0.000    0.994    0.818\n  jobsat_2 =~                                                           \n    JOBSAT2 (ldj1)    0.976    0.037   26.623    0.000    0.938    0.782\n    JOBSAT2 (ldj2)    0.995    0.035   28.636    0.000    0.957    0.803\n    JOBSAT2 (ldj3)    0.994    0.036   27.967    0.000    0.955    0.797\n  jobsat_3 =~                                                           \n    JOBSAT3 (ldj1)    0.976    0.037   26.623    0.000    0.867    0.779\n    JOBSAT3 (ldj2)    0.995    0.035   28.636    0.000    0.884    0.793\n    JOBSAT3 (ldj3)    0.994    0.036   27.967    0.000    0.883    0.782\n  ready_1 =~                                                            \n    READY11 (ldr1)    0.931    0.036   25.577    0.000    0.931    0.798\n    READY12 (ldr2)    0.849    0.035   23.920    0.000    0.849    0.748\n    READY13 (ldr3)    0.899    0.036   24.972    0.000    0.899    0.785\n  ready_2 =~                                                            \n    READY21 (ldr1)    0.931    0.036   25.577    0.000    0.918    0.780\n    READY22 (ldr2)    0.849    0.035   23.920    0.000    0.836    0.736\n    READY23 (ldr3)    0.899    0.036   24.972    0.000    0.885    0.763\n  ready_3 =~                                                            \n    READY31 (ldr1)    0.931    0.036   25.577    0.000    0.895    0.773\n    READY32 (ldr2)    0.849    0.035   23.920    0.000    0.815    0.742\n    READY33 (ldr3)    0.899    0.036   24.972    0.000    0.863    0.756\n  commit_1 =~                                                           \n    COMMIT1 (ldc1)    0.808    0.036   22.359    0.000    0.808    0.750\n    COMMIT1 (ldc2)    0.807    0.036   22.218    0.000    0.807    0.744\n    COMMIT1 (ldc3)    0.824    0.037   22.501    0.000    0.824    0.758\n  commit_2 =~                                                           \n    COMMIT2 (ldc1)    0.808    0.036   22.359    0.000    0.872    0.779\n    COMMIT2 (ldc2)    0.807    0.036   22.218    0.000    0.870    0.772\n    COMMIT2 (ldc3)    0.824    0.037   22.501    0.000    0.889    0.772\n  commit_3 =~                                                           \n    COMMIT3 (ldc1)    0.808    0.036   22.359    0.000    0.759    0.742\n    COMMIT3 (ldc2)    0.807    0.036   22.218    0.000    0.758    0.719\n    COMMIT3 (ldc3)    0.824    0.037   22.501    0.000    0.774    0.725\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n .JOBSAT11 ~~                                                           \n   .JOBSAT21          0.118    0.032    3.644    0.000    0.118    0.222\n .JOBSAT21 ~~                                                           \n   .JOBSAT31          0.122    0.031    3.880    0.000    0.122    0.233\n .JOBSAT11 ~~                                                           \n   .JOBSAT31          0.150    0.029    5.127    0.000    0.150    0.302\n .JOBSAT12 ~~                                                           \n   .JOBSAT22          0.154    0.034    4.555    0.000    0.154    0.293\n .JOBSAT22 ~~                                                           \n   .JOBSAT32          0.095    0.030    3.166    0.002    0.095    0.196\n .JOBSAT12 ~~                                                           \n   .JOBSAT32          0.075    0.032    2.348    0.019    0.075    0.148\n .JOBSAT13 ~~                                                           \n   .JOBSAT23          0.090    0.033    2.723    0.006    0.090    0.179\n .JOBSAT23 ~~                                                           \n   .JOBSAT33          0.147    0.033    4.398    0.000    0.147    0.289\n .JOBSAT13 ~~                                                           \n   .JOBSAT33          0.114    0.031    3.637    0.000    0.114    0.232\n .READY11 ~~                                                            \n   .READY21           0.136    0.033    4.092    0.000    0.136    0.263\n .READY21 ~~                                                            \n   .READY31           0.107    0.032    3.338    0.001    0.107    0.198\n .READY11 ~~                                                            \n   .READY31           0.099    0.033    2.988    0.003    0.099    0.191\n .READY12 ~~                                                            \n   .READY22           0.180    0.033    5.381    0.000    0.180    0.311\n .READY22 ~~                                                            \n   .READY32           0.173    0.037    4.660    0.000    0.173    0.306\n .READY12 ~~                                                            \n   .READY32           0.120    0.034    3.545    0.000    0.120    0.217\n .READY13 ~~                                                            \n   .READY23           0.133    0.033    4.024    0.000    0.133    0.249\n .READY23 ~~                                                            \n   .READY33           0.168    0.035    4.859    0.000    0.168    0.299\n .READY13 ~~                                                            \n   .READY33           0.117    0.033    3.590    0.000    0.117    0.221\n .COMMIT11 ~~                                                           \n   .COMMIT21          0.122    0.032    3.852    0.000    0.122    0.243\n .COMMIT21 ~~                                                           \n   .COMMIT31          0.141    0.031    4.556    0.000    0.141    0.293\n .COMMIT11 ~~                                                           \n   .COMMIT31          0.108    0.029    3.659    0.000    0.108    0.220\n .COMMIT12 ~~                                                           \n   .COMMIT22          0.101    0.032    3.152    0.002    0.101    0.195\n .COMMIT22 ~~                                                           \n   .COMMIT32          0.119    0.033    3.561    0.000    0.119    0.227\n .COMMIT12 ~~                                                           \n   .COMMIT32          0.084    0.031    2.723    0.006    0.084    0.158\n .COMMIT13 ~~                                                           \n   .COMMIT23          0.171    0.034    5.070    0.000    0.171    0.329\n .COMMIT23 ~~                                                           \n   .COMMIT33          0.150    0.031    4.877    0.000    0.150    0.279\n .COMMIT13 ~~                                                           \n   .COMMIT33          0.111    0.033    3.391    0.001    0.111    0.212\n  jobsat_1 ~~                                                           \n    jobsat_2          0.388    0.054    7.126    0.000    0.404    0.404\n    jobsat_3          0.292    0.050    5.807    0.000    0.329    0.329\n    ready_1           0.541    0.050   10.820    0.000    0.541    0.541\n    ready_2           0.272    0.057    4.747    0.000    0.276    0.276\n    ready_3           0.175    0.055    3.168    0.002    0.182    0.182\n    commit_1          0.580    0.047   12.420    0.000    0.580    0.580\n    commit_2          0.389    0.061    6.398    0.000    0.360    0.360\n    commit_3          0.230    0.054    4.229    0.000    0.245    0.245\n  jobsat_2 ~~                                                           \n    jobsat_3          0.348    0.052    6.639    0.000    0.408    0.408\n    ready_1           0.200    0.056    3.587    0.000    0.208    0.208\n    ready_2           0.480    0.060    8.036    0.000    0.507    0.507\n    ready_3           0.191    0.054    3.512    0.000    0.206    0.206\n    commit_1          0.278    0.055    5.091    0.000    0.289    0.289\n    commit_2          0.595    0.068    8.731    0.000    0.574    0.574\n    commit_3          0.254    0.058    4.414    0.000    0.281    0.281\n  jobsat_3 ~~                                                           \n    ready_1           0.206    0.047    4.373    0.000    0.232    0.232\n    ready_2           0.264    0.051    5.189    0.000    0.302    0.302\n    ready_3           0.454    0.056    8.183    0.000    0.532    0.532\n    commit_1          0.192    0.052    3.674    0.000    0.216    0.216\n    commit_2          0.283    0.058    4.894    0.000    0.295    0.295\n    commit_3          0.486    0.056    8.665    0.000    0.582    0.582\n  ready_1 ~~                                                            \n    ready_2           0.316    0.061    5.203    0.000    0.320    0.320\n    ready_3           0.270    0.056    4.795    0.000    0.281    0.281\n    commit_1          0.455    0.050    9.179    0.000    0.455    0.455\n    commit_2          0.289    0.064    4.500    0.000    0.268    0.268\n    commit_3          0.223    0.056    3.993    0.000    0.237    0.237\n  ready_2 ~~                                                            \n    ready_3           0.413    0.061    6.751    0.000    0.437    0.437\n    commit_1          0.255    0.057    4.445    0.000    0.259    0.259\n    commit_2          0.661    0.071    9.287    0.000    0.622    0.622\n    commit_3          0.282    0.058    4.864    0.000    0.305    0.305\n  ready_3 ~~                                                            \n    commit_1          0.175    0.058    3.031    0.002    0.182    0.182\n    commit_2          0.303    0.063    4.777    0.000    0.293    0.293\n    commit_3          0.435    0.060    7.265    0.000    0.482    0.482\n  commit_1 ~~                                                           \n    commit_2          0.579    0.059    9.789    0.000    0.537    0.537\n    commit_3          0.370    0.056    6.597    0.000    0.394    0.394\n  commit_2 ~~                                                           \n    commit_3          0.518    0.075    6.928    0.000    0.512    0.512\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n    jbst_1            0.000                               0.000    0.000\n    redy_1            0.000                               0.000    0.000\n    cmmt_1            0.000                               0.000    0.000\n    jbst_2            0.012    0.053    0.218    0.828    0.012    0.012\n    jbst_3            0.096    0.054    1.786    0.074    0.108    0.108\n    redy_2            0.063    0.058    1.090    0.276    0.064    0.064\n    redy_3            0.182    0.060    3.042    0.002    0.190    0.190\n    cmmt_2           -0.161    0.054   -2.979    0.003   -0.149   -0.149\n    cmmt_3           -0.093    0.057   -1.631    0.103   -0.099   -0.099\n   .JOBSAT (intj1)    3.327    0.052   64.001    0.000    3.327    2.755\n   .JOBSAT (intj1)    3.327    0.052   64.001    0.000    3.327    2.771\n   .JOBSAT (intj1)    3.327    0.052   64.001    0.000    3.327    2.988\n   .JOBSAT (intj2)    3.313    0.051   64.904    0.000    3.313    2.669\n   .JOBSAT (intj2)    3.313    0.051   64.904    0.000    3.313    2.780\n   .JOBSAT (intj2)    3.313    0.051   64.904    0.000    3.313    2.972\n   .JOBSAT (intj3)    3.310    0.051   64.290    0.000    3.310    2.726\n   .JOBSAT (intj3)    3.310    0.051   64.290    0.000    3.310    2.761\n   .JOBSAT (intj3)    3.310    0.051   64.290    0.000    3.310    2.933\n   .READY1 (intr1)    3.178    0.049   64.965    0.000    3.178    2.722\n   .READY2 (intr1)    3.178    0.049   64.965    0.000    3.178    2.702\n   .READY3 (intr1)    3.178    0.049   64.965    0.000    3.178    2.747\n   .READY1 (intr2)    3.179    0.048   66.536    0.000    3.179    2.800\n   .READY2 (intr2)    3.179    0.048   66.536    0.000    3.179    2.797\n   .READY3 (intr2)    3.179    0.048   66.536    0.000    3.179    2.895\n   .READY1 (intr3)    3.171    0.049   65.358    0.000    3.171    2.769\n   .READY2 (intr3)    3.171    0.049   65.358    0.000    3.171    2.732\n   .READY3 (intr3)    3.171    0.049   65.358    0.000    3.171    2.776\n   .COMMIT (intc1)    3.687    0.045   82.680    0.000    3.687    3.419\n   .COMMIT (intc1)    3.687    0.045   82.680    0.000    3.687    3.294\n   .COMMIT (intc1)    3.687    0.045   82.680    0.000    3.687    3.602\n   .COMMIT (intc2)    3.666    0.044   83.307    0.000    3.666    3.381\n   .COMMIT (intc2)    3.666    0.044   83.307    0.000    3.666    3.254\n   .COMMIT (intc2)    3.666    0.044   83.307    0.000    3.666    3.479\n   .COMMIT (intc3)    3.615    0.046   78.049    0.000    3.615    3.321\n   .COMMIT (intc3)    3.615    0.046   78.049    0.000    3.615    3.139\n   .COMMIT (intc3)    3.615    0.046   78.049    0.000    3.615    3.386\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n    jobsat_1          1.000                               1.000    1.000\n    ready_1           1.000                               1.000    1.000\n    commit_1          1.000                               1.000    1.000\n    jobsat_2          0.925    0.070   13.237    0.000    1.000    1.000\n    jobsat_3          0.789    0.068   11.635    0.000    1.000    1.000\n    ready_2           0.971    0.083   11.743    0.000    1.000    1.000\n    ready_3           0.923    0.082   11.303    0.000    1.000    1.000\n    commit_2          1.163    0.113   10.316    0.000    1.000    1.000\n    commit_3          0.882    0.092    9.608    0.000    1.000    1.000\n   .JOBSAT11          0.506    0.048   10.551    0.000    0.506    0.347\n   .JOBSAT12          0.551    0.046   11.974    0.000    0.551    0.358\n   .JOBSAT13          0.487    0.044   10.988    0.000    0.487    0.330\n   .JOBSAT21          0.560    0.049   11.363    0.000    0.560    0.389\n   .JOBSAT22          0.504    0.047   10.779    0.000    0.504    0.355\n   .JOBSAT23          0.525    0.049   10.634    0.000    0.525    0.365\n   .JOBSAT31          0.488    0.040   12.178    0.000    0.488    0.394\n   .JOBSAT32          0.461    0.040   11.449    0.000    0.461    0.371\n   .JOBSAT33          0.495    0.044   11.158    0.000    0.495    0.389\n   .READY11           0.495    0.049   10.174    0.000    0.495    0.363\n   .READY12           0.568    0.044   12.791    0.000    0.568    0.441\n   .READY13           0.504    0.045   11.208    0.000    0.504    0.384\n   .READY21           0.542    0.049   10.953    0.000    0.542    0.391\n   .READY22           0.592    0.049   12.185    0.000    0.592    0.458\n   .READY23           0.563    0.051   10.953    0.000    0.563    0.418\n   .READY31           0.538    0.050   10.756    0.000    0.538    0.402\n   .READY32           0.541    0.046   11.791    0.000    0.541    0.449\n   .READY33           0.560    0.045   12.558    0.000    0.560    0.429\n   .COMMIT11          0.509    0.048   10.621    0.000    0.509    0.438\n   .COMMIT12          0.525    0.045   11.796    0.000    0.525    0.446\n   .COMMIT13          0.505    0.046   10.855    0.000    0.505    0.426\n   .COMMIT21          0.493    0.045   10.965    0.000    0.493    0.394\n   .COMMIT22          0.512    0.047   10.939    0.000    0.512    0.404\n   .COMMIT23          0.536    0.049   10.875    0.000    0.536    0.404\n   .COMMIT31          0.471    0.041   11.369    0.000    0.471    0.450\n   .COMMIT32          0.536    0.052   10.265    0.000    0.536    0.483\n   .COMMIT33          0.540    0.046   11.675    0.000    0.540    0.474\n\nR-Square:\n                   Estimate\n    JOBSAT11          0.653\n    JOBSAT12          0.642\n    JOBSAT13          0.670\n    JOBSAT21          0.611\n    JOBSAT22          0.645\n    JOBSAT23          0.635\n    JOBSAT31          0.606\n    JOBSAT32          0.629\n    JOBSAT33          0.611\n    READY11           0.637\n    READY12           0.559\n    READY13           0.616\n    READY21           0.609\n    READY22           0.542\n    READY23           0.582\n    READY31           0.598\n    READY32           0.551\n    READY33           0.571\n    COMMIT11          0.562\n    COMMIT12          0.554\n    COMMIT13          0.574\n    COMMIT21          0.606\n    COMMIT22          0.596\n    COMMIT23          0.596\n    COMMIT31          0.550\n    COMMIT32          0.517\n    COMMIT33          0.526\n\n\n\n10.4.4 Modification Indices\n\nCodemodificationindices(\n  scalarInvariance_fit,\n  sort. = TRUE)\n\n\n  \n\n\n\n\n10.4.5 Path Diagram\n\nCodelavaanPlot::lavaanPlot2(\n  scalarInvariance_fit,\n  stand = TRUE,\n  coef_labels = TRUE)\n\n\nPath Diagram\n\n\nTo create an interactive path diagram, you can use the following syntax:\n\nCodelavaangui::plot_lavaan(scalarInvariance_fit)\n\n\n\n10.4.6 Compare Models\n\nCodeanova(\n  metricInvariance_fit,\n  scalarInvariance_fit\n)"
  },
  {
    "objectID": "structural-equation-models.html#residual-strict-factorial-invariance",
    "href": "structural-equation-models.html#residual-strict-factorial-invariance",
    "title": "Structural Equation Models",
    "section": "\n10.5 Residual (“Strict Factorial”) Invariance",
    "text": "10.5 Residual (“Strict Factorial”) Invariance\nA residual invariance model evaluates whether the items’ residual variances are the same across time.\n\nStandardize the latent factor(s) at T1 (i.e., fix the mean to zero and the variance to one)\nAllow within-indicator residuals to covary across time\nFor each indicator, constrain its factor loading to be the same across time\nFor each indicator, constrain its intercept to be the same across time\nFor each indicator, constrain its residual variance to be the same across time\n\n\n10.5.1 Model Syntax\n\nCoderesidualInvariance_syntax &lt;- '\n  # Factor Loadings\n  jobsat_1 =~ NA*loadj1*JOBSAT11 + loadj2*JOBSAT12 + loadj3*JOBSAT13\n  jobsat_2 =~ NA*loadj1*JOBSAT21 + loadj2*JOBSAT22 + loadj3*JOBSAT23\n  jobsat_3 =~ NA*loadj1*JOBSAT31 + loadj2*JOBSAT32 + loadj3*JOBSAT33\n  \n  ready_1 =~ NA*loadr1*READY11 + loadr2*READY12 + loadr3*READY13\n  ready_2 =~ NA*loadr1*READY21 + loadr2*READY22 + loadr3*READY23\n  ready_3 =~ NA*loadr1*READY31 + loadr2*READY32 + loadr3*READY33\n  \n  commit_1 =~ NA*loadc1*COMMIT11 + loadc2*COMMIT12 + loadc3*COMMIT13\n  commit_2 =~ NA*loadc1*COMMIT21 + loadc2*COMMIT22 + loadc3*COMMIT23\n  commit_3 =~ NA*loadc1*COMMIT31 + loadc2*COMMIT32 + loadc3*COMMIT33\n  \n  # Factor Identification: Standardize Factors at T1\n  \n  ## Fix Factor Means at T1 to Zero\n  jobsat_1 ~ 0*1\n  ready_1 ~ 0*1\n  commit_1 ~ 0*1\n  \n  ## Fix Factor Variances at T1 to One\n  jobsat_1 ~~ 1*jobsat_1\n  ready_1 ~~ 1*ready_1\n  commit_1 ~~ 1*commit_1\n  \n  # Freely Estimate Factor Means at T2 and T3 (relative to T1)\n  jobsat_2 ~ 1\n  jobsat_3 ~ 1\n  \n  ready_2 ~ 1\n  ready_3 ~ 1\n  \n  commit_2 ~ 1\n  commit_3 ~ 1\n  \n  # Freely Estimate Factor Variances at T2 and T3 (relative to T1)\n  jobsat_2 ~~ jobsat_2\n  jobsat_3 ~~ jobsat_3\n  \n  ready_2 ~~ ready_2\n  ready_3 ~~ ready_3\n  \n  commit_2 ~~ commit_2\n  commit_3 ~~ commit_3\n  \n  # Constrain Intercepts of Indicators Across Time\n  JOBSAT11 ~ intj1*1\n  JOBSAT21 ~ intj1*1\n  JOBSAT31 ~ intj1*1\n  JOBSAT12 ~ intj2*1\n  JOBSAT22 ~ intj2*1\n  JOBSAT32 ~ intj2*1\n  JOBSAT13 ~ intj3*1\n  JOBSAT23 ~ intj3*1\n  JOBSAT33 ~ intj3*1\n  \n  READY11 ~ intr1*1\n  READY21 ~ intr1*1\n  READY31 ~ intr1*1\n  READY12 ~ intr2*1\n  READY22 ~ intr2*1\n  READY32 ~ intr2*1\n  READY13 ~ intr3*1\n  READY23 ~ intr3*1\n  READY33 ~ intr3*1\n  \n  COMMIT11 ~ intc1*1\n  COMMIT21 ~ intc1*1\n  COMMIT31 ~ intc1*1\n  COMMIT12 ~ intc2*1\n  COMMIT22 ~ intc2*1\n  COMMIT32 ~ intc2*1\n  COMMIT13 ~ intc3*1\n  COMMIT23 ~ intc3*1\n  COMMIT33 ~ intc3*1\n  \n  # Constrain Residual Variances of Indicators Across Time\n  JOBSAT11 ~~ resj1*JOBSAT11\n  JOBSAT21 ~~ resj1*JOBSAT21\n  JOBSAT31 ~~ resj1*JOBSAT31\n  JOBSAT12 ~~ resj2*JOBSAT12\n  JOBSAT22 ~~ resj2*JOBSAT22\n  JOBSAT32 ~~ resj2*JOBSAT32\n  JOBSAT13 ~~ resj3*JOBSAT13\n  JOBSAT23 ~~ resj3*JOBSAT23\n  JOBSAT33 ~~ resj3*JOBSAT33\n  \n  READY11 ~~ resr1*READY11\n  READY21 ~~ resr1*READY21\n  READY31 ~~ resr1*READY31\n  READY12 ~~ resr2*READY12\n  READY22 ~~ resr2*READY22\n  READY32 ~~ resr2*READY32\n  READY13 ~~ resr3*READY13\n  READY23 ~~ resr3*READY23\n  READY33 ~~ resr3*READY33\n  \n  COMMIT11 ~~ resc1*COMMIT11\n  COMMIT21 ~~ resc1*COMMIT21\n  COMMIT31 ~~ resc1*COMMIT31\n  COMMIT12 ~~ resc2*COMMIT12\n  COMMIT22 ~~ resc2*COMMIT22\n  COMMIT32 ~~ resc2*COMMIT32\n  COMMIT13 ~~ resc3*COMMIT13\n  COMMIT23 ~~ resc3*COMMIT23\n  COMMIT33 ~~ resc3*COMMIT33\n  \n  # Residual Covariances Within Indicator Across Time\n  JOBSAT11 ~~ JOBSAT21\n  JOBSAT21 ~~ JOBSAT31\n  JOBSAT11 ~~ JOBSAT31\n  \n  JOBSAT12 ~~ JOBSAT22\n  JOBSAT22 ~~ JOBSAT32\n  JOBSAT12 ~~ JOBSAT32\n  \n  JOBSAT13 ~~ JOBSAT23\n  JOBSAT23 ~~ JOBSAT33\n  JOBSAT13 ~~ JOBSAT33\n  \n  READY11 ~~ READY21\n  READY21 ~~ READY31\n  READY11 ~~ READY31\n  \n  READY12 ~~ READY22\n  READY22 ~~ READY32\n  READY12 ~~ READY32\n  \n  READY13 ~~ READY23\n  READY23 ~~ READY33\n  READY13 ~~ READY33\n  \n  COMMIT11 ~~ COMMIT21\n  COMMIT21 ~~ COMMIT31\n  COMMIT11 ~~ COMMIT31\n  \n  COMMIT12 ~~ COMMIT22\n  COMMIT22 ~~ COMMIT32\n  COMMIT12 ~~ COMMIT32\n  \n  COMMIT13 ~~ COMMIT23\n  COMMIT23 ~~ COMMIT33\n  COMMIT13 ~~ COMMIT33\n'\n\n\n\n10.5.2 Fit Model\n\nCoderesidualInvariance_fit &lt;- cfa(\n  residualInvariance_syntax,\n  data = longitudinalMI1,\n  missing = \"ML\", # FIML\n  estimator = \"MLR\", # Huber-White robust standard errors (for heteroscedasticity and nonnormally distributed residuals)\n  meanstructure = TRUE, # estimate means/intercepts\n  fixed.x = FALSE) # estimate means, variances, and covariances of the observed variables (to include predictors as part of FIML)\n\n\n\n10.5.3 Model Summary\n\nCodesummary(\n  residualInvariance_fit,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan 0.6-21 ended normally after 83 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                       156\n  Number of equality constraints                    54\n\n  Number of observations                           495\n  Number of missing patterns                         1\n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                               303.347     310.092\n  Degrees of freedom                               303         303\n  P-value (Chi-square)                           0.484       0.377\n  Scaling correction factor                                  0.978\n    Yuan-Bentler correction (Mplus variant)                       \n\nModel Test Baseline Model:\n\n  Test statistic                              6697.063    6541.933\n  Degrees of freedom                               351         351\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  1.024\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    1.000       0.999\n  Tucker-Lewis Index (TLI)                       1.000       0.999\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.999\n  Robust Tucker-Lewis Index (TLI)                            0.999\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)             -17483.037  -17483.037\n  Scaling correction factor                                  0.690\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)     -17331.363  -17331.363\n  Scaling correction factor                                  0.998\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                               35170.074   35170.074\n  Bayesian (BIC)                             35598.939   35598.939\n  Sample-size adjusted Bayesian (SABIC)      35275.188   35275.188\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.002       0.007\n  90 Percent confidence interval - lower         0.000       0.000\n  90 Percent confidence interval - upper         0.017       0.019\n  P-value H_0: RMSEA &lt;= 0.050                    1.000       1.000\n  P-value H_0: RMSEA &gt;= 0.080                    0.000       0.000\n                                                                  \n  Robust RMSEA                                               0.006\n  90 Percent confidence interval - lower                     0.000\n  90 Percent confidence interval - upper                     0.018\n  P-value H_0: Robust RMSEA &lt;= 0.050                         1.000\n  P-value H_0: Robust RMSEA &gt;= 0.080                         0.000\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.025       0.025\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n  jobsat_1 =~                                                           \n    JOBSAT1 (ldj1)    0.979    0.036   27.307    0.000    0.979    0.806\n    JOBSAT1 (ldj2)    0.999    0.034   29.132    0.000    0.999    0.816\n    JOBSAT1 (ldj3)    0.993    0.035   28.296    0.000    0.993    0.813\n  jobsat_2 =~                                                           \n    JOBSAT2 (ldj1)    0.979    0.036   27.307    0.000    0.943    0.795\n    JOBSAT2 (ldj2)    0.999    0.034   29.132    0.000    0.963    0.805\n    JOBSAT2 (ldj3)    0.993    0.035   28.296    0.000    0.957    0.803\n  jobsat_3 =~                                                           \n    JOBSAT3 (ldj1)    0.979    0.036   27.307    0.000    0.863    0.768\n    JOBSAT3 (ldj2)    0.999    0.034   29.132    0.000    0.882    0.779\n    JOBSAT3 (ldj3)    0.993    0.035   28.296    0.000    0.876    0.777\n  ready_1 =~                                                            \n    READY11 (ldr1)    0.928    0.036   25.841    0.000    0.928    0.789\n    READY12 (ldr2)    0.845    0.035   24.222    0.000    0.845    0.747\n    READY13 (ldr3)    0.894    0.035   25.224    0.000    0.894    0.771\n  ready_2 =~                                                            \n    READY21 (ldr1)    0.928    0.036   25.841    0.000    0.923    0.787\n    READY22 (ldr2)    0.845    0.035   24.222    0.000    0.840    0.745\n    READY23 (ldr3)    0.894    0.035   25.224    0.000    0.889    0.770\n  ready_3 =~                                                            \n    READY31 (ldr1)    0.928    0.036   25.841    0.000    0.896    0.778\n    READY32 (ldr2)    0.845    0.035   24.222    0.000    0.816    0.735\n    READY33 (ldr3)    0.894    0.035   25.224    0.000    0.863    0.760\n  commit_1 =~                                                           \n    COMMIT1 (ldc1)    0.809    0.036   22.780    0.000    0.809    0.756\n    COMMIT1 (ldc2)    0.806    0.035   22.727    0.000    0.806    0.744\n    COMMIT1 (ldc3)    0.824    0.036   22.925    0.000    0.824    0.750\n  commit_2 =~                                                           \n    COMMIT2 (ldc1)    0.809    0.036   22.780    0.000    0.873    0.780\n    COMMIT2 (ldc2)    0.806    0.035   22.727    0.000    0.870    0.768\n    COMMIT2 (ldc3)    0.824    0.036   22.925    0.000    0.889    0.774\n  commit_3 =~                                                           \n    COMMIT3 (ldc1)    0.809    0.036   22.780    0.000    0.760    0.736\n    COMMIT3 (ldc2)    0.806    0.035   22.727    0.000    0.757    0.723\n    COMMIT3 (ldc3)    0.824    0.036   22.925    0.000    0.774    0.729\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n .JOBSAT11 ~~                                                           \n   .JOBSAT21          0.111    0.030    3.639    0.000    0.111    0.214\n .JOBSAT21 ~~                                                           \n   .JOBSAT31          0.120    0.030    3.936    0.000    0.120    0.231\n .JOBSAT11 ~~                                                           \n   .JOBSAT31          0.161    0.031    5.208    0.000    0.161    0.310\n .JOBSAT12 ~~                                                           \n   .JOBSAT22          0.141    0.031    4.518    0.000    0.141    0.281\n .JOBSAT22 ~~                                                           \n   .JOBSAT32          0.102    0.031    3.287    0.001    0.102    0.204\n .JOBSAT12 ~~                                                           \n   .JOBSAT32          0.073    0.032    2.292    0.022    0.073    0.146\n .JOBSAT13 ~~                                                           \n   .JOBSAT23          0.091    0.032    2.882    0.004    0.091    0.180\n .JOBSAT23 ~~                                                           \n   .JOBSAT33          0.143    0.032    4.466    0.000    0.143    0.284\n .JOBSAT13 ~~                                                           \n   .JOBSAT33          0.117    0.032    3.662    0.000    0.117    0.232\n .READY11 ~~                                                            \n   .READY21           0.139    0.033    4.266    0.000    0.139    0.265\n .READY21 ~~                                                            \n   .READY31           0.101    0.030    3.320    0.001    0.101    0.192\n .READY11 ~~                                                            \n   .READY31           0.100    0.033    3.010    0.003    0.100    0.190\n .READY12 ~~                                                            \n   .READY22           0.174    0.032    5.389    0.000    0.174    0.307\n .READY22 ~~                                                            \n   .READY32           0.173    0.035    4.941    0.000    0.173    0.306\n .READY12 ~~                                                            \n   .READY32           0.124    0.035    3.580    0.000    0.124    0.219\n .READY13 ~~                                                            \n   .READY23           0.136    0.033    4.125    0.000    0.136    0.250\n .READY23 ~~                                                            \n   .READY33           0.160    0.032    5.019    0.000    0.160    0.294\n .READY13 ~~                                                            \n   .READY33           0.122    0.033    3.689    0.000    0.122    0.225\n .COMMIT11 ~~                                                           \n   .COMMIT21          0.116    0.030    3.869    0.000    0.116    0.238\n .COMMIT21 ~~                                                           \n   .COMMIT31          0.145    0.031    4.699    0.000    0.145    0.296\n .COMMIT11 ~~                                                           \n   .COMMIT31          0.107    0.029    3.655    0.000    0.107    0.219\n .COMMIT12 ~~                                                           \n   .COMMIT22          0.104    0.032    3.294    0.001    0.104    0.198\n .COMMIT22 ~~                                                           \n   .COMMIT32          0.119    0.032    3.735    0.000    0.119    0.227\n .COMMIT12 ~~                                                           \n   .COMMIT32          0.081    0.030    2.717    0.007    0.081    0.155\n .COMMIT13 ~~                                                           \n   .COMMIT23          0.176    0.034    5.229    0.000    0.176    0.333\n .COMMIT23 ~~                                                           \n   .COMMIT33          0.146    0.029    4.985    0.000    0.146    0.277\n .COMMIT13 ~~                                                           \n   .COMMIT33          0.113    0.033    3.462    0.001    0.113    0.214\n  jobsat_1 ~~                                                           \n    jobsat_2          0.392    0.054    7.235    0.000    0.406    0.406\n    jobsat_3          0.292    0.050    5.843    0.000    0.331    0.331\n    ready_1           0.543    0.050   10.795    0.000    0.543    0.543\n    ready_2           0.271    0.057    4.730    0.000    0.273    0.273\n    ready_3           0.175    0.055    3.157    0.002    0.181    0.181\n    commit_1          0.581    0.046   12.487    0.000    0.581    0.581\n    commit_2          0.389    0.060    6.452    0.000    0.361    0.361\n    commit_3          0.230    0.054    4.228    0.000    0.245    0.245\n  jobsat_2 ~~                                                           \n    jobsat_3          0.347    0.052    6.690    0.000    0.409    0.409\n    ready_1           0.200    0.056    3.575    0.000    0.208    0.208\n    ready_2           0.481    0.059    8.088    0.000    0.502    0.502\n    ready_3           0.192    0.054    3.523    0.000    0.206    0.206\n    commit_1          0.277    0.054    5.096    0.000    0.287    0.287\n    commit_2          0.593    0.067    8.869    0.000    0.571    0.571\n    commit_3          0.253    0.057    4.420    0.000    0.280    0.280\n  jobsat_3 ~~                                                           \n    ready_1           0.206    0.047    4.354    0.000    0.234    0.234\n    ready_2           0.264    0.051    5.170    0.000    0.301    0.301\n    ready_3           0.455    0.055    8.240    0.000    0.534    0.534\n    commit_1          0.191    0.052    3.671    0.000    0.217    0.217\n    commit_2          0.281    0.057    4.897    0.000    0.296    0.296\n    commit_3          0.485    0.055    8.772    0.000    0.585    0.585\n  ready_1 ~~                                                            \n    ready_2           0.319    0.061    5.229    0.000    0.321    0.321\n    ready_3           0.271    0.057    4.770    0.000    0.281    0.281\n    commit_1          0.458    0.050    9.214    0.000    0.458    0.458\n    commit_2          0.293    0.064    4.551    0.000    0.271    0.271\n    commit_3          0.225    0.056    4.023    0.000    0.239    0.239\n  ready_2 ~~                                                            \n    ready_3           0.419    0.061    6.875    0.000    0.437    0.437\n    commit_1          0.258    0.057    4.498    0.000    0.259    0.259\n    commit_2          0.664    0.070    9.490    0.000    0.619    0.619\n    commit_3          0.283    0.058    4.875    0.000    0.303    0.303\n  ready_3 ~~                                                            \n    commit_1          0.176    0.058    3.035    0.002    0.182    0.182\n    commit_2          0.305    0.064    4.798    0.000    0.293    0.293\n    commit_3          0.437    0.059    7.338    0.000    0.481    0.481\n  commit_1 ~~                                                           \n    commit_2          0.579    0.058    9.992    0.000    0.537    0.537\n    commit_3          0.371    0.055    6.683    0.000    0.395    0.395\n  commit_2 ~~                                                           \n    commit_3          0.518    0.074    7.024    0.000    0.511    0.511\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n    jbst_1            0.000                               0.000    0.000\n    redy_1            0.000                               0.000    0.000\n    cmmt_1            0.000                               0.000    0.000\n    jbst_2            0.011    0.053    0.215    0.830    0.012    0.012\n    jbst_3            0.096    0.054    1.788    0.074    0.109    0.109\n    redy_2            0.063    0.058    1.082    0.279    0.064    0.064\n    redy_3            0.183    0.060    3.042    0.002    0.189    0.189\n    cmmt_2           -0.161    0.054   -2.985    0.003   -0.150   -0.150\n    cmmt_3           -0.093    0.057   -1.628    0.103   -0.099   -0.099\n   .JOBSAT (intj1)    3.325    0.052   63.876    0.000    3.325    2.738\n   .JOBSAT (intj1)    3.325    0.052   63.876    0.000    3.325    2.804\n   .JOBSAT (intj1)    3.325    0.052   63.876    0.000    3.325    2.959\n   .JOBSAT (intj2)    3.313    0.051   64.637    0.000    3.313    2.704\n   .JOBSAT (intj2)    3.313    0.051   64.637    0.000    3.313    2.771\n   .JOBSAT (intj2)    3.313    0.051   64.637    0.000    3.313    2.929\n   .JOBSAT (intj3)    3.311    0.051   64.381    0.000    3.311    2.710\n   .JOBSAT (intj3)    3.311    0.051   64.381    0.000    3.311    2.777\n   .JOBSAT (intj3)    3.311    0.051   64.381    0.000    3.311    2.934\n   .READY1 (intr1)    3.178    0.049   64.982    0.000    3.178    2.700\n   .READY2 (intr1)    3.178    0.049   64.982    0.000    3.178    2.710\n   .READY3 (intr1)    3.178    0.049   64.982    0.000    3.178    2.759\n   .READY1 (intr2)    3.179    0.048   66.612    0.000    3.179    2.809\n   .READY2 (intr2)    3.179    0.048   66.612    0.000    3.179    2.818\n   .READY3 (intr2)    3.179    0.048   66.612    0.000    3.179    2.864\n   .READY1 (intr3)    3.173    0.049   65.244    0.000    3.173    2.739\n   .READY2 (intr3)    3.173    0.049   65.244    0.000    3.173    2.748\n   .READY3 (intr3)    3.173    0.049   65.244    0.000    3.173    2.795\n   .COMMIT (intc1)    3.688    0.044   83.049    0.000    3.688    3.448\n   .COMMIT (intc1)    3.688    0.044   83.049    0.000    3.688    3.298\n   .COMMIT (intc1)    3.688    0.044   83.049    0.000    3.688    3.570\n   .COMMIT (intc2)    3.666    0.044   83.392    0.000    3.666    3.382\n   .COMMIT (intc2)    3.666    0.044   83.392    0.000    3.666    3.239\n   .COMMIT (intc2)    3.666    0.044   83.392    0.000    3.666    3.498\n   .COMMIT (intc3)    3.615    0.046   77.903    0.000    3.615    3.290\n   .COMMIT (intc3)    3.615    0.046   77.903    0.000    3.615    3.149\n   .COMMIT (intc3)    3.615    0.046   77.903    0.000    3.615    3.405\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all\n    jobst_1           1.000                               1.000    1.000\n    ready_1           1.000                               1.000    1.000\n    commt_1           1.000                               1.000    1.000\n    jobst_2           0.928    0.066   13.967    0.000    1.000    1.000\n    jobst_3           0.778    0.064   12.182    0.000    1.000    1.000\n    ready_2           0.988    0.079   12.549    0.000    1.000    1.000\n    ready_3           0.932    0.078   11.971    0.000    1.000    1.000\n    commt_2           1.163    0.106   10.996    0.000    1.000    1.000\n    commt_3           0.882    0.086   10.237    0.000    1.000    1.000\n   .JOBSAT1 (rsj1)    0.518    0.030   17.508    0.000    0.518    0.351\n   .JOBSAT2 (rsj1)    0.518    0.030   17.508    0.000    0.518    0.368\n   .JOBSAT3 (rsj1)    0.518    0.030   17.508    0.000    0.518    0.410\n   .JOBSAT1 (rsj2)    0.502    0.029   17.126    0.000    0.502    0.335\n   .JOBSAT2 (rsj2)    0.502    0.029   17.126    0.000    0.502    0.351\n   .JOBSAT3 (rsj2)    0.502    0.029   17.126    0.000    0.502    0.392\n   .JOBSAT1 (rsj3)    0.505    0.031   16.313    0.000    0.505    0.339\n   .JOBSAT2 (rsj3)    0.505    0.031   16.313    0.000    0.505    0.355\n   .JOBSAT3 (rsj3)    0.505    0.031   16.313    0.000    0.505    0.397\n   .READY11 (rsr1)    0.524    0.032   16.570    0.000    0.524    0.378\n   .READY21 (rsr1)    0.524    0.032   16.570    0.000    0.524    0.381\n   .READY31 (rsr1)    0.524    0.032   16.570    0.000    0.524    0.395\n   .READY12 (rsr2)    0.567    0.032   17.928    0.000    0.567    0.443\n   .READY22 (rsr2)    0.567    0.032   17.928    0.000    0.567    0.445\n   .READY32 (rsr2)    0.567    0.032   17.928    0.000    0.567    0.460\n   .READY13 (rsr3)    0.543    0.031   17.310    0.000    0.543    0.405\n   .READY23 (rsr3)    0.543    0.031   17.310    0.000    0.543    0.408\n   .READY33 (rsr3)    0.543    0.031   17.310    0.000    0.543    0.422\n   .COMMIT1 (rsc1)    0.490    0.030   16.386    0.000    0.490    0.428\n   .COMMIT2 (rsc1)    0.490    0.030   16.386    0.000    0.490    0.391\n   .COMMIT3 (rsc1)    0.490    0.030   16.386    0.000    0.490    0.459\n   .COMMIT1 (rsc2)    0.525    0.031   16.863    0.000    0.525    0.447\n   .COMMIT2 (rsc2)    0.525    0.031   16.863    0.000    0.525    0.410\n   .COMMIT3 (rsc2)    0.525    0.031   16.863    0.000    0.525    0.478\n   .COMMIT1 (rsc3)    0.528    0.031   16.800    0.000    0.528    0.437\n   .COMMIT2 (rsc3)    0.528    0.031   16.800    0.000    0.528    0.401\n   .COMMIT3 (rsc3)    0.528    0.031   16.800    0.000    0.528    0.468\n\nR-Square:\n                   Estimate\n    JOBSAT11          0.649\n    JOBSAT21          0.632\n    JOBSAT31          0.590\n    JOBSAT12          0.665\n    JOBSAT22          0.649\n    JOBSAT32          0.608\n    JOBSAT13          0.661\n    JOBSAT23          0.645\n    JOBSAT33          0.603\n    READY11           0.622\n    READY21           0.619\n    READY31           0.605\n    READY12           0.557\n    READY22           0.555\n    READY32           0.540\n    READY13           0.595\n    READY23           0.592\n    READY33           0.578\n    COMMIT11          0.572\n    COMMIT21          0.609\n    COMMIT31          0.541\n    COMMIT12          0.553\n    COMMIT22          0.590\n    COMMIT32          0.522\n    COMMIT13          0.563\n    COMMIT23          0.599\n    COMMIT33          0.532\n\n\n\n10.5.4 Modification Indices\n\nCodemodificationindices(\n  residualInvariance_fit,\n  sort. = TRUE)\n\n\n  \n\n\n\n\n10.5.5 Path Diagram\n\nCodelavaanPlot::lavaanPlot2(\n  residualInvariance_fit,\n  stand = TRUE,\n  coef_labels = TRUE)\n\n\nPath Diagram\n\n\nTo create an interactive path diagram, you can use the following syntax:\n\nCodelavaangui::plot_lavaan(residualInvariance_fit)\n\n\n\n10.5.6 Compare Models\n\nCodeanova(\n  scalarInvariance_fit,\n  residualInvariance_fit\n)\n\n\n  \n\n\nCoderound(cbind(\n  configural = inspect(configuralInvarianceCorrelatedResiduals_fit, \"fit.measures\"), \n  weak = inspect(metricInvariance_fit, \"fit.measures\"),\n  strong = inspect(scalarInvariance_fit, \"fit.measures\"),\n  strict = inspect(residualInvariance_fit, \"fit.measures\")), 3)\n\n                              configural       weak     strong     strict\nnpar                             144.000    132.000    120.000    102.000\nfmin                               0.280      0.289      0.298      0.306\nchisq                            277.582    286.159    295.447    303.347\ndf                               261.000    273.000    285.000    303.000\npvalue                             0.230      0.280      0.323      0.484\nchisq.scaled                     281.997    292.814    302.078    310.092\ndf.scaled                        261.000    273.000    285.000    303.000\npvalue.scaled                      0.178      0.196      0.233      0.377\nchisq.scaling.factor               0.984      0.977      0.978      0.978\nbaseline.chisq                  6697.063   6697.063   6697.063   6697.063\nbaseline.df                      351.000    351.000    351.000    351.000\nbaseline.pvalue                    0.000      0.000      0.000      0.000\nbaseline.chisq.scaled           6541.933   6541.933   6541.933   6541.933\nbaseline.df.scaled               351.000    351.000    351.000    351.000\nbaseline.pvalue.scaled             0.000      0.000      0.000      0.000\nbaseline.chisq.scaling.factor      1.024      1.024      1.024      1.024\ncfi                                0.997      0.998      0.998      1.000\ntli                                0.996      0.997      0.998      1.000\ncfi.scaled                         0.997      0.997      0.997      0.999\ntli.scaled                         0.995      0.996      0.997      0.999\ncfi.robust                         0.997      0.997      0.997      0.999\ntli.robust                         0.996      0.996      0.997      0.999\nnnfi                               0.996      0.997      0.998      1.000\nrfi                                0.944      0.945      0.946      0.948\nnfi                                0.959      0.957      0.956      0.955\npnfi                               0.713      0.745      0.776      0.824\nifi                                0.997      0.998      0.998      1.000\nrni                                0.997      0.998      0.998      1.000\nnnfi.scaled                        0.995      0.996      0.997      0.999\nrfi.scaled                         0.942      0.942      0.943      0.945\nnfi.scaled                         0.957      0.955      0.954      0.953\npnfi.scaled                        0.712      0.743      0.774      0.822\nifi.scaled                         0.997      0.997      0.997      0.999\nrni.scaled                         0.997      0.997      0.997      0.999\nnnfi.robust                        0.996      0.996      0.997      0.999\nrni.robust                         0.997      0.997      0.997      0.999\nlogl                          -17470.154 -17474.443 -17479.087 -17483.037\nunrestricted.logl             -17331.363 -17331.363 -17331.363 -17331.363\naic                            35228.308  35212.885  35198.174  35170.074\nbic                            35833.764  35767.887  35702.721  35598.939\nntotal                           495.000    495.000    495.000    495.000\nbic2                           35376.705  35348.916  35321.838  35275.188\nscaling.factor.h1                  0.998      0.998      0.998      0.998\nscaling.factor.h0                  0.943      0.880      0.803      0.690\nrmsea                              0.011      0.010      0.009      0.002\nrmsea.ci.lower                     0.000      0.000      0.000      0.000\nrmsea.ci.upper                     0.022      0.021      0.020      0.017\nrmsea.ci.level                     0.900      0.900      0.900      0.900\nrmsea.pvalue                       1.000      1.000      1.000      1.000\nrmsea.close.h0                     0.050      0.050      0.050      0.050\nrmsea.notclose.pvalue              0.000      0.000      0.000      0.000\nrmsea.notclose.h0                  0.080      0.080      0.080      0.080\nrmsea.scaled                       0.013      0.012      0.011      0.007\nrmsea.ci.lower.scaled              0.000      0.000      0.000      0.000\nrmsea.ci.upper.scaled              0.023      0.022      0.021      0.019\nrmsea.pvalue.scaled                1.000      1.000      1.000      1.000\nrmsea.notclose.pvalue.scaled       0.000      0.000      0.000      0.000\nrmsea.robust                       0.012      0.012      0.011      0.006\nrmsea.ci.lower.robust              0.000      0.000      0.000      0.000\nrmsea.ci.upper.robust              0.022      0.022      0.021      0.018\nrmsea.pvalue.robust                1.000      1.000      1.000      1.000\nrmsea.notclose.pvalue.robust       0.000      0.000      0.000      0.000\nrmr                                0.031      0.031      0.032      0.032\nrmr_nomean                         0.032      0.032      0.032      0.033\nsrmr                               0.023      0.024      0.024      0.025\nsrmr_bentler                       0.023      0.024      0.024      0.025\nsrmr_bentler_nomean                0.024      0.025      0.025      0.025\ncrmr                               0.024      0.024      0.024      0.024\ncrmr_nomean                        0.025      0.025      0.025      0.025\nsrmr_mplus                         0.023      0.025      0.025      0.026\nsrmr_mplus_nomean                  0.024      0.024      0.024      0.025\ncn_05                            535.412    541.630    546.140    563.310\ncn_01                            566.422    572.322    576.447    593.652\ngfi                                0.989      0.988      0.988      0.988\nagfi                               0.983      0.983      0.983      0.984\npgfi                               0.637      0.666      0.695      0.739\nmfi                                0.983      0.987      0.990      1.000\necvi                               1.143      1.111      1.082      1.025"
  },
  {
    "objectID": "simulate-data.html",
    "href": "simulate-data.html",
    "title": "Simulate Data",
    "section": "",
    "text": "Codelibrary(\"MASS\")\nlibrary(\"psych\")\nlibrary(\"tidyverse\")\nlibrary(\"lme4\")\nlibrary(\"lmerTest\")"
  },
  {
    "objectID": "simulate-data.html#load-libraries",
    "href": "simulate-data.html#load-libraries",
    "title": "Simulate Data",
    "section": "",
    "text": "Codelibrary(\"MASS\")\nlibrary(\"psych\")\nlibrary(\"tidyverse\")\nlibrary(\"lme4\")\nlibrary(\"lmerTest\")"
  },
  {
    "objectID": "simulate-data.html#check",
    "href": "simulate-data.html#check",
    "title": "Simulate Data",
    "section": "\n2.1 Check",
    "text": "2.1 Check\n\nCodedescribe(df)\n\n\n  \n\n\nCodecor(\n  x = df |&gt; select(depression, anxiety, sleep, ses),\n  use = \"pairwise.complete.obs\")\n\n           depression    anxiety      sleep        ses\ndepression  1.0000000  0.7352566 -0.3022551 -0.3171477\nanxiety     0.7352566  1.0000000 -0.2471106 -0.2497336\nsleep      -0.3022551 -0.2471106  1.0000000  0.4948693\nses        -0.3171477 -0.2497336  0.4948693  1.0000000\n\nCodehead(df)\n\n\n  \n\n\nCodesummary(lmer(\n  depression ~ lag(anxiety) + lag(depression) + age + sex + (1|ID),\n  data = df))\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: depression ~ lag(anxiety) + lag(depression) + age + sex + (1 |  \n    ID)\n   Data: df\n\nREML criterion at convergence: 4775.6\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.2002 -0.5081 -0.1284  0.4673  3.3306 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n ID       (Intercept) 21.83    4.672   \n Residual              7.16    2.676   \nNumber of obs: 866, groups:  ID, 250\n\nFixed effects:\n                 Estimate Std. Error        df t value Pr(&gt;|t|)    \n(Intercept)       1.01595    1.44137 715.47955   0.705  0.48113    \nlag(anxiety)      0.10589    0.02851 708.01306   3.714  0.00022 ***\nlag(depression)   0.18044    0.02891 717.42565   6.241 7.43e-10 ***\nage               0.49832    0.08698 605.87838   5.729 1.59e-08 ***\nsexmale          -3.82035    0.62760 229.13169  -6.087 4.79e-09 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) lg(nx) lg(dp) age   \nlag(anxity) -0.045                     \nlag(dprssn) -0.120 -0.766              \nage         -0.946 -0.001  0.067       \nsexmale     -0.211  0.015  0.042  0.009\n\nCodesummary(lmer(\n  anxiety ~ lag(depression) + lag(anxiety) + age + sex + (1|ID),\n  data = df))\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: anxiety ~ lag(depression) + lag(anxiety) + age + sex + (1 | ID)\n   Data: df\n\nREML criterion at convergence: 4812.4\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.2445 -0.5619 -0.1192  0.4608  3.4108 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n ID       (Intercept) 20.639   4.543   \n Residual              7.736   2.781   \nNumber of obs: 866, groups:  ID, 250\n\nFixed effects:\n                 Estimate Std. Error        df t value Pr(&gt;|t|)    \n(Intercept)      -3.53258    1.48987 707.97997  -2.371    0.018 *  \nlag(depression)   0.04526    0.02987 732.31955   1.516    0.130    \nlag(anxiety)      0.21592    0.02947 722.36199   7.328 6.27e-13 ***\nage               0.81105    0.09034 609.49541   8.978  &lt; 2e-16 ***\nsexmale          -3.91681    0.61448 231.11897  -6.374 9.87e-10 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) lg(dp) lg(nx) age   \nlag(dprssn) -0.120                     \nlag(anxity) -0.046 -0.765              \nage         -0.950  0.066 -0.001       \nsexmale     -0.202  0.045  0.016  0.010\n\n\n\nCodehist(\n  df$depression,\n  breaks = 30,\n  main = \"Depression Distribution\",\n  xlab = \"Depression symptoms\")\n\n\n\n\n\n\n\n\nCodehist(\n  df$anxiety,\n  breaks = 30,\n  main = \"Anxiety Distribution\",\n  xlab = \"Anxiety symptoms\")\n\n\n\n\n\n\n\n\nCode# --- Summarize mean + SD by age and sex ---\ndf_summary &lt;- df |&gt;\n  group_by(age, sex) |&gt;\n  summarize(\n    mean_dep = mean(depression, na.rm=TRUE),\n    sd_dep   = sd(depression, na.rm=TRUE),\n    mean_anx = mean(anxiety, na.rm=TRUE),\n    sd_anx   = sd(anxiety, na.rm=TRUE),\n    n        = n(),\n    .groups = \"drop\"\n  )\n\n# --- Plot Depression by Age and Sex ---\nggplot(df_summary, aes(x=age, y=mean_dep, color=sex)) +\n  geom_line(linewidth=1.2) +\n  geom_point(size=2) +\n  geom_ribbon(aes(ymin=mean_dep-sd_dep, ymax=mean_dep+sd_dep, fill=sex), alpha=0.2, color=NA) +\n  labs(title=\"Depression Symptoms by Age and Sex\",\n       x=\"Age\", y=\"Mean Depression Symptoms\") +\n  theme_minimal() +\n  scale_color_manual(values=c(\"female\"=\"red\", \"male\"=\"blue\")) +\n  scale_fill_manual(values=c(\"female\"=\"red\", \"male\"=\"blue\"))\n\n\n\n\n\n\nCode# --- Plot Anxiety by Age and Sex ---\nggplot(df_summary, aes(x=age, y=mean_anx, color=sex)) +\n  geom_line(linewidth=1.2) +\n  geom_point(size=2) +\n  geom_ribbon(aes(ymin=mean_anx-sd_anx, ymax=mean_anx+sd_anx, fill=sex), alpha=0.2, color=NA) +\n  labs(title=\"Anxiety Symptoms by Age and Sex\",\n       x=\"Age\", y=\"Mean Anxiety Symptoms\") +\n  theme_minimal() +\n  scale_color_manual(values=c(\"female\"=\"red\", \"male\"=\"blue\")) +\n  scale_fill_manual(values=c(\"female\"=\"red\", \"male\"=\"blue\"))"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About This Website",
    "section": "",
    "text": "This website for the 2026 Center for Social Science Innovation (CSSI) Workshop on Longitudinal Data Analysis was generated with Quarto. The codebase that was used to generate this website is located here.\n\n1 Contact\nFor questions intended for Isaac Petersen, feel free to contact Isaac by email isaac-t-petersen@uiowa.edu. For questions about the Developmental Psychopathology Lab, please contact devpsy-lab@uiowa.edu.\n\n2 License\n\n\nCC BY 4.0\n\nThis work is licensed under a Creative Commons Attribution 4.0 International License.\n\n\nCC BY 4.0\n\n\n3 Session Info\n\nCodesessionInfo()\n\nR version 4.5.2 (2025-10-31)\nPlatform: x86_64-pc-linux-gnu\nRunning under: Ubuntu 24.04.3 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 \nLAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: UTC\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nloaded via a namespace (and not attached):\n [1] htmlwidgets_1.6.4 compiler_4.5.2    fastmap_1.2.0     cli_3.6.5        \n [5] tools_4.5.2       htmltools_0.5.9   otel_0.2.0        yaml_2.3.12      \n [9] rmarkdown_2.30    knitr_1.51        jsonlite_2.0.0    xfun_0.56        \n[13] digest_0.6.39     rlang_1.1.7       evaluate_1.0.5   \n\n\n\n\n\n\nReuseCC BY 4.0"
  },
  {
    "objectID": "mixed-effects-models.html",
    "href": "mixed-effects-models.html",
    "title": "Mixed-Effects Models",
    "section": "",
    "text": "For an overview of mixed modeling, see my chapter on “Mixed Modeling” in the following textbook:\nPetersen, I. T. (2025). Fantasy football analytics: Statistics, prediction, and empiricism using R. University of Iowa Libraries. https://isaactpetersen.github.io/Fantasy-Football-Analytics-Textbook"
  },
  {
    "objectID": "mixed-effects-models.html#load-libraries",
    "href": "mixed-effects-models.html#load-libraries",
    "title": "Mixed-Effects Models",
    "section": "\n1.1 Load Libraries",
    "text": "1.1 Load Libraries\n\nCodelibrary(\"lme4\")\nlibrary(\"lmerTest\")\nlibrary(\"mgcv\")\nlibrary(\"easystats\")\nlibrary(\"parallelly\")\nlibrary(\"MuMIn\")\nlibrary(\"tidyverse\")"
  },
  {
    "objectID": "mixed-effects-models.html#load-data",
    "href": "mixed-effects-models.html#load-data",
    "title": "Mixed-Effects Models",
    "section": "\n1.2 Load Data",
    "text": "1.2 Load Data\nThe data for this example were simulated:\n\nCodemydata_long &lt;- read.csv(\"./data/mydata_long.csv\")"
  },
  {
    "objectID": "mixed-effects-models.html#fit-the-model",
    "href": "mixed-effects-models.html#fit-the-model",
    "title": "Mixed-Effects Models",
    "section": "\n4.1 Fit the Model",
    "text": "4.1 Fit the Model\nIn estimating linear growth curves of depression symptoms, this model fits:\n\nrandom intercepts and slopes for subjects,\n\nsex as a time-invariant fixed-effect predictor of the intercepts and slopes, and\n\nsleep as a time-varying fixed-effect predictor of depression, with effects allowed to vary over age and by sex, including two‐ and three‐way interactions with age and sex.\n\n\nCodelinearGCM &lt;- lmerTest::lmer(\n  depression ~ sexFactor + ageCentered + sexFactor:ageCentered + \n    sleep + sleep:ageCentered + sexFactor:sleep + sexFactor:sleep:ageCentered + \n    (1 + ageCentered | ID),\n  data = mydata_long,\n  na.action = na.exclude)"
  },
  {
    "objectID": "mixed-effects-models.html#model-summary",
    "href": "mixed-effects-models.html#model-summary",
    "title": "Mixed-Effects Models",
    "section": "\n4.2 Model Summary",
    "text": "4.2 Model Summary\n\nCodesummary(linearGCM)\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: depression ~ sexFactor + ageCentered + sexFactor:ageCentered +  \n    sleep + sleep:ageCentered + sexFactor:sleep + sexFactor:sleep:ageCentered +  \n    (1 + ageCentered | ID)\n   Data: mydata_long\n\nREML criterion at convergence: 4763.2\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-2.6405 -0.4712 -0.0088  0.4393  2.5703 \n\nRandom effects:\n Groups   Name        Variance Std.Dev. Corr\n ID       (Intercept) 14.144   3.761        \n          ageCentered  2.342   1.530    0.60\n Residual              3.029   1.740        \nNumber of obs: 931, groups:  ID, 250\n\nFixed effects:\n                                 Estimate Std. Error        df t value Pr(&gt;|t|)\n(Intercept)                      17.52934    1.36182 532.76805  12.872  &lt; 2e-16\nsexFactormale                    -1.88370    2.02693 535.62207  -0.929   0.3531\nageCentered                       1.79858    0.71361 476.29718   2.520   0.0120\nsleep                            -0.86981    0.16355 505.61680  -5.318 1.57e-07\nsexFactormale:ageCentered        -2.52264    1.08549 493.04238  -2.324   0.0205\nageCentered:sleep                -0.10633    0.08654 466.35616  -1.229   0.2198\nsexFactormale:sleep              -0.04683    0.24585 508.01056  -0.191   0.8490\nsexFactormale:ageCentered:sleep   0.10563    0.13247 482.46640   0.797   0.4256\n                                   \n(Intercept)                     ***\nsexFactormale                      \nageCentered                     *  \nsleep                           ***\nsexFactormale:ageCentered       *  \nageCentered:sleep                  \nsexFactormale:sleep                \nsexFactormale:ageCentered:sleep    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) sxFctr agCntr sleep  sxFc:C agCnt: sxFct:\nsexFactorml -0.672                                          \nageCentered -0.536  0.360                                   \nsleep       -0.968  0.650  0.573                            \nsxFctrml:gC  0.353 -0.529 -0.657 -0.377                     \nagCntrd:slp  0.566 -0.380 -0.978 -0.584  0.643              \nsxFctrml:sl  0.644 -0.967 -0.381 -0.665  0.566  0.389       \nsxFctrml:C: -0.370  0.564  0.639  0.382 -0.979 -0.653 -0.583\n\nCodeprint(effectsize::standardize_parameters(\n  linearGCM,\n  method = \"refit\"),\n  digits = 2)\n\n# Standardization method: refit\n\nParameter                                | Std. Coef. |         95% CI\n----------------------------------------------------------------------\n(Intercept)                              |       0.31 | [ 0.17,  0.44]\nsexFactor [male]                         |      -0.71 | [-0.91, -0.50]\nageCentered                              |       0.16 | [ 0.11,  0.21]\nsleep                                    |      -0.18 | [-0.22, -0.13]\nsexFactor [male] × ageCentered           |      -0.28 | [-0.36, -0.21]\nageCentered × sleep                      |      -0.02 | [-0.05,  0.01]\nsexFactor [male] × sleep                 |       0.02 | [-0.05,  0.09]\n(sexFactor [male] × ageCentered) × sleep |       0.02 | [-0.03,  0.07]\n\nCodeperformance::r2(linearGCM)\n\n# R2 for Mixed Models\n\n  Conditional R2: 0.928\n     Marginal R2: 0.175"
  },
  {
    "objectID": "mixed-effects-models.html#plots",
    "href": "mixed-effects-models.html#plots",
    "title": "Mixed-Effects Models",
    "section": "\n4.3 Plots",
    "text": "4.3 Plots\n\n4.3.1 Prototypical Growth Curve\n\nCodenewData &lt;- expand.grid(\n  sexFactor = c(\"female\", \"male\"),\n  age = c(\n    min(mydata_long$age, na.rm = TRUE),\n    max(mydata_long$age, na.rm = TRUE))\n)\n\nnewData$ageCentered &lt;- newData$age - min(newData$age)\n\nnewData$sleep &lt;- NA\nnewData$sleep[which(newData$sexFactor == \"female\" & newData$age == 14)] &lt;- mean(mydata_long$sleep[which(mydata_long$sexFactor == \"female\" & mydata_long$age == 14)], na.rm = TRUE)\nnewData$sleep[which(newData$sexFactor == \"male\" & newData$age == 14)] &lt;- mean(mydata_long$sleep[which(mydata_long$sexFactor == \"male\" & mydata_long$age == 14)], na.rm = TRUE)\nnewData$sleep[which(newData$sexFactor == \"female\" & newData$age == 17)] &lt;- mean(mydata_long$sleep[which(mydata_long$sexFactor == \"female\" & mydata_long$age == 17)], na.rm = TRUE)\nnewData$sleep[which(newData$sexFactor == \"male\" & newData$age == 17)] &lt;- mean(mydata_long$sleep[which(mydata_long$sexFactor == \"male\" & mydata_long$age == 17)], na.rm = TRUE)\n\nnewData$modelImpliedDepression &lt;- predict( # predict.merMod\n  linearGCM,\n  newdata = newData,\n  re.form = NA # include no random effects\n)\n\nggplot(\n  data = newData,\n  mapping = aes(\n    x = age,\n    y = modelImpliedDepression,\n    color = sexFactor)) +\n  geom_line() +\n  labs(\n    x = \"Age (years)\",\n    y = \"Depression Symptoms\",\n    color = \"Sex\"\n  ) +\n  theme_classic()\n\n\n\nPrototypical Model-Implied Growth Curves of Depression Symptoms By Sex\n\n\n\n\n4.3.2 Individuals’ Growth Curves\n\nCodemydata_long$modelImpliedDepression &lt;- predict( # predict.merMod\n  linearGCM,\n  newdata = mydata_long,\n  re.form = NULL # include all random effects\n)\n\nggplot(\n  data = mydata_long,\n  mapping = aes(\n    x = age,\n    y = modelImpliedDepression,\n    group = ID,\n    color = sexFactor)) +\n  geom_smooth(\n    method = \"lm\",\n    se = FALSE,\n    linewidth = 0.5\n  ) +\n  labs(\n    x = \"Age (years)\",\n    y = \"Depression Symptoms\",\n    color = \"Sex\"\n  ) +\n  theme_classic()\n\n\n\nIndividuals’ Model-Implied Growth Curves of Depression Symptoms\n\n\n\n\n4.3.3 Individuals’ Trajectories Overlaid with Prototypical Trajectory\n\nCodeggplot(\n  data = mydata_long,\n  mapping = aes(\n    x = age,\n    y = modelImpliedDepression,\n    group = ID)) +\n  geom_smooth(\n    method = \"lm\",\n    se = FALSE,\n    linewidth = 0.5,\n    color = \"gray\",\n    alpha = 0.30\n  ) +\n  geom_line(\n    data = newData,\n    mapping = aes(\n      x = age,\n      y = modelImpliedDepression,\n      group = sexFactor,\n      color = sexFactor),\n    linewidth = 2) +\n  labs(\n    x = \"Age (years)\",\n    y = \"Depression Symptoms\",\n    color = \"Sex\"\n  ) +\n  theme_classic()\n\n\n\nIndividuals’ Model-Implied Growth Curves of Depression Symptoms Overlaid With Prototypical Growth Curves By Sex"
  },
  {
    "objectID": "mixed-effects-models.html#fit-the-model-1",
    "href": "mixed-effects-models.html#fit-the-model-1",
    "title": "Mixed-Effects Models",
    "section": "\n5.1 Fit the Model",
    "text": "5.1 Fit the Model\nIn estimating polynomial (in this case, quadratic) growth curves of depression symptoms, this model fits:\n\nrandom intercepts and random linear and quadratic slopes for subjects,\n\nsex as a time-invariant fixed-effect predictor of the intercepts and slopes, and\n\nsleep as a time-varying fixed-effect predictor of depression, with effects allowed to vary over age and by sex, including two‐ and three‐way interactions with age and sex.\n\n\nCodequadraticGCM &lt;- lmerTest::lmer(\n  depression ~ sexFactor + ageCentered + ageCenteredSquared + \n    sexFactor:ageCentered + sexFactor:ageCenteredSquared + sleep + \n    sleep:ageCentered + sleep:ageCenteredSquared + sexFactor:sleep + \n    sexFactor:sleep:ageCentered + sexFactor:sleep:ageCenteredSquared + \n    (1 + ageCentered + ageCenteredSquared | ID),\n  data = mydata_long,\n  na.action = na.exclude)"
  },
  {
    "objectID": "mixed-effects-models.html#model-summary-1",
    "href": "mixed-effects-models.html#model-summary-1",
    "title": "Mixed-Effects Models",
    "section": "\n5.2 Model Summary",
    "text": "5.2 Model Summary\n\nCodesummary(quadraticGCM)\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: \ndepression ~ sexFactor + ageCentered + ageCenteredSquared + sexFactor:ageCentered +  \n    sexFactor:ageCenteredSquared + sleep + sleep:ageCentered +  \n    sleep:ageCenteredSquared + sexFactor:sleep + sexFactor:sleep:ageCentered +  \n    sexFactor:sleep:ageCenteredSquared + (1 + ageCentered + ageCenteredSquared |  \n    ID)\n   Data: mydata_long\n\nREML criterion at convergence: 4610.8\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-2.9269 -0.3434 -0.0346  0.3236  3.5930 \n\nRandom effects:\n Groups   Name               Variance Std.Dev. Corr       \n ID       (Intercept)        15.143   3.8914              \n          ageCentered         5.239   2.2888    0.33      \n          ageCenteredSquared  0.393   0.6269    0.02 -0.70\n Residual                     1.469   1.2120              \nNumber of obs: 931, groups:  ID, 250\n\nFixed effects:\n                                        Estimate Std. Error        df t value\n(Intercept)                             16.83942    1.33047 360.41918  12.657\nsexFactormale                           -0.65168    1.96691 362.65892  -0.331\nageCentered                              1.27362    1.73906 345.10314   0.732\nageCenteredSquared                       0.16205    0.58001 331.62850   0.279\nsleep                                   -0.71434    0.15915 333.71268  -4.489\nsexFactormale:ageCentered               -6.78153    2.58414 371.68835  -2.624\nsexFactormale:ageCenteredSquared         1.49799    0.87518 354.07705   1.712\nageCentered:sleep                       -0.26802    0.21350 345.20080  -1.255\nageCenteredSquared:sleep                 0.05735    0.07151 332.60042   0.802\nsexFactormale:sleep                     -0.20067    0.23813 334.89475  -0.843\nsexFactormale:ageCentered:sleep          0.63660    0.31909 370.76408   1.995\nsexFactormale:ageCenteredSquared:sleep  -0.18427    0.10835 356.25239  -1.701\n                                       Pr(&gt;|t|)    \n(Intercept)                             &lt; 2e-16 ***\nsexFactormale                           0.74060    \nageCentered                             0.46445    \nageCenteredSquared                      0.78012    \nsleep                                  9.89e-06 ***\nsexFactormale:ageCentered               0.00904 ** \nsexFactormale:ageCenteredSquared        0.08784 .  \nageCentered:sleep                       0.21019    \nageCenteredSquared:sleep                0.42313    \nsexFactormale:sleep                     0.40002    \nsexFactormale:ageCentered:sleep         0.04677 *  \nsexFactormale:ageCenteredSquared:sleep  0.08989 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) sxFctr agCntr agCntS sleep  sxFc:C sxF:CS agCnt: agCnS:\nsexFactorml -0.676                                                        \nageCentered -0.549  0.372                                                 \nagCntrdSqrd  0.361 -0.244 -0.918                                          \nsleep       -0.966  0.653  0.572 -0.369                                   \nsxFctrml:gC  0.370 -0.540 -0.673  0.618 -0.385                            \nsxFctrml:CS -0.239  0.349  0.608 -0.663  0.244 -0.915                     \nagCntrd:slp  0.557 -0.376 -0.989  0.914 -0.575  0.666 -0.605              \nagCntrdSqr: -0.357  0.241  0.909 -0.991  0.369 -0.612  0.657 -0.921       \nsxFctrml:sl  0.646 -0.965 -0.383  0.247 -0.668  0.563 -0.356  0.385 -0.246\nsxFctrml:C: -0.372  0.555  0.662 -0.611  0.385 -0.989  0.909 -0.669  0.616\nsxFctrm:CS:  0.236 -0.350 -0.600  0.654 -0.243  0.906 -0.991  0.608 -0.660\n            sxFct: sxF:C:\nsexFactorml              \nageCentered              \nagCntrdSqrd              \nsleep                    \nsxFctrml:gC              \nsxFctrml:CS              \nagCntrd:slp              \nagCntrdSqr:              \nsxFctrml:sl              \nsxFctrml:C: -0.574       \nsxFctrm:CS:  0.363 -0.917\noptimizer (nloptwrap) convergence code: 0 (OK)\nModel failed to converge with max|grad| = 0.0021797 (tol = 0.002, component 1)\n  See ?lme4::convergence and ?lme4::troubleshooting.\n\nCodeprint(effectsize::standardize_parameters(\n  quadraticGCM,\n  method = \"refit\"),\n  digits = 2)\n\n# Standardization method: refit\n\nParameter                                       | Std. Coef. |         95% CI\n-----------------------------------------------------------------------------\n(Intercept)                                     |       0.31 | [ 0.17,  0.44]\nsexFactor [male]                                |      -0.70 | [-0.90, -0.49]\nageCentered                                     |      -0.15 | [-0.23, -0.06]\nageCenteredSquared                              |       0.33 | [ 0.25,  0.40]\nsleep                                           |      -0.16 | [-0.19, -0.12]\nsexFactor [male] × ageCentered                  |      -0.28 | [-0.41, -0.15]\nsexFactor [male] × ageCenteredSquared           |       0.01 | [-0.11,  0.13]\nageCentered × sleep                             |      -0.05 | [-0.13,  0.03]\nageCenteredSquared × sleep                      |       0.03 | [-0.05,  0.12]\nsexFactor [male] × sleep                        |       0.02 | [-0.04,  0.08]\n(sexFactor [male] × ageCentered) × sleep        |       0.12 | [ 0.00,  0.24]\n(sexFactor [male] × ageCenteredSquared) × sleep |      -0.11 | [-0.23,  0.02]\n\nCodeperformance::r2(quadraticGCM)\n\n# R2 for Mixed Models\n\n  Conditional R2: 0.965\n     Marginal R2: 0.177"
  },
  {
    "objectID": "mixed-effects-models.html#plots-1",
    "href": "mixed-effects-models.html#plots-1",
    "title": "Mixed-Effects Models",
    "section": "\n5.3 Plots",
    "text": "5.3 Plots\n\n5.3.1 Prototypical Growth Curve\n\nCodenewData &lt;- expand.grid(\n  sexFactor = c(\"female\", \"male\"),\n  age = seq(\n    from = min(mydata_long$age, na.rm = TRUE),\n    to = max(mydata_long$age, na.rm = TRUE),\n    length.out = 10000\n  ),\n  sleep = mean(mydata_long$sleep, na.rm = TRUE)\n)\n\nnewData$ageCentered &lt;- newData$age - min(newData$age)\nnewData$ageCenteredSquared &lt;- newData$ageCentered ^ 2\n\nnewData$modelImpliedDepression &lt;- predict( # predict.merMod\n  quadraticGCM,\n  newdata = newData,\n  re.form = NA # include no random effects\n)\n\nggplot(\n  data = newData,\n  mapping = aes(\n    x = age,\n    y = modelImpliedDepression,\n    color = sexFactor)) +\n  geom_line() +\n  labs(\n    x = \"Age (years)\",\n    y = \"Depression Symptoms\",\n    color = \"Sex\"\n  ) +\n  theme_classic()\n\n\n\nPrototypical Model-Implied Growth Curves of Depression Symptoms By Sex\n\n\n\n\n5.3.2 Individuals’ Growth Curves\n\nCodemydata_long$modelImpliedDepression &lt;- predict( # predict.merMod\n  quadraticGCM,\n  newdata = mydata_long,\n  re.form = NULL # include all random effects\n)\n\nggplot(\n  data = mydata_long,\n  mapping = aes(\n    x = age,\n    y = modelImpliedDepression,\n    group = ID,\n    color = sexFactor)) +\n  geom_smooth(\n    method = \"lm\",\n    formula = y ~ x + I(x^2),\n    se = FALSE,\n    linewidth = 0.5\n  ) +\n  labs(\n    x = \"Age (years)\",\n    y = \"Depression Symptoms\",\n    color = \"Sex\"\n  ) +\n  theme_classic()\n\n\n\nIndividuals’ Model-Implied Growth Curves of Depression Symptoms\n\n\n\n\n5.3.3 Individuals’ Trajectories Overlaid with Prototypical Trajectory\n\nCodeggplot(\n  data = mydata_long,\n  mapping = aes(\n    x = age,\n    y = modelImpliedDepression,\n    group = ID)) +\n  geom_smooth(\n    method = \"lm\",\n    formula = y ~ x + I(x^2),\n    se = FALSE,\n    linewidth = 0.5,\n    color = \"gray\",\n    alpha = 0.30\n  ) +\n  geom_line(\n    data = newData,\n    mapping = aes(\n      x = age,\n      y = modelImpliedDepression,\n      group = sexFactor,\n      color = sexFactor),\n    linewidth = 2) +\n  labs(\n    x = \"Age (years)\",\n    y = \"Depression Symptoms\",\n    color = \"Sex\"\n  ) +\n  theme_classic()\n\n\n\nIndividuals’ Model-Implied Growth Curves of Depression Symptoms Overlaid With Prototypical Growth Curves By Sex"
  },
  {
    "objectID": "mixed-effects-models.html#fit-the-model-2",
    "href": "mixed-effects-models.html#fit-the-model-2",
    "title": "Mixed-Effects Models",
    "section": "\n6.1 Fit the Model",
    "text": "6.1 Fit the Model\n\nCodenum_cores &lt;- parallelly::availableCores() - 1\nnum_true_cores &lt;- parallelly::availableCores(logical = FALSE) - 1\n\n\nIn estimating generalized additive growth models of depression symptoms, this model includes:\n\nsex‐specific smooth functions of age, sex and sleep as fixed effects with their interaction, and\nsex‐specific smooth interactions between age and sleep, along with subject‐specific smooth deviations over age.\n\n\nCodegamGCM &lt;- mgcv::gam(\n  depression ~ sexFactor + sleep + sexFactor:sleep +\n    \n    # sex-specific trajectories\n    s(ageCentered, by = sexFactor, k = 4) +\n    \n    # sex-specific effects of sleep on trajectories\n    ti(ageCentered, sleep, by = sexFactor, k = 4) +\n    \n    # random effects\n    s(ageCentered, ID, bs = \"re\"),\n  data = mydata_long,\n  nthreads = num_cores)"
  },
  {
    "objectID": "mixed-effects-models.html#model-summary-2",
    "href": "mixed-effects-models.html#model-summary-2",
    "title": "Mixed-Effects Models",
    "section": "\n6.2 Model Summary",
    "text": "6.2 Model Summary\n\nCodesummary(gamGCM)\n\n\nFamily: gaussian \nLink function: identity \n\nFormula:\ndepression ~ sexFactor + sleep + sexFactor:sleep + s(ageCentered, \n    by = sexFactor, k = 4) + ti(ageCentered, sleep, by = sexFactor, \n    k = 4) + s(ageCentered, ID, bs = \"re\")\n\nParametric coefficients:\n                    Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)          27.9850     1.8289  15.302  &lt; 2e-16 ***\nsexFactormale       -10.0382     2.7564  -3.642 0.000286 ***\nsleep                -2.0100     0.2249  -8.936  &lt; 2e-16 ***\nsexFactormale:sleep   0.6835     0.3404   2.008 0.044976 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nApproximate significance of smooth terms:\n                                            edf Ref.df     F  p-value    \ns(ageCentered):sexFactorfemale        2.051e+00  2.432 9.575 2.65e-05 ***\ns(ageCentered):sexFactormale          1.658e+00  2.015 3.891   0.0209 *  \nti(ageCentered,sleep):sexFactorfemale 1.000e+00  1.000 1.881   0.1705    \nti(ageCentered,sleep):sexFactormale   1.000e+00  1.000 0.491   0.4835    \ns(ageCentered,ID)                     3.222e-08  1.000 0.000   0.9930    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nR-sq.(adj) =  0.226   Deviance explained = 23.3%\nGCV = 34.183  Scale est. = 33.826    n = 931\n\nCodeprint(effectsize::standardize_parameters(\n  gamGCM,\n  method = \"refit\"),\n  digits = 2)\n\n# Standardization method: refit\n\nComponent    |                                   Parameter | Std. Coef. |         95% CI\n----------------------------------------------------------------------------------------\nconditional  |                                 (Intercept) |       0.30 | [ 0.22,  0.37]\nconditional  |                               sexFactormale |      -0.69 | [-0.80, -0.57]\nconditional  |                                       sleep |      -0.34 | [-0.42, -0.27]\nconditional  |                       sexFactormale × sleep |       0.12 | [ 0.00,  0.23]\nsmooth_terms | Smooth term (ageCentered) × sexFactorfemale |            |               \nsmooth_terms |   Smooth term (ageCentered) × sexFactormale |            |               \nsmooth_terms |     ti(ageCentered,sleep) × sexFactorfemale |            |               \nsmooth_terms |       ti(ageCentered,sleep) × sexFactormale |            |               \nsmooth_terms |                Smooth term (ageCentered,ID) |            |               \n\nCodeperformance::r2(gamGCM)\n\n$R2\nAdjusted R2 \n   0.225823"
  },
  {
    "objectID": "mixed-effects-models.html#plots-2",
    "href": "mixed-effects-models.html#plots-2",
    "title": "Mixed-Effects Models",
    "section": "\n6.3 Plots",
    "text": "6.3 Plots\n\n6.3.1 Prototypical Growth Curve\n\nCodenewData &lt;- expand.grid(\n  sexFactor = c(\"female\", \"male\"),\n  age = seq(\n    from = min(mydata_long$age, na.rm = TRUE),\n    to = max(mydata_long$age, na.rm = TRUE),\n    length.out = 10000\n  ),\n  sleep = mean(mydata_long$sleep, na.rm = TRUE)\n)\n\nnewData$ageCentered &lt;- newData$age - min(newData$age)\n#newData$ageCenteredSquared &lt;- newData$ageCentered ^ 2\n\n# add a dummy id\nnewData$ID &lt;- mydata_long$ID[1]\n\nnewData$modelImpliedDepression &lt;- predict( # predict.gam\n  gamGCM,\n  newdata = newData,\n  #re.form = NA # include no random effects\n)\n\nggplot(\n  data = newData,\n  mapping = aes(\n    x = age,\n    y = modelImpliedDepression,\n    color = sexFactor)) +\n  geom_line() +\n  labs(\n    x = \"Age (years)\",\n    y = \"Depression Symptoms\",\n    color = \"Sex\"\n  ) +\n  theme_classic()\n\n\n\nPrototypical Model-Implied Growth Curves of Depression Symptoms By Sex\n\n\n\n\n6.3.2 Individuals’ Growth Curves\n\nCodemydata_long$modelImpliedDepression &lt;- predict( # predict.gam\n  gamGCM,\n  newdata = mydata_long,\n  #re.form = NULL # include all random effects\n)\n\ngamMethod &lt;- function(formula, data, weights, ...) {\n  if(nrow(data) &gt;= 4){ # gam smooth if 4+ timepoints\n    mgcv::gam(y ~ s(x, bs = \"cs\", k = 3), data = data, ...)\n  } else if(nrow(data) == 3){  # quadratic smooth if 3 timepoints\n    lm(y ~ x + I(x^2), data = data, ...)\n  } else{ # linear if fewer than 3 timepoints\n    lm(y ~ x, data = data, ...)\n  }\n}\n\nggplot(\n  data = mydata_long,\n  mapping = aes(\n    x = age,\n    y = modelImpliedDepression,\n    group = ID,\n    color = sexFactor)) +\n  geom_smooth(\n    method = gamMethod,\n    se = FALSE,\n    linewidth = 0.5\n  ) +\n  labs(\n    x = \"Age (years)\",\n    y = \"Depression Symptoms\",\n    color = \"Sex\"\n  ) +\n  theme_classic()\n\n\n\nIndividuals’ Model-Implied Growth Curves of Depression Symptoms\n\n\n\n\n6.3.3 Individuals’ Trajectories Overlaid with Prototypical Trajectory\n\nCodeggplot(\n  data = mydata_long,\n  mapping = aes(\n    x = age,\n    y = modelImpliedDepression,\n    group = ID)) +\n  geom_smooth(\n    method = gamMethod,\n    se = FALSE,\n    linewidth = 0.5,\n    color = \"gray\",\n    alpha = 0.30\n  ) +\n  geom_line(\n    data = newData,\n    mapping = aes(\n      x = age,\n      y = modelImpliedDepression,\n      group = sexFactor,\n      color = sexFactor),\n    linewidth = 2) +\n  labs(\n    x = \"Age (years)\",\n    y = \"Depression Symptoms\",\n    color = \"Sex\"\n  ) +\n  theme_classic()\n\n\n\nIndividuals’ Model-Implied Growth Curves of Depression Symptoms Overlaid With Prototypical Growth Curves By Sex"
  },
  {
    "objectID": "mixed-effects-models.html#pre-model-computations",
    "href": "mixed-effects-models.html#pre-model-computations",
    "title": "Mixed-Effects Models",
    "section": "\n8.1 Pre-Model Computations",
    "text": "8.1 Pre-Model Computations\n\nCodemydata_long &lt;- mydata_long |&gt;\n  group_by(ID) |&gt;\n  mutate(\n    sleep_personMean = mean(sleep, na.rm = TRUE),\n    sleep_personMeanCentered= sleep - sleep_personMean\n  ) |&gt;\n  ungroup()"
  },
  {
    "objectID": "mixed-effects-models.html#fit-the-model-3",
    "href": "mixed-effects-models.html#fit-the-model-3",
    "title": "Mixed-Effects Models",
    "section": "\n8.2 Fit the Model",
    "text": "8.2 Fit the Model\nIn disaggregating within- and between-person effects, this model fits:\n\nrandom intercepts and random linear and quadratic slopes for subjects,\n\nsex and sleep_personMean as time-invariant fixed-effect predictors of the intercepts and slopes, and\n\nsleep_personMeanCentered as a time-varying fixed-effect predictor of depression, with effects allowed to vary over age and by sex, including two‐ and three‐way interactions with age and sex.\n\nThe * symbol (unlike the : symbol) estimates all lower-order main effects and interactions, to simplify the syntax.\n\nCodewithinBetweenPersonSleepModel &lt;- lmerTest::lmer(\n  depression ~ sexFactor*sleep_personMean*ageCentered + \n    sexFactor*sleep_personMean*ageCenteredSquared + \n    sexFactor*sleep_personMeanCentered*ageCentered + \n    sexFactor*sleep_personMeanCentered*ageCenteredSquared + \n    (1 + ageCentered + ageCenteredSquared | ID),\n  data = mydata_long,\n  na.action = na.exclude)"
  },
  {
    "objectID": "mixed-effects-models.html#model-summary-3",
    "href": "mixed-effects-models.html#model-summary-3",
    "title": "Mixed-Effects Models",
    "section": "\n8.3 Model Summary",
    "text": "8.3 Model Summary\n\nCodesummary(withinBetweenPersonSleepModel)\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: depression ~ sexFactor * sleep_personMean * ageCentered + sexFactor *  \n    sleep_personMean * ageCenteredSquared + sexFactor * sleep_personMeanCentered *  \n    ageCentered + sexFactor * sleep_personMeanCentered * ageCenteredSquared +  \n    (1 + ageCentered + ageCenteredSquared | ID)\n   Data: mydata_long\n\nREML criterion at convergence: 4593.5\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-2.9224 -0.3542 -0.0345  0.3176  3.5765 \n\nRandom effects:\n Groups   Name               Variance Std.Dev. Corr       \n ID       (Intercept)        14.6480  3.8273              \n          ageCentered         5.0299  2.2427    0.32      \n          ageCenteredSquared  0.3916  0.6258    0.04 -0.71\n Residual                     1.4732  1.2138              \nNumber of obs: 931, groups:  ID, 250\n\nFixed effects:\n                                                           Estimate Std. Error\n(Intercept)                                                24.04682    2.82258\nsexFactormale                                              -5.05267    4.27150\nsleep_personMean                                           -1.60777    0.34802\nageCentered                                                 6.34417    2.13527\nageCenteredSquared                                         -0.70234    0.65198\nsleep_personMeanCentered                                   -1.10082    0.29787\nsexFactormale:sleep_personMean                              0.33831    0.52879\nsexFactormale:ageCentered                                  -9.59246    3.24080\nsleep_personMean:ageCentered                               -0.89895    0.26358\nsexFactormale:ageCenteredSquared                            2.43792    0.99719\nsleep_personMean:ageCenteredSquared                         0.16463    0.08044\nsexFactormale:sleep_personMeanCentered                     -0.06942    0.42711\nageCentered:sleep_personMeanCentered                        0.88374    0.49782\nageCenteredSquared:sleep_personMeanCentered                -0.33969    0.16689\nsexFactormale:sleep_personMean:ageCentered                  0.98749    0.40143\nsexFactormale:sleep_personMean:ageCenteredSquared          -0.30171    0.12357\nsexFactormale:ageCentered:sleep_personMeanCentered         -0.35194    0.69610\nsexFactormale:ageCenteredSquared:sleep_personMeanCentered   0.22936    0.23529\n                                                                 df t value\n(Intercept)                                               245.15779   8.519\nsexFactormale                                             245.34643  -1.183\nsleep_personMean                                          245.20907  -4.620\nageCentered                                               247.33344   2.971\nageCenteredSquared                                        233.40440  -1.077\nsleep_personMeanCentered                                  362.37803  -3.696\nsexFactormale:sleep_personMean                            245.25980   0.640\nsexFactormale:ageCentered                                 252.86616  -2.960\nsleep_personMean:ageCentered                              247.46354  -3.411\nsexFactormale:ageCenteredSquared                          242.11830   2.445\nsleep_personMean:ageCenteredSquared                       233.29646   2.047\nsexFactormale:sleep_personMeanCentered                    362.72162  -0.163\nageCentered:sleep_personMeanCentered                      492.65593   1.775\nageCenteredSquared:sleep_personMeanCentered               499.73866  -2.035\nsexFactormale:sleep_personMean:ageCentered                253.00609   2.460\nsexFactormale:sleep_personMean:ageCenteredSquared         242.33962  -2.442\nsexFactormale:ageCentered:sleep_personMeanCentered        492.21316  -0.506\nsexFactormale:ageCenteredSquared:sleep_personMeanCentered 493.62742   0.975\n                                                          Pr(&gt;|t|)    \n(Intercept)                                               1.65e-15 ***\nsexFactormale                                             0.238002    \nsleep_personMean                                          6.21e-06 ***\nageCentered                                               0.003259 ** \nageCenteredSquared                                        0.282486    \nsleep_personMeanCentered                                  0.000253 ***\nsexFactormale:sleep_personMean                            0.522916    \nsexFactormale:ageCentered                                 0.003370 ** \nsleep_personMean:ageCentered                              0.000757 ***\nsexFactormale:ageCenteredSquared                          0.015208 *  \nsleep_personMean:ageCenteredSquared                       0.041815 *  \nsexFactormale:sleep_personMeanCentered                    0.870985    \nageCentered:sleep_personMeanCentered                      0.076479 .  \nageCenteredSquared:sleep_personMeanCentered               0.042338 *  \nsexFactormale:sleep_personMean:ageCentered                0.014565 *  \nsexFactormale:sleep_personMean:ageCenteredSquared         0.015337 *  \nsexFactormale:ageCentered:sleep_personMeanCentered        0.613367    \nsexFactormale:ageCenteredSquared:sleep_personMeanCentered 0.330156    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCodeprint(effectsize::standardize_parameters(\n  withinBetweenPersonSleepModel,\n  method = \"refit\"),\n  digits = 2)\n\n# Standardization method: refit\n\nParameter                                                          | Std. Coef. |         95% CI\n------------------------------------------------------------------------------------------------\n(Intercept)                                                        |       0.31 | [ 0.18,  0.45]\nsexFactor [male]                                                   |      -0.71 | [-0.91, -0.50]\nsleep personMean                                                   |      -0.34 | [-0.48, -0.21]\nageCentered                                                        |      -0.15 | [-0.23, -0.06]\nageCenteredSquared                                                 |       0.32 | [ 0.24,  0.40]\nsleep personMeanCentered                                           |      -0.09 | [-0.11, -0.06]\nsexFactor [male] × sleep personMean                                |       0.11 | [-0.09,  0.31]\nsexFactor [male] × ageCentered                                     |      -0.28 | [-0.41, -0.15]\nsleep personMean × ageCentered                                     |      -0.15 | [-0.23, -0.06]\nsexFactor [male] × ageCenteredSquared                              |   8.67e-03 | [-0.11,  0.13]\nsleep personMean × ageCenteredSquared                              |       0.08 | [ 0.00,  0.16]\nsexFactor [male] × sleep personMeanCentered                        |       0.02 | [-0.02,  0.05]\nageCentered × sleep personMeanCentered                             |       0.09 | [-0.01,  0.19]\nageCenteredSquared × sleep personMeanCentered                      |      -0.11 | [-0.21,  0.00]\n(sexFactor [male] × sleep personMean) × ageCentered                |       0.16 | [ 0.03,  0.29]\n(sexFactor [male] × sleep personMean) × ageCenteredSquared         |      -0.15 | [-0.27, -0.03]\n(sexFactor [male] × ageCentered) × sleep personMeanCentered        |      -0.04 | [-0.17,  0.10]\n(sexFactor [male] × ageCenteredSquared) × sleep personMeanCentered |       0.07 | [-0.07,  0.21]\n\nCodeperformance::r2(withinBetweenPersonSleepModel)\n\n# R2 for Mixed Models\n\n  Conditional R2: 0.967\n     Marginal R2: 0.246"
  },
  {
    "objectID": "mixed-effects-models.html#plots-3",
    "href": "mixed-effects-models.html#plots-3",
    "title": "Mixed-Effects Models",
    "section": "\n8.4 Plots",
    "text": "8.4 Plots\n\n8.4.1 Between-Person Effect of Sleep\n\nCodenewData &lt;- expand.grid(\n  sexFactor = c(\"female\", \"male\"),\n  age = seq(\n    from = min(mydata_long$age, na.rm = TRUE),\n    to = max(mydata_long$age, na.rm = TRUE),\n    length.out = 10000\n  ),\n  sleepFactor = c(\"low sleep\", \"high sleep\")\n)\n\nnewData$ageCentered &lt;- newData$age - min(newData$age)\nnewData$ageCenteredSquared &lt;- newData$ageCentered ^ 2\n\nnewData$sleep_personMean &lt;- NA\nnewData$sleep_personMean[which(newData$sleepFactor == \"low sleep\" & newData$sexFactor == \"female\")] &lt;- mean(mydata_long$sleep_personMean[which(mydata_long$sexFactor == \"female\")], na.rm = TRUE) - sd(mydata_long$sleep_personMean[which(mydata_long$sexFactor == \"female\")], na.rm = TRUE)\n\nnewData$sleep_personMean[which(newData$sleepFactor == \"low sleep\" & newData$sexFactor == \"male\")] &lt;- mean(mydata_long$sleep_personMean[which(mydata_long$sexFactor == \"male\")], na.rm = TRUE) - sd(mydata_long$sleep_personMean[which(mydata_long$sexFactor == \"male\")], na.rm = TRUE)\n\nnewData$sleep_personMean[which(newData$sleepFactor == \"high sleep\" & newData$sexFactor == \"female\")] &lt;- mean(mydata_long$sleep_personMean[which(mydata_long$sexFactor == \"female\")], na.rm = TRUE) + sd(mydata_long$sleep_personMean[which(mydata_long$sexFactor == \"female\")], na.rm = TRUE)\n\nnewData$sleep_personMean[which(newData$sleepFactor == \"high sleep\" & newData$sexFactor == \"male\")] &lt;- mean(mydata_long$sleep_personMean[which(mydata_long$sexFactor == \"male\")], na.rm = TRUE) + sd(mydata_long$sleep_personMean[which(mydata_long$sexFactor == \"male\")], na.rm = TRUE)\n\nnewData$sleep_personMeanCentered &lt;- 0\n\nnewData$modelImpliedDepression &lt;- predict( # predict.merMod\n  withinBetweenPersonSleepModel,\n  newdata = newData,\n  re.form = NA # include no random effects\n)\n\nggplot(\n  data = newData,\n  mapping = aes(\n    x = age,\n    y = modelImpliedDepression,\n    color = sexFactor,\n    linetype = sleepFactor)) +\n  geom_line() +\n  labs(\n    x = \"Age (years)\",\n    y = \"Depression Symptoms\",\n    color = \"Sex\",\n    linetype = \"Sleep\"\n  ) +\n  \n  theme_classic()\n\n\n\nBetween-Person Association Between Sleep and Depression\n\n\n\n\n8.4.2 Within-Person Effect of Sleep\n\nCodenewData &lt;- expand.grid(\n  sexFactor = c(\"female\", \"male\"),\n  age = seq(\n    from = min(mydata_long$age, na.rm = TRUE),\n    to = max(mydata_long$age, na.rm = TRUE),\n    length.out = 10000\n  ),\n  sleepFactor = c(\"low sleep\", \"high sleep\")\n)\n\nnewData$ageCentered &lt;- newData$age - min(newData$age)\nnewData$ageCenteredSquared &lt;- newData$ageCentered ^ 2\n\nnewData$sleep_personMean &lt;- mean(mydata_long$sleep_personMean, na.rm = TRUE)\n\nnewData$sleep_personMeanCentered &lt;- NA\nnewData$sleep_personMeanCentered[which(newData$sleepFactor == \"low sleep\" & newData$sexFactor == \"female\")] &lt;- mean(mydata_long$sleep_personMeanCentered[which(mydata_long$sexFactor == \"female\")], na.rm = TRUE) - sd(mydata_long$sleep_personMeanCentered[which(mydata_long$sexFactor == \"female\")], na.rm = TRUE)\n\nnewData$sleep_personMeanCentered[which(newData$sleepFactor == \"low sleep\" & newData$sexFactor == \"male\")] &lt;- mean(mydata_long$sleep_personMeanCentered[which(mydata_long$sexFactor == \"male\")], na.rm = TRUE) - sd(mydata_long$sleep_personMeanCentered[which(mydata_long$sexFactor == \"male\")], na.rm = TRUE)\n\nnewData$sleep_personMeanCentered[which(newData$sleepFactor == \"high sleep\" & newData$sexFactor == \"female\")] &lt;- mean(mydata_long$sleep_personMeanCentered[which(mydata_long$sexFactor == \"female\")], na.rm = TRUE) + sd(mydata_long$sleep_personMeanCentered[which(mydata_long$sexFactor == \"female\")], na.rm = TRUE)\n\nnewData$sleep_personMeanCentered[which(newData$sleepFactor == \"high sleep\" & newData$sexFactor == \"male\")] &lt;- mean(mydata_long$sleep_personMeanCentered[which(mydata_long$sexFactor == \"male\")], na.rm = TRUE) + sd(mydata_long$sleep_personMeanCentered[which(mydata_long$sexFactor == \"male\")], na.rm = TRUE)\n\nnewData$modelImpliedDepression &lt;- predict( # predict.merMod\n  withinBetweenPersonSleepModel,\n  newdata = newData,\n  re.form = NA # include no random effects\n)\n\nggplot(\n  data = newData,\n  mapping = aes(\n    x = age,\n    y = modelImpliedDepression,\n    color = sexFactor,\n    linetype = sleepFactor)) +\n  geom_line() +\n  labs(\n    x = \"Age (years)\",\n    y = \"Depression Symptoms\",\n    color = \"Sex\",\n    linetype = \"Sleep\"\n  ) +\n  \n  theme_classic()\n\n\n\nWithin-Person Association Between Sleep and Depression"
  },
  {
    "objectID": "data-manipulation.html",
    "href": "data-manipulation.html",
    "title": "Data Manipulation of Longitudinal Data",
    "section": "",
    "text": "Codelibrary(\"tidyverse\")\n\n\n\nFirst, let’s generate some example data.\n\nCodeset.seed(52242) # for a reproducible result\n\nexampleData_long &lt;- expand.grid(\n  ID = 1001:1003,\n  timepoint = 1:4\n)\n\nexampleData_long$score &lt;- sample(\n  x = 50:100,\n  size = nrow(exampleData_long),\n  replace = TRUE\n)\n\n\nThe data are in long form—each participant (identified by ID) has multiple rows (i.e., each row is uniquely identified by the combination of ID and timepoint; thus, we would say the data are in ID–timepoint form):\n\nCodeexampleData_long"
  },
  {
    "objectID": "data-manipulation.html#load-libraries",
    "href": "data-manipulation.html#load-libraries",
    "title": "Data Manipulation of Longitudinal Data",
    "section": "",
    "text": "Codelibrary(\"tidyverse\")"
  },
  {
    "objectID": "data-manipulation.html#simulate-data",
    "href": "data-manipulation.html#simulate-data",
    "title": "Data Manipulation of Longitudinal Data",
    "section": "",
    "text": "First, let’s generate some example data.\n\nCodeset.seed(52242) # for a reproducible result\n\nexampleData_long &lt;- expand.grid(\n  ID = 1001:1003,\n  timepoint = 1:4\n)\n\nexampleData_long$score &lt;- sample(\n  x = 50:100,\n  size = nrow(exampleData_long),\n  replace = TRUE\n)\n\n\nThe data are in long form—each participant (identified by ID) has multiple rows (i.e., each row is uniquely identified by the combination of ID and timepoint; thus, we would say the data are in ID–timepoint form):\n\nCodeexampleData_long"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "2026 CSSI Workshop on Longitudinal Data Analysis",
    "section": "",
    "text": "This is the website for the 2026 Center for Social Science Innovation (CSSI) Workshop on Longitudinal Data Analysis led by Isaac T. Petersen. Isaac Petersen is an Associate Professor in the Department of Psychological and Brain Sciences at the University of Iowa.\nThis workshop provides an applied overview of principles and methods for longitudinal data analysis, with hands-on examples in R. Topics include types of longitudinal data, data manipulation and visualization, statistical methods for longitudinal analysis (including mixed-effects models and structural equation models), longitudinal measurement invariance, handling missing data, and separating within-person and between-person effects. Participants are encouraged to bring a laptop with R and RStudio installed for interactive exercises. This workshop is intended for participants with experience using R and RStudio. Prior experience with longitudinal data analysis, though helpful, is not required.\n\n\n\n\n\nReuseCC BY 4.0"
  },
  {
    "objectID": "data-visualization.html",
    "href": "data-visualization.html",
    "title": "Visualization of Longitudinal Data",
    "section": "",
    "text": "Codelibrary(\"tidyverse\")\n\n\n\nThe data for this example were simulated:\n\nCodemydata_long &lt;- read.csv(\"./data/mydata_long.csv\")"
  },
  {
    "objectID": "data-visualization.html#load-libraries",
    "href": "data-visualization.html#load-libraries",
    "title": "Visualization of Longitudinal Data",
    "section": "",
    "text": "Codelibrary(\"tidyverse\")"
  },
  {
    "objectID": "data-visualization.html#load-data",
    "href": "data-visualization.html#load-data",
    "title": "Visualization of Longitudinal Data",
    "section": "",
    "text": "The data for this example were simulated:\n\nCodemydata_long &lt;- read.csv(\"./data/mydata_long.csv\")"
  },
  {
    "objectID": "data-visualization.html#observed-growth-curves",
    "href": "data-visualization.html#observed-growth-curves",
    "title": "Visualization of Longitudinal Data",
    "section": "\n3.1 Observed Growth Curves",
    "text": "3.1 Observed Growth Curves\n\nCodeggplot(\n  data = mydata_long,\n  mapping = aes(\n    x = age,\n    y = depression,\n    group = ID)) +\n  geom_line(\n    alpha = 0.25\n  ) +\n  labs(\n    x = \"Age (Years)\",\n    y = \"Depression Symptoms\"\n  ) +\n  theme_classic()\n\n\n\nObserved Growth Curves of Depression Symptoms\n\n\n\n\nCodeggplot(\n  data = mydata_long,\n  mapping = aes(\n    x = age,\n    y = anxiety,\n    group = ID)) +\n  geom_line(\n    alpha = 0.25\n  ) +\n  labs(\n    x = \"Age (Years)\",\n    y = \"Anxiety Symptoms\"\n  ) +\n  theme_classic()\n\n\n\nObserved Growth Curves of Anxiety Symptoms"
  },
  {
    "objectID": "data-visualization.html#overlaid-with-means-by-sex",
    "href": "data-visualization.html#overlaid-with-means-by-sex",
    "title": "Visualization of Longitudinal Data",
    "section": "\n3.2 Overlaid with Means by Sex",
    "text": "3.2 Overlaid with Means by Sex\n\nCodeggplot(\n  data = mydata_long,\n  mapping = aes(\n    x = age,\n    y = depression,\n    group = ID)) +\n  geom_line(\n    alpha = 0.25\n  ) +\n  geom_line(\n    mapping = aes(\n      x = age,\n      y = depression,\n      color = sexFactor,\n      group = sexFactor,\n    ),\n    data = mydata_long_summary,\n    linewidth = 2\n  ) +\n  labs(\n    x = \"Age (Years)\",\n    y = \"Depression Symptoms\",\n    color = \"Sex\"\n  ) +\n  theme_classic()\n\n\n\nObserved Growth Curves of Depression Symptoms Overlaid with Means by Sex\n\n\n\n\nCodeggplot(\n  data = mydata_long,\n  mapping = aes(\n    x = age,\n    y = anxiety,\n    group = ID)) +\n  geom_line(\n    alpha = 0.25\n  ) +\n  geom_line(\n    mapping = aes(\n      x = age,\n      y = anxiety,\n      color = sexFactor,\n      group = sexFactor,\n    ),\n    data = mydata_long_summary,\n    linewidth = 2\n  ) +\n  labs(\n    x = \"Age (Years)\",\n    y = \"Anxiety Symptoms\",\n    color = \"Sex\"\n  ) +\n  theme_classic()\n\n\n\nObserved Growth Curves of Anxiety Symptoms Overlaid with Means by Sex"
  },
  {
    "objectID": "data-visualization.html#faceted-plots-of-a-random-subsample",
    "href": "data-visualization.html#faceted-plots-of-a-random-subsample",
    "title": "Visualization of Longitudinal Data",
    "section": "\n3.3 Faceted Plots of a Random Subsample",
    "text": "3.3 Faceted Plots of a Random Subsample\n\nCodeset.seed(52242) # for reproducibility\n\nrandom_n &lt;- 12\n\nids_subset &lt;- sample(\n  x = mydata_long$ID,\n  size = random_n,\n  replace = FALSE\n)\n\nmydata_long |&gt;\n  filter(ID %in% ids_subset) |&gt;\n  ggplot(\n    aes(\n      x = age,\n      y = depression,\n      group = ID\n    )\n  ) +\n  geom_point() +\n  geom_smooth(\n    method = \"lm\"\n  ) +\n  coord_cartesian(\n    ylim = c(0, max(mydata_long$depression, na.rm = TRUE))) +\n  facet_wrap(\n    ~ ID) +\n  labs(\n    x = \"Age (Years)\",\n    y = \"Depression Symptoms\"\n  ) +\n  theme_classic()\n\n\n\nFaceted Plot of Observed Growth Curves of Depression Symptoms for a Random Subsample of Individuals\n\n\n\n\nCodemydata_long |&gt;\n  filter(ID %in% ids_subset) |&gt;\n  ggplot(\n    aes(\n      x = age,\n      y = anxiety,\n      group = ID\n    )\n  ) +\n  geom_point() +\n  geom_smooth(\n    method = \"lm\"\n  ) +\n  coord_cartesian(\n    ylim = c(0, max(mydata_long$anxiety, na.rm = TRUE))) +\n  facet_wrap(\n    ~ ID\n  ) +\n  labs(\n    x = \"Age (Years)\",\n    y = \"Anxiety Symptoms\"\n  ) +\n  theme_classic()\n\n\n\nFaceted Plot of Observed Growth Curves of Anxiety Symptoms for a Random Subsample of Individuals"
  },
  {
    "objectID": "answers.html",
    "href": "answers.html",
    "title": "Answers",
    "section": "",
    "text": "Which level of longitudinal measurement invariance holds for the Bliese-Ployhard-2000-indicators-1.csv dataset (saved in object longitudinalMI1)?\n\nAnswer: residual (strict factorial) invariance\n\nRepeat the tests of longitudinal measurement invariance for the remaining datasets: Bliese-Ployhard-2000-indicators-2.csv, Bliese-Ployhard-2000-indicators-3.csv, and Bliese-Ployhard-2000-indicators-4.csv. Which level of longitudinal measurement invariance holds for each dataset?\n\nAnswer:\n\nBliese-Ployhard-2000-indicators-2.csv: scalar (strong factorial) invariance\nBliese-Ployhard-2000-indicators-3.csv: configural invariance\nBliese-Ployhard-2000-indicators-4.csv: metric (weak factorial) invariance\n\n\n\n\n\n\nReuseCC BY 4.0"
  },
  {
    "objectID": "missing-data.html",
    "href": "missing-data.html",
    "title": "Missing Data",
    "section": "",
    "text": "Codelibrary(\"mice\")\nlibrary(\"miceadds\")\nlibrary(\"micemd\")\nlibrary(\"lme4\")\nlibrary(\"lmerTest\")\nlibrary(\"broom.mixed\")\nlibrary(\"lavaan\")\nlibrary(\"lavaan.mi\")\nlibrary(\"psych\")\nlibrary(\"parallelly\")\nlibrary(\"furrr\")\nlibrary(\"tidyverse\")\n\n\n\nThe data for this example were simulated:\n\nCodemydata_long &lt;- read.csv(\"./data/mydata_long.csv\")"
  },
  {
    "objectID": "missing-data.html#load-libraries",
    "href": "missing-data.html#load-libraries",
    "title": "Missing Data",
    "section": "",
    "text": "Codelibrary(\"mice\")\nlibrary(\"miceadds\")\nlibrary(\"micemd\")\nlibrary(\"lme4\")\nlibrary(\"lmerTest\")\nlibrary(\"broom.mixed\")\nlibrary(\"lavaan\")\nlibrary(\"lavaan.mi\")\nlibrary(\"psych\")\nlibrary(\"parallelly\")\nlibrary(\"furrr\")\nlibrary(\"tidyverse\")"
  },
  {
    "objectID": "missing-data.html#load-data",
    "href": "missing-data.html#load-data",
    "title": "Missing Data",
    "section": "",
    "text": "The data for this example were simulated:\n\nCodemydata_long &lt;- read.csv(\"./data/mydata_long.csv\")"
  },
  {
    "objectID": "missing-data.html#describe-missing-data",
    "href": "missing-data.html#describe-missing-data",
    "title": "Missing Data",
    "section": "\n3.1 Describe Missing Data",
    "text": "3.1 Describe Missing Data\n\nCodepsych::describe(mydata_long)\n\n\n\n\n\n  \n\n\n\n\nCodemice::md.pattern(mydata_long, rotate.names = TRUE)\n\n\n\n\n\n\n\n    ID timepoint age sex sexMale sexEffectCode ses sleep depression anxiety    \n931  1         1   1   1       1             1   1     1          1       1   0\n69   1         1   1   1       1             1   0     0          0       0   4\n     0         0   0   0       0             0  69    69         69      69 276"
  },
  {
    "objectID": "missing-data.html#pre-imputation-setup",
    "href": "missing-data.html#pre-imputation-setup",
    "title": "Missing Data",
    "section": "\n3.2 Pre-Imputation Setup",
    "text": "3.2 Pre-Imputation Setup\n\n3.2.1 Specify Variables to Impute\n\nCodevarsToImpute &lt;- c(\"ses\",\"sleep\",\"depression\",\"anxiety\")\nY &lt;- varsToImpute\n\n\n\n3.2.2 Specify Number of Imputations\n\nCodenumImputations &lt;- 5 # generally use 100 imputations; this example uses 5 for speed\n\n\n\n3.2.3 Detect Cores\n\nCodenum_cores &lt;- parallelly::availableCores() - 1\nnum_true_cores &lt;- parallelly::availableCores(logical = FALSE) - 1\n\n\n\n3.2.4 Specifying the Imputation Method\nYou can specify any of various methods to impute each variable. In this case, we use a multilevel imputation (to account for longitudinal data) form of predictive mean matching (2l.pmm from the miceadds package).\n\nCodeimputationMethods &lt;- mice::make.method(mydata_long)\nimputationMethods[1:length(imputationMethods)] &lt;- \"\"\nimputationMethods[Y] &lt;- \"2l.pmm\" # specify the imputation method here; this can differ by outcome variable\nimputationMethods\n\n           ID     timepoint           age           sex       sexMale \n           \"\"            \"\"            \"\"            \"\"            \"\" \nsexEffectCode           ses         sleep    depression       anxiety \n           \"\"      \"2l.pmm\"      \"2l.pmm\"      \"2l.pmm\"      \"2l.pmm\" \n\n\n\n3.2.5 Specifying the Predictor Matrix\nA predictor matrix is a matrix of values, where:\n\ncolumns with non-zero values are predictors of the variable specified in the given row\nthe diagonal of the predictor matrix should be zero because a variable cannot predict itself\n\nThe values are:\n\nNOT a predictor of the outcome: 0\n\ncluster variable: -2\n\nfixed effect of predictor: 1\n\nfixed effect and random effect of predictor: 2\n\ninclude cluster mean of predictor in addition to fixed effect of predictor: 3\n\ninclude cluster mean of predictor in addition to fixed effect and random effect of predictor: 4\n\n\n\nCodepredictorMatrix &lt;- mice::make.predictorMatrix(mydata_long)\npredictorMatrix[1:nrow(predictorMatrix), 1:ncol(predictorMatrix)] &lt;- 0 # make everything zero by default to manually specify all predictors used for imputation\npredictorMatrix[Y, \"ID\"] &lt;- (-2) # cluster variable\npredictorMatrix[Y, \"age\"] &lt;- 2 # random effect predictor\npredictorMatrix[Y, \"sexMale\"] &lt;- 1 # fixed effect predictor\npredictorMatrix[Y, Y] &lt;- 1 # fixed effect predictor; make sure all predictors predict each other\n\ndiag(predictorMatrix) &lt;- 0 # don't have a variable predicting itself\npredictorMatrix\n\n              ID timepoint age sex sexMale sexEffectCode ses sleep depression\nID             0         0   0   0       0             0   0     0          0\ntimepoint      0         0   0   0       0             0   0     0          0\nage            0         0   0   0       0             0   0     0          0\nsex            0         0   0   0       0             0   0     0          0\nsexMale        0         0   0   0       0             0   0     0          0\nsexEffectCode  0         0   0   0       0             0   0     0          0\nses           -2         0   2   0       1             0   0     1          1\nsleep         -2         0   2   0       1             0   1     0          1\ndepression    -2         0   2   0       1             0   1     1          0\nanxiety       -2         0   2   0       1             0   1     1          1\n              anxiety\nID                  0\ntimepoint           0\nage                 0\nsex                 0\nsexMale             0\nsexEffectCode       0\nses                 1\nsleep               1\ndepression          1\nanxiety             0"
  },
  {
    "objectID": "missing-data.html#run-imputation",
    "href": "missing-data.html#run-imputation",
    "title": "Missing Data",
    "section": "\n3.3 Run Imputation",
    "text": "3.3 Run Imputation\n\n3.3.1 Sequential Processing\n\nCodemi_mice &lt;- mice::mice(\n  as.data.frame(mydata_long),\n  method = imputationMethods,\n  predictorMatrix = predictorMatrix,\n  m = numImputations,\n  maxit = 5, # generally use 100 maximum iterations; this example uses 5 for speed\n  seed = 52242)\n\n\n iter imp variable\n  1   1  ses  sleep  depression  anxiety\n  1   2  ses  sleep  depression  anxiety\n  1   3  ses  sleep  depression  anxiety\n  1   4  ses  sleep  depression  anxiety\n  1   5  ses  sleep  depression  anxiety\n  2   1  ses  sleep  depression  anxiety\n  2   2  ses  sleep  depression  anxiety\n  2   3  ses  sleep  depression  anxiety\n  2   4  ses  sleep  depression  anxiety\n  2   5  ses  sleep  depression  anxiety\n  3   1  ses  sleep  depression  anxiety\n  3   2  ses  sleep  depression  anxiety\n  3   3  ses  sleep  depression  anxiety\n  3   4  ses  sleep  depression  anxiety\n  3   5  ses  sleep  depression  anxiety\n  4   1  ses  sleep  depression  anxiety\n  4   2  ses  sleep  depression  anxiety\n  4   3  ses  sleep  depression  anxiety\n  4   4  ses  sleep  depression  anxiety\n  4   5  ses  sleep  depression  anxiety\n  5   1  ses  sleep  depression  anxiety\n  5   2  ses  sleep  depression  anxiety\n  5   3  ses  sleep  depression  anxiety\n  5   4  ses  sleep  depression  anxiety\n  5   5  ses  sleep  depression  anxiety\n\n\n\n3.3.2 Parallel Processing\n\nCodemi_parallel_mice &lt;- mice::futuremice(\n  as.data.frame(mydata_long),\n  method = imputationMethods,\n  predictorMatrix = predictorMatrix,\n  m = numImputations,\n  maxit = 5, # generally use 100 maximum iterations; this example uses 5 for speed\n  parallelseed = 52242,\n  n.core = num_cores,\n  packages = \"miceadds\")"
  },
  {
    "objectID": "missing-data.html#imputation-diagnostics",
    "href": "missing-data.html#imputation-diagnostics",
    "title": "Missing Data",
    "section": "\n3.4 Imputation Diagnostics",
    "text": "3.4 Imputation Diagnostics\n\n3.4.1 Logged Events\n\nCodemi_mice$loggedEvents\n\nNULL\n\n\n\n3.4.2 Trace Plots\nOn convergence, the streams of the trace plots should intermingle and be free of any trend (at the later iterations). Convergence is diagnosed when the variance between different sequences is no larger than the variance within each individual sequence.\nhttps://stefvanbuuren.name/fimd/sec-algoptions.html (archived at https://perma.cc/4S54-465R)\n\nCodeplot(mi_mice)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n3.4.3 Density Plots\n\nCodemice::densityplot(mi_mice)\n\n\n\n\n\n\n\n\n3.4.4 Strip Plots\n\nCodemice::stripplot(mi_mice)\n\n\n\n\n\n\nCodemice::stripplot(mi_mice, depression ~ .imp)"
  },
  {
    "objectID": "missing-data.html#post-processing",
    "href": "missing-data.html#post-processing",
    "title": "Missing Data",
    "section": "\n3.5 Post-Processing",
    "text": "3.5 Post-Processing\n\n3.5.1 Modify/Create New Variables\n\nCodemi_mice_long &lt;- mice::complete( # return the completed (imputed) data\n  mi_mice,\n  action = \"long\",\n  include = TRUE)\n\nmi_mice_long &lt;- mi_mice_long |&gt; # long form for mixed-effects modeling\n  group_by(ID, .imp) |&gt;\n  mutate(\n    sexFactor = factor(sex),\n    ageCentered = age - min(age, na.rm = TRUE),\n    ageCenteredSquared = ageCentered ^ 2,\n    ses_personMean = mean(ses, na.rm = TRUE),\n    ses_personMeanCentered = ses - ses_personMean,\n    sleep_personMean = mean(sleep, na.rm = TRUE),\n    sleep_personMeanCentered = sleep - sleep_personMean,\n    depression_personMean = mean(depression, na.rm = TRUE),\n    depression_personMeanCentered = depression - depression_personMean,\n    anxiety_personMean = mean(anxiety, na.rm = TRUE),\n    anxiety_personMeanCentered = anxiety - anxiety_personMean,\n  ) |&gt;\n  ungroup()\n\nmi_mice_wide &lt;- mi_mice_long |&gt; # wide form for structural equation modeling: widen by time\n  select(-.id, -age, -ageCentered, -ageCenteredSquared) |&gt; # drop time-varying variables\n  tidyr::pivot_wider(\n    names_from  = timepoint,\n    values_from = c(ses, ses_personMeanCentered, sleep, sleep_personMeanCentered, depression, depression_personMeanCentered, anxiety, anxiety_personMeanCentered)\n  )\n\n\n\n3.5.2 Convert to mids object\n\nCodemi_mice_long_mids &lt;- mice::as.mids(mi_mice_long)\n\nmi_mice_wide_mids &lt;- mice::as.mids(mi_mice_wide)"
  },
  {
    "objectID": "missing-data.html#fit-models-to-multiple-imputed-data",
    "href": "missing-data.html#fit-models-to-multiple-imputed-data",
    "title": "Missing Data",
    "section": "\n3.6 Fit Models to Multiple Imputed Data",
    "text": "3.6 Fit Models to Multiple Imputed Data\n\n3.6.1 Mixed-Effects Models\n\n3.6.1.1 Fit Model\n\nCodelinearGCM_mice &lt;- with(\n  data = mi_mice_long_mids,\n  expr = lmerTest::lmer(\n    formula = depression ~ sexFactor + ageCentered + sexFactor:ageCentered + \n      sleep + sleep:ageCentered + sexFactor:sleep + sexFactor:sleep:ageCentered + \n      (1 + ageCentered | ID), # random intercepts and slopes; sex as a fixed-effect predictor of the intercepts and slopes\n  )\n)\n\n\n\n3.6.1.2 Model Summary\n\nCodelinearGCM_mice\n\ncall :\nwith.mids(data = mi_mice_long_mids, expr = lmerTest::lmer(formula = depression ~ \n    sexFactor + ageCentered + sexFactor:ageCentered + sleep + \n        sleep:ageCentered + sexFactor:sleep + sexFactor:sleep:ageCentered + \n        (1 + ageCentered | ID), ))\n\ncall1 :\nmice(data = data, m = m, where = where, maxit = 0, remove.collinear = FALSE, \n    allow.na = TRUE)\n\nnmis :\n [1]  0  0  0  0  0  0 69 69 69 69  0  0  0  0 69  0 69  0 69  0 69\n\nanalyses :\n[[1]]\nLinear mixed model fit by REML ['lmerModLmerTest']\nFormula: depression ~ sexFactor + ageCentered + sexFactor:ageCentered +  \n    sleep + sleep:ageCentered + sexFactor:sleep + sexFactor:sleep:ageCentered +  \n    (1 + ageCentered | ID)\nREML criterion at convergence: 5102.748\nRandom effects:\n Groups   Name        Std.Dev. Corr\n ID       (Intercept) 3.789        \n          ageCentered 1.499    0.57\n Residual             1.774        \nNumber of obs: 1000, groups:  ID, 250\nFixed Effects:\n                      (Intercept)                    sexFactorfemale  \n                         15.35933                            1.98820  \n                      ageCentered                              sleep  \n                         -0.84863                           -0.88422  \n      sexFactorfemale:ageCentered                  ageCentered:sleep  \n                          2.60367                            0.01942  \n            sexFactorfemale:sleep  sexFactorfemale:ageCentered:sleep  \n                          0.04039                           -0.12621  \n\n[[2]]\nLinear mixed model fit by REML ['lmerModLmerTest']\nFormula: depression ~ sexFactor + ageCentered + sexFactor:ageCentered +  \n    sleep + sleep:ageCentered + sexFactor:sleep + sexFactor:sleep:ageCentered +  \n    (1 + ageCentered | ID)\nREML criterion at convergence: 5099.018\nRandom effects:\n Groups   Name        Std.Dev. Corr\n ID       (Intercept) 3.801        \n          ageCentered 1.518    0.55\n Residual             1.756        \nNumber of obs: 1000, groups:  ID, 250\nFixed Effects:\n                      (Intercept)                    sexFactorfemale  \n                         16.19658                            1.07289  \n                      ageCentered                              sleep  \n                         -0.63998                           -0.99307  \n      sexFactorfemale:ageCentered                  ageCentered:sleep  \n                          2.50714                            0.00242  \n            sexFactorfemale:sleep  sexFactorfemale:ageCentered:sleep  \n                          0.15416                           -0.12000  \n\n[[3]]\nLinear mixed model fit by REML ['lmerModLmerTest']\nFormula: depression ~ sexFactor + ageCentered + sexFactor:ageCentered +  \n    sleep + sleep:ageCentered + sexFactor:sleep + sexFactor:sleep:ageCentered +  \n    (1 + ageCentered | ID)\nREML criterion at convergence: 5135.067\nRandom effects:\n Groups   Name        Std.Dev. Corr\n ID       (Intercept) 3.761        \n          ageCentered 1.497    0.58\n Residual             1.827        \nNumber of obs: 1000, groups:  ID, 250\nFixed Effects:\n                      (Intercept)                    sexFactorfemale  \n                        16.005936                           2.236513  \n                      ageCentered                              sleep  \n                        -0.644327                          -0.972059  \n      sexFactorfemale:ageCentered                  ageCentered:sleep  \n                         1.985518                           0.008007  \n            sexFactorfemale:sleep  sexFactorfemale:ageCentered:sleep  \n                         0.017228                          -0.065530  \n\n[[4]]\nLinear mixed model fit by REML ['lmerModLmerTest']\nFormula: depression ~ sexFactor + ageCentered + sexFactor:ageCentered +  \n    sleep + sleep:ageCentered + sexFactor:sleep + sexFactor:sleep:ageCentered +  \n    (1 + ageCentered | ID)\nREML criterion at convergence: 5082.771\nRandom effects:\n Groups   Name        Std.Dev. Corr\n ID       (Intercept) 3.799        \n          ageCentered 1.535    0.57\n Residual             1.731        \nNumber of obs: 1000, groups:  ID, 250\nFixed Effects:\n                      (Intercept)                    sexFactorfemale  \n                         15.84159                            1.71636  \n                      ageCentered                              sleep  \n                         -1.06624                           -0.95303  \n      sexFactorfemale:ageCentered                  ageCentered:sleep  \n                          2.68593                            0.06101  \n            sexFactorfemale:sleep  sexFactorfemale:ageCentered:sleep  \n                          0.08381                           -0.15154  \n\n[[5]]\nLinear mixed model fit by REML ['lmerModLmerTest']\nFormula: depression ~ sexFactor + ageCentered + sexFactor:ageCentered +  \n    sleep + sleep:ageCentered + sexFactor:sleep + sexFactor:sleep:ageCentered +  \n    (1 + ageCentered | ID)\nREML criterion at convergence: 5114.765\nRandom effects:\n Groups   Name        Std.Dev. Corr\n ID       (Intercept) 3.737        \n          ageCentered 1.491    0.63\n Residual             1.813        \nNumber of obs: 1000, groups:  ID, 250\nFixed Effects:\n                      (Intercept)                    sexFactorfemale  \n                         15.74746                            2.14466  \n                      ageCentered                              sleep  \n                         -0.47781                           -0.93500  \n      sexFactorfemale:ageCentered                  ageCentered:sleep  \n                          2.22335                           -0.01803  \n            sexFactorfemale:sleep  sexFactorfemale:ageCentered:sleep  \n                          0.02546                           -0.08941  \n\n\n\n\nTable 1: Elements of pooled object\n\n\n\n\n\n\n\nColumn label\nDefinition\n\n\n\nestimate\nPooled complete data estimate\n\n\nubar\nWithin-imputation variance of estimate\n\n\n\nb\nBetween-imputation variance of estimate\n\n\n\nt\nTotal variance, of estimate\n\n\n\ndfcom\nDegrees of freedom in complete data\n\n\ndf\nResidual degrees of freedom for hypothesis testing of \\(t\\)-statistic\n\n\n\nriv``       | Relative increase in variance due to nonresponse                    | |lambda| Proportion of total variance due to missingness                     | |fmi`\nFraction of missing information\n\n\n\n\n\n\n\nCodelinearGCM_mice_pooled &lt;- mice::pool(linearGCM_mice)\n\nlinearGCM_mice_pooled\n\nClass: mipo    m = 5 \n                               term m    estimate        ubar            b\n1                       (Intercept) 5 15.83017892 2.256778174 0.0984529972\n2                   sexFactorfemale 5  1.83172298 4.133072817 0.2188522836\n3                       ageCentered 5 -0.73539774 0.626591431 0.0515078767\n4                             sleep 5 -0.94747608 0.033703847 0.0017176927\n5       sexFactorfemale:ageCentered 5  2.40112035 1.119580449 0.0844273880\n6                 ageCentered:sleep 5  0.01456458 0.009444038 0.0008583766\n7             sexFactorfemale:sleep 5  0.06420938 0.060787571 0.0031877557\n8 sexFactorfemale:ageCentered:sleep 5 -0.11053774 0.016734799 0.0011221435\n           t dfcom       df        riv     lambda        fmi\n1 2.37492177   988 593.1339 0.05235056 0.04974631 0.05293437\n2 4.39569556   988 507.3527 0.06354176 0.05974543 0.06343016\n3 0.68840088   988 319.5232 0.09864395 0.08978700 0.09543133\n4 0.03576508   988 524.4955 0.06115715 0.05763251 0.06120550\n5 1.22089331   988 353.6699 0.09049181 0.08298257 0.08812468\n6 0.01047409   988 282.2755 0.10906901 0.09834285 0.10466416\n7 0.06461288   988 511.6980 0.06292909 0.05920347 0.06285920\n8 0.01808137   988 402.8435 0.08046539 0.07447290 0.07903391\n\n\n\nCodesummary(linearGCM_mice_pooled)\n\n\n\n\n\n  \n\n\n\n\n3.6.2 Structural Equation Models\n\n3.6.2.1 Model Syntax\n\nCodelinearGCM_syntax &lt;- '\n  # Intercept and slope\n  intercept =~ 1*depression_1 + 1*depression_2 + 1*depression_3 + 1*depression_4\n  slope =~ 0*depression_1 + 1*depression_2 + 2*depression_3 + 3*depression_4\n\n  # Regression paths\n  intercept ~ sexMale\n  slope ~ sexMale\n  \n  # Time-varying covariates\n  depression_1 ~ sleep_1\n  depression_2 ~ sleep_2\n  depression_3 ~ sleep_3\n  depression_4 ~ sleep_4\n  \n  # Constrain observed intercepts to zero\n  depression_1 ~ 0\n  depression_2 ~ 0\n  depression_3 ~ 0\n  depression_4 ~ 0\n  \n  # Estimate mean of intercept and slope\n  intercept ~ 1\n  slope ~ 1\n'\n\n\n\n3.6.2.2 Fit Model\n\nCodelinearGCM_fit_mice &lt;- lavaan.mi::sem.mi(\n  linearGCM_syntax,\n  data = mi_mice_wide_mids,\n  missing = \"ML\", # FIML\n  estimator = \"MLR\", # Huber-White robust standard errors (for heteroscedasticity and nonnormally distributed residuals)\n  meanstructure = TRUE # estimate means/intercepts\n)\n\n\n\n3.6.2.3 Model Summary\n\nCodesummary(\n  linearGCM_fit_mice,\n  fit.measures = TRUE,\n  standardized = TRUE,\n  rsquare = TRUE)\n\nlavaan.mi object fit to 5 imputed data sets using:\n - lavaan    (0.6-21)\n - lavaan.mi (0.1-0)\nSee class?lavaan.mi help page for available methods. \n\nConvergence information:\nThe model converged on 5 imputed data sets.\nStandard errors were available for all imputations.\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        15\n\n  Number of observations                           250\n  Number of missing patterns                         1\n\nModel Test User Model:\n\n                                                    Standard      Scaled\n  Test statistic                                      46.920      43.683\n  Degrees of freedom                                      19          19\n  P-value                                              0.000       0.001\n  Average scaling correction factor                                1.074\n  Pooling method                                          D4            \n    Pooled statistic                              \"standard\"            \n    \"yuan.bentler.mplus\" correction applied            AFTER     pooling\n\nModel Test Baseline Model:\n\n  Test statistic                              1219.809    1049.685\n  Degrees of freedom                                26          26\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  1.162\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.977       0.976\n  Tucker-Lewis Index (TLI)                       0.968       0.967\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.977\n  Robust Tucker-Lewis Index (TLI)                            0.968\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -2477.613   -2477.613\n  Scaling correction factor                                  1.228\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)      -2449.740   -2449.740\n  Scaling correction factor                                  1.144\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                                4985.225    4985.225\n  Bayesian (BIC)                              5038.047    5038.047\n  Sample-size adjusted Bayesian (SABIC)       4990.496    4990.496\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.077       0.072\n  90 Percent confidence interval - lower         0.049       0.045\n  90 Percent confidence interval - upper         0.105       0.099\n  P-value H_0: RMSEA &lt;= 0.050                    0.054       0.087\n  P-value H_0: RMSEA &gt;= 0.080                    0.450       0.334\n                                                                  \n  Robust RMSEA                                               0.088\n  90 Percent confidence interval - lower                     0.060\n  90 Percent confidence interval - upper                     0.117\n  P-value H_0: Robust RMSEA &lt;= 0.050                         0.015\n  P-value H_0: Robust RMSEA &gt;= 0.080                         0.702\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.082       0.082\n\nParameter Estimates:\n\n  Standard errors                                   Sandwich\n  Information bread                                 Observed\n  Observed information based on                      Hessian\n                                                            \n  Pooled across imputations             Rubin's (1987) rules\n  Augment within-imputation variance    Scale by average RIV\n  Wald test for pooled parameters         t(df) distribution\n\n  Pooled t statistics with df &gt;= 1000 are displayed with\n  df = Inf(inity) to save space. Although the t distribution\n  with large df closely approximates a standard normal\n  distribution, exact df for reporting these t tests can be\n  obtained from parameterEstimates.mi() \n\n\nLatent Variables:\n                   Estimate  Std.Err  t-value       df  P(&gt;|t|)   Std.lv\n  intercept =~                                                          \n    depression_1      1.000                                        4.038\n    depression_2      1.000                                        4.038\n    depression_3      1.000                                        4.038\n    depression_4      1.000                                        4.038\n  slope =~                                                              \n    depression_1      0.000                                        0.000\n    depression_2      1.000                                        1.701\n    depression_3      2.000                                        3.402\n    depression_4      3.000                                        5.104\n  Std.all\n         \n    0.935\n    0.737\n    0.587\n    0.472\n         \n    0.000\n    0.311\n    0.495\n    0.597\n\nRegressions:\n                   Estimate  Std.Err  t-value       df  P(&gt;|t|)   Std.lv\n  intercept ~                                                           \n    sexMale          -2.314    0.551   -4.203      Inf    0.000   -0.573\n  slope ~                                                               \n    sexMale          -1.539    0.222   -6.925      Inf    0.000   -0.905\n  depression_1 ~                                                        \n    sleep_1          -0.791    0.131   -6.055      Inf    0.000   -0.791\n  depression_2 ~                                                        \n    sleep_2          -0.974    0.103   -9.423  804.857    0.000   -0.974\n  depression_3 ~                                                        \n    sleep_3          -0.990    0.124   -7.982  274.360    0.000   -0.990\n  depression_4 ~                                                        \n    sleep_4          -0.900    0.179   -5.042  242.711    0.000   -0.900\n  Std.all\n         \n   -0.284\n         \n   -0.449\n         \n   -0.211\n         \n   -0.193\n         \n   -0.157\n         \n   -0.125\n\nCovariances:\n                   Estimate  Std.Err  t-value       df  P(&gt;|t|)   Std.lv\n .intercept ~~                                                          \n   .slope             3.104    0.521    5.954  782.471    0.000    0.527\n  Std.all\n         \n    0.527\n\nIntercepts:\n                   Estimate  Std.Err  t-value       df  P(&gt;|t|)   Std.lv\n   .depression_1      0.000                                        0.000\n   .depression_2      0.000                                        0.000\n   .depression_3      0.000                                        0.000\n   .depression_4      0.000                                        0.000\n   .intercept        17.487    1.127   15.520      Inf    0.000    4.331\n   .slope             1.177    0.633    1.859  452.471    0.064    0.692\n  Std.all\n    0.000\n    0.000\n    0.000\n    0.000\n    4.331\n    0.692\n\nVariances:\n                   Estimate  Std.Err  t-value       df  P(&gt;|t|)   Std.lv\n   .depression_1      1.717    0.457    3.757   69.505    0.000    1.717\n   .depression_2      1.817    0.342    5.316  125.818    0.000    1.817\n   .depression_3      2.115    0.454    4.659   38.212    0.000    2.115\n   .depression_4      5.681    1.058    5.369   90.930    0.000    5.681\n   .intercept        14.984    2.035    7.365      Inf    0.000    0.919\n   .slope             2.310    0.329    7.020  620.663    0.000    0.798\n  Std.all\n    0.092\n    0.061\n    0.045\n    0.078\n    0.919\n    0.798\n\nR-Square:\n                   Estimate\n    depression_1      0.908\n    depression_2      0.939\n    depression_3      0.955\n    depression_4      0.922\n    intercept         0.081\n    slope             0.202"
  }
]